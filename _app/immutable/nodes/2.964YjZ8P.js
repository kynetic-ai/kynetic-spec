import{f as c,a as t,d as A,t as j,s as T}from"../chunks/DbNf8dF3.js";import{p as I,c as k,n as E,r as m,a as V,s as M,j as G,o as H,k as J,m as U,q as B,v as d,f as q,w as F,x as D}from"../chunks/31jCLm1F.js";import{p as K,r as L,b as N,i as O}from"../chunks/CrXisG0U.js";import{a as Q,c as X,s as Y,g as Z,f as ee,e as se,i as te,B as ae,b as oe}from"../chunks/DIMAzWuN.js";import{g as re}from"../chunks/BIpowRRP.js";import{b as le}from"../chunks/E2YVNu3w.js";import{C as ne,a as ie}from"../chunks/CZGaDAF2.js";import{C as de}from"../chunks/CN4Mmrfi.js";var ce=c("<div><!></div>");function fe(h,n){I(n,!0);let u=K(n,"ref",15,null),_=L(n,["$$slots","$$events","$$legacy","ref","class","children"]);var o=ce();Q(o,v=>({"data-slot":"card-title",class:v,..._}),[()=>X("leading-none font-semibold",n.class)]);var y=k(o);Y(y,()=>n.children??E),m(o),N(o,v=>u(v),()=>u()),t(h,o),V()}var pe=c("<!> <!>",1),ue=c('<span class="animate-pulse">...</span>'),ve=c('<div class="text-2xl font-bold"><!></div>'),ge=c("<!> <!>",1),me=c('<button class="text-left"><!></button>'),_e=c('<div class="flex flex-col gap-6"><h1 class="text-3xl font-bold">Dashboard</h1> <div class="grid gap-4 md:grid-cols-3 lg:grid-cols-5" data-testid="dashboard-counts"></div></div>');function Pe(h,n){I(n,!0);let u=M(G({ready:0,in_progress:0,pending_review:0,blocked:0,completed:0})),_=M(!0);H(async()=>{await o()}),J(()=>{Z()>0&&o()});async function o(){try{const r=(await ee({limit:1e3})).items,e={ready:0,in_progress:0,pending_review:0,blocked:0,completed:0},x=new Set(r.filter(s=>s.status==="completed").flatMap(s=>[s._ulid,...s.slugs||[]]));for(const s of r)s.status==="completed"?e.completed++:s.status==="in_progress"?e.in_progress++:s.status==="pending_review"?e.pending_review++:s.status==="blocked"?e.blocked++:s.status==="pending"&&((s.depends_on||[]).some(f=>{const C=f.startsWith("@")?f.slice(1):f;return!x.has(C)})?e.blocked++:e.ready++);U(u,e,!0)}catch(i){console.error("Failed to load task counts:",i)}finally{U(_,!1)}}function y(i){re(`${le}/tasks?status=${i}`)}const v=[{key:"ready",label:"Ready",color:"bg-green-500",filterStatus:"pending"},{key:"in_progress",label:"In Progress",color:"bg-blue-500",filterStatus:"in_progress"},{key:"pending_review",label:"Pending Review",color:"bg-yellow-500",filterStatus:"pending_review"},{key:"blocked",label:"Blocked",color:"bg-red-500",filterStatus:"blocked"},{key:"completed",label:"Completed",color:"bg-gray-500",filterStatus:"completed"}];var $=_e(),R=B(k($),2);se(R,21,()=>v,te,(i,r)=>{var e=me();e.__click=()=>y(d(r).filterStatus);var x=k(e);ne(x,{class:"transition-colors hover:bg-muted/50 cursor-pointer",children:(s,W)=>{var w=ge(),f=q(w);ie(f,{class:"flex flex-row items-center justify-between pb-2 space-y-0",children:(P,z)=>{var p=pe(),b=q(p);fe(b,{class:"text-sm font-medium",children:(g,l)=>{F();var a=j();D(()=>T(a,d(r).label)),t(g,a)},$$slots:{default:!0}});var S=B(b,2);ae(S,{get class(){return d(r).color},children:(g,l)=>{F();var a=j("Â ");t(g,a)},$$slots:{default:!0}}),t(P,p)},$$slots:{default:!0}});var C=B(f,2);de(C,{children:(P,z)=>{var p=ve(),b=k(p);{var S=l=>{var a=ue();t(l,a)},g=l=>{var a=j();D(()=>T(a,d(u)[d(r).key])),t(l,a)};O(b,l=>{d(_)?l(S):l(g,!1)})}m(p),t(P,p)},$$slots:{default:!0}}),t(s,w)},$$slots:{default:!0}}),m(e),D(()=>oe(e,"data-testid",`task-count-${d(r).key??""}`)),t(i,e)}),m(R),m($),t(h,$),V()}A(["click"]);export{Pe as component};
