import{f as d,a,t as T,s as y,c as we}from"../chunks/DbNf8dF3.js";import{p as ie,c as u,n as Pe,r as l,a as le,s as $,j as Ie,o as Ce,k as ke,m as c,f as j,q as o,v as t,w as B,x as A,y as je}from"../chunks/31jCLm1F.js";import{p as Ae,r as Me,b as Te,i as D}from"../chunks/CrXisG0U.js";import{a as Be,c as Ee,s as Le,g as Ke,d as Ue,e as oe,i as qe,B as Fe}from"../chunks/DIMAzWuN.js";import"../chunks/E2YVNu3w.js";import{B as R}from"../chunks/OyQmuBbj.js";import{I as He}from"../chunks/D8ueHsox.js";import{C as de,a as Ne}from"../chunks/CZGaDAF2.js";import{C as ne}from"../chunks/CN4Mmrfi.js";import{D as Oe,a as Se,b as Ve,c as ze,d as Ge}from"../chunks/Cdjcx2ww.js";var Je=d("<div><!></div>");function Qe(O,w){ie(w,!0);let M=Ae(w,"ref",15,null),E=Me(w,["$$slots","$$events","$$legacy","ref","class","children"]);var f=Je();Be(f,g=>({"data-slot":"dialog-footer",class:g,...E}),[()=>Ee("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",w.class)]);var S=u(f);Le(S,()=>w.children??Pe),l(f),Te(f,g=>M(g),()=>M()),a(O,f),le()}var Re=d('<div class="rounded-md bg-red-50 p-4 text-sm text-red-800" data-testid="error-message" role="alert"> </div>'),We=d('<div class="flex gap-2"><!> <!></div>'),Xe=d('<div class="text-center text-muted-foreground">Loading inbox...</div>'),Ye=d('<div class="text-center text-muted-foreground"><p>No inbox items.</p> <p class="text-sm">Click "Add Item" to capture ideas and thoughts.</p></div>'),Ze=d('<div class="flex items-start justify-between gap-4"><div class="flex-1"><p class="text-sm leading-relaxed" data-testid="inbox-text"> </p></div> <!></div>'),et=d('<span>•</span> <div class="flex gap-1" data-testid="inbox-tags"></div>',1),tt=d('<div class="flex items-center gap-2 text-xs text-muted-foreground"><span data-testid="inbox-created-at"> </span> <span>•</span> <span data-testid="inbox-added-by"> </span> <!></div>'),at=d("<!> <!>",1),rt=d('<div class="flex flex-col gap-3" data-testid="inbox-list"></div>'),st=d("<!> <!>",1),ot=d('<div class="rounded-md bg-muted p-3 text-sm"> </div>'),dt=d("<!> <!>",1),nt=d("<!> <!> <!>",1),it=d('<div class="flex flex-col gap-4"><div class="flex items-center justify-between"><h1 class="text-3xl font-bold">Inbox</h1> <!></div> <!> <!> <!></div> <!>',1);function ht(O,w){ie(w,!0);let M=$(Ie([])),E=$(!0),f=$(""),S=$(!1),g=$(""),V=$(!1),F=$(!1),H=$(null),z=$(!1);Ce(async()=>{await W()}),ke(()=>{Ke()>0&&W()});async function W(){try{c(E,!0),c(f,"");const e=await Ue();c(M,e.items,!0)}catch(e){c(f,e instanceof Error?e.message:"Failed to load inbox",!0)}finally{c(E,!1)}}async function X(){if(t(g).trim()){c(f,"Cannot add items in read-only mode. Use the kspec CLI.");return}}function ve(e){e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),X())}async function fe(){if(t(H)){c(f,"Cannot delete items in read-only mode. Use the kspec CLI."),c(F,!1),c(H,null);return}}function ce(e){const n=new Date(e),h=new Date().getTime()-n.getTime(),x=Math.floor(h/6e4),r=Math.floor(h/36e5),i=Math.floor(h/864e5);return x<1?"just now":x<60?`${x}m ago`:r<24?`${r}h ago`:i<7?`${i}d ago`:n.toLocaleDateString()}var Y=it(),G=j(Y),J=u(G),ue=o(u(J),2);D(ue,e=>{}),l(J);var Z=o(J,2);{var _e=e=>{var n=Re(),P=u(n,!0);l(n),A(()=>y(P,t(f))),a(e,n)};D(Z,e=>{t(f)&&e(_e)})}var ee=o(Z,2);{var pe=e=>{de(e,{"data-testid":"inbox-add-form",children:(n,P)=>{ne(n,{class:"pt-6",children:(h,x)=>{var r=We(),i=u(r);He(i,{"data-testid":"inbox-input",placeholder:"Enter inbox item text (press Enter to submit)",get disabled(){return t(V)},class:"flex-1",get value(){return t(g)},set value(_){c(g,_,!0)},$$events:{keydown:ve}});var I=o(i,2);{let _=je(()=>t(V)||!t(g).trim());R(I,{"data-testid":"inbox-submit",get disabled(){return t(_)},$$events:{click:X},children:(p,C)=>{B();var v=T();A(()=>y(v,t(V)?"Adding...":"Add")),a(p,v)},$$slots:{default:!0}})}l(r),a(h,r)},$$slots:{default:!0}})},$$slots:{default:!0}})};D(ee,e=>{t(S)&&e(pe)})}var me=o(ee,2);{var xe=e=>{var n=Xe();a(e,n)},$e=e=>{var n=we(),P=j(n);{var h=r=>{var i=Ye();a(r,i)},x=r=>{var i=rt();oe(i,21,()=>t(M),I=>I._ulid,(I,_)=>{de(I,{class:"transition-all duration-200 hover:shadow-md","data-testid":"inbox-item",children:(p,C)=>{var v=at(),b=j(v);Ne(b,{class:"pb-3",children:(m,K)=>{var s=Ze(),k=u(s),N=u(k),U=u(N,!0);l(N),l(k);var Q=o(k,2);D(Q,te=>{}),l(s),A(()=>y(U,t(_).text)),a(m,s)},$$slots:{default:!0}});var L=o(b,2);ne(L,{class:"pt-0",children:(m,K)=>{var s=tt(),k=u(s),N=u(k,!0);l(k);var U=o(k,4),Q=u(U,!0);l(U);var te=o(U,2);{var he=q=>{var ae=et(),re=o(j(ae),2);oe(re,21,()=>t(_).tags,qe,(be,ye)=>{Fe(be,{variant:"secondary",class:"text-xs",children:(De,lt)=>{B();var se=T();A(()=>y(se,t(ye))),a(De,se)},$$slots:{default:!0}})}),l(re),a(q,ae)};D(te,q=>{t(_).tags.length>0&&q(he)})}l(s),A(q=>{y(N,q),y(Q,t(_).added_by)},[()=>ce(t(_).created_at)]),a(m,s)},$$slots:{default:!0}}),a(p,v)},$$slots:{default:!0}})}),l(i),a(r,i)};D(P,r=>{t(M).length===0?r(h):r(x,!1)},!0)}a(e,n)};D(me,e=>{t(E)?e(xe):e($e,!1)})}l(G);var ge=o(G,2);Oe(ge,{get open(){return t(F)},set open(e){c(F,e,!0)},children:(e,n)=>{Se(e,{"data-testid":"confirm-delete-dialog",children:(P,h)=>{var x=nt(),r=j(x);Ve(r,{children:(p,C)=>{var v=st(),b=j(v);ze(b,{children:(m,K)=>{B();var s=T("Delete Inbox Item?");a(m,s)},$$slots:{default:!0}});var L=o(b,2);Ge(L,{children:(m,K)=>{B();var s=T("Are you sure you want to delete this inbox item? This action cannot be undone.");a(m,s)},$$slots:{default:!0}}),a(p,v)},$$slots:{default:!0}});var i=o(r,2);{var I=p=>{var C=ot(),v=u(C,!0);l(C),A(()=>y(v,t(H).text)),a(p,C)};D(i,p=>{t(H)&&p(I)})}var _=o(i,2);Qe(_,{children:(p,C)=>{var v=dt(),b=j(v);R(b,{"data-testid":"confirm-delete-no",variant:"outline",get disabled(){return t(z)},$$events:{click:()=>c(F,!1)},children:(m,K)=>{B();var s=T("Cancel");a(m,s)},$$slots:{default:!0}});var L=o(b,2);R(L,{"data-testid":"confirm-delete-yes",variant:"destructive",get disabled(){return t(z)},$$events:{click:fe},children:(m,K)=>{B();var s=T();A(()=>y(s,t(z)?"Deleting...":"Delete")),a(m,s)},$$slots:{default:!0}}),a(p,v)},$$slots:{default:!0}}),a(P,x)},$$slots:{default:!0}})},$$slots:{default:!0}}),a(O,Y),le()}export{ht as component};
