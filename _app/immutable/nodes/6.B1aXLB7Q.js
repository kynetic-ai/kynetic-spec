import{p as Kt,c as Ce,a as e,f as c,t as g,s as y,d as Pt,e as Wt}from"../chunks/DbNf8dF3.js";import{y as ae,v as t,m as oe,p as ce,f as z,a as ve,c as o,n as je,r as l,q as s,w as m,x as S,aT as Xt,D as bt,u as W,a4 as tt,s as Se,j as at,k as rt,ai as Gt,o as Ht,aU as Jt,aV as Qt}from"../chunks/31jCLm1F.js";import{p as Y,i as E,r as Ie,s as wt,a as Tt,c as St,b as Oe}from"../chunks/CrXisG0U.js";import{s as Ae,a as Le,c as Ue,e as Fe,B as he,b as Je,i as De,j as Ct,g as Yt,f as Zt,l as ea}from"../chunks/DIMAzWuN.js";import{c as He}from"../chunks/D39RBmRn.js";import{p as At}from"../chunks/BDZUbTdz.js";import{b as Ke}from"../chunks/E2YVNu3w.js";import{g as xt}from"../chunks/BIpowRRP.js";import{I as kt}from"../chunks/D8ueHsox.js";import{d as ta,j as aa,c as ra,f as sa,b as Ge,m as la,B as It,X as oa}from"../chunks/OyQmuBbj.js";import{S as st,a as lt,b as ot,c as se,T as na,d as da,e as ia}from"../chunks/DlmhWNC_.js";import{i as ca}from"../chunks/CJk668Ki.js";const va=ra({component:"separator",parts:["root"]});class dt{static create(r){return new dt(r)}opts;attachment;constructor(r){this.opts=r,this.attachment=ta(r.ref)}#e=ae(()=>({id:this.opts.id.current,role:this.opts.decorative.current?"none":"separator","aria-orientation":this.opts.orientation.current,"aria-hidden":aa(this.opts.decorative.current),"data-orientation":this.opts.orientation.current,[va.root]:"",...this.attachment}));get props(){return t(this.#e)}set props(r){oe(this.#e,r)}}var ua=c("<div><!></div>");function fa(F,r){const _=Kt();ce(r,!0);let B=Y(r,"id",19,()=>sa(_)),i=Y(r,"ref",15,null),x=Y(r,"decorative",3,!1),h=Y(r,"orientation",3,"horizontal"),X=Ie(r,["$$slots","$$events","$$legacy","id","ref","child","children","decorative","orientation"]);const Z=dt.create({ref:Ge(()=>i(),D=>i(D)),id:Ge(()=>B()),decorative:Ge(()=>x()),orientation:Ge(()=>h())}),ne=ae(()=>la(X,Z.props));var f=Ce(),be=z(f);{var C=D=>{var G=Ce(),le=z(G);Ae(le,()=>r.child,()=>({props:t(ne)})),e(D,G)},ge=D=>{var G=ua();Le(G,()=>({...t(ne)}));var le=o(G);Ae(le,()=>r.children??je),l(G),e(D,G)};E(be,D=>{r.child?D(C):D(ge,!1)})}e(F,f),ve()}function nt(F,r){ce(r,!0);let _=Y(r,"ref",15,null),B=Y(r,"data-slot",3,"separator"),i=Ie(r,["$$slots","$$events","$$legacy","ref","class","data-slot"]);var x=Ce(),h=z(x);{let X=ae(()=>Ue("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:min-h-full data-[orientation=vertical]:w-px",r.class));He(h,()=>fa,(Z,ne)=>{ne(Z,wt({get"data-slot"(){return B()},get class(){return t(X)}},()=>i,{get ref(){return _()},set ref(f){_(f)}}))})}e(F,x),ve()}const _a=!1,xr=Object.freeze(Object.defineProperty({__proto__:null,ssr:_a},Symbol.toStringTag,{value:"Module"}));var pa=c("<!> <!> <!> <!> <!> <!> <!>",1),ga=c("<!> <!>",1),$a=c("<!> <!> <!>",1),ma=c("<!> <!>",1),ha=c("<!> <!> <!>",1),ba=c("<!> <!>",1),xa=c('<div class="flex items-end"><!></div>'),ka=c('<div class="flex flex-wrap gap-4 p-4 bg-muted/50 rounded-lg" data-testid="filter-controls"><div class="flex-1 min-w-[200px]"><label for="status-filter" class="text-sm font-medium mb-2 block">Status</label> <!></div> <div class="flex-1 min-w-[200px]"><label for="type-filter" class="text-sm font-medium mb-2 block">Type</label> <!></div> <div class="flex-1 min-w-[200px]"><label for="automation-filter" class="text-sm font-medium mb-2 block">Automation</label> <!></div> <div class="flex-1 min-w-[200px]"><label for="tag-filter" class="text-sm font-medium mb-2 block">Tag</label> <!></div> <div class="flex-1 min-w-[200px]"><label for="assignee-filter" class="text-sm font-medium mb-2 block">Assignee</label> <!></div> <!></div>');function ya(F,r){ce(r,!0);const _=()=>St(At,"$page",B),[B,i]=Tt(),x={"":"All Statuses",all:"All Statuses",pending:"Pending",in_progress:"In Progress",pending_review:"Pending Review",blocked:"Blocked",completed:"Completed",cancelled:"Cancelled"},h={"":"All Types",all:"All Types",task:"Task",subtask:"Subtask"},X={"":"All",all:"All",eligible:"Eligible",blocked:"Blocked"};let Z=ae(()=>_().url.searchParams.get("status")||""),ne=ae(()=>_().url.searchParams.get("type")||""),f=ae(()=>_().url.searchParams.get("tag")||""),be=ae(()=>_().url.searchParams.get("assignee")||""),C=ae(()=>_().url.searchParams.get("automation")||""),ge=ae(()=>t(Z)||t(ne)||t(f)||t(be)||t(C));function D(k,M){let L;Array.isArray(M)?L=M.length>0?M[M.length-1]:void 0:L=M;const N=new URLSearchParams(_().url.searchParams);!L||L==="all"?N.delete(k):N.set(k,L),N.delete("offset");const A=`${Ke}/tasks?${N.toString()}`;xt(A,{replaceState:!1,keepFocus:!0})}function G(){xt(`${Ke}/tasks`,{replaceState:!1})}let le=ae(()=>t(Z)||"all"),xe=ae(()=>t(ne)||"all"),$e=ae(()=>t(C)||"all");var ue=ka(),ke=o(ue),ye=s(o(ke),2);st(ye,{get value(){return t(le)},onValueChange:k=>D("status",k),children:(k,M)=>{var L=ga(),N=z(L);lt(N,{id:"status-filter","data-testid":"filter-status",children:(a,d)=>{m();var v=g();S(()=>y(v,x[t(le)]||"All Statuses")),e(a,v)},$$slots:{default:!0}});var A=s(N,2);ot(A,{children:(a,d)=>{var v=pa(),T=z(v);se(T,{value:"all",children:(H,me)=>{m();var J=g("All Statuses");e(H,J)},$$slots:{default:!0}});var R=s(T,2);se(R,{value:"pending",children:(H,me)=>{m();var J=g("Pending");e(H,J)},$$slots:{default:!0}});var P=s(R,2);se(P,{value:"in_progress",children:(H,me)=>{m();var J=g("In Progress");e(H,J)},$$slots:{default:!0}});var $=s(P,2);se($,{value:"pending_review",children:(H,me)=>{m();var J=g("Pending Review");e(H,J)},$$slots:{default:!0}});var K=s($,2);se(K,{value:"blocked",children:(H,me)=>{m();var J=g("Blocked");e(H,J)},$$slots:{default:!0}});var w=s(K,2);se(w,{value:"completed",children:(H,me)=>{m();var J=g("Completed");e(H,J)},$$slots:{default:!0}});var ie=s(w,2);se(ie,{value:"cancelled",children:(H,me)=>{m();var J=g("Cancelled");e(H,J)},$$slots:{default:!0}}),e(a,v)},$$slots:{default:!0}}),e(k,L)},$$slots:{default:!0}}),l(ke);var fe=s(ke,2),re=s(o(fe),2);st(re,{get value(){return t(xe)},onValueChange:k=>D("type",k),children:(k,M)=>{var L=ma(),N=z(L);lt(N,{id:"type-filter","data-testid":"filter-type",children:(a,d)=>{m();var v=g();S(()=>y(v,h[t(xe)]||"All Types")),e(a,v)},$$slots:{default:!0}});var A=s(N,2);ot(A,{children:(a,d)=>{var v=$a(),T=z(v);se(T,{value:"all",children:($,K)=>{m();var w=g("All Types");e($,w)},$$slots:{default:!0}});var R=s(T,2);se(R,{value:"task",children:($,K)=>{m();var w=g("Task");e($,w)},$$slots:{default:!0}});var P=s(R,2);se(P,{value:"subtask",children:($,K)=>{m();var w=g("Subtask");e($,w)},$$slots:{default:!0}}),e(a,v)},$$slots:{default:!0}}),e(k,L)},$$slots:{default:!0}}),l(fe);var ee=s(fe,2),de=s(o(ee),2);st(de,{get value(){return t($e)},onValueChange:k=>D("automation",k),children:(k,M)=>{var L=ba(),N=z(L);lt(N,{id:"automation-filter","data-testid":"filter-automation",children:(a,d)=>{m();var v=g();S(()=>y(v,X[t($e)]||"All")),e(a,v)},$$slots:{default:!0}});var A=s(N,2);ot(A,{children:(a,d)=>{var v=ha(),T=z(v);se(T,{value:"all",children:($,K)=>{m();var w=g("All");e($,w)},$$slots:{default:!0}});var R=s(T,2);se(R,{value:"eligible",children:($,K)=>{m();var w=g("Eligible");e($,w)},$$slots:{default:!0}});var P=s(R,2);se(P,{value:"blocked",children:($,K)=>{m();var w=g("Blocked");e($,w)},$$slots:{default:!0}}),e(a,v)},$$slots:{default:!0}}),e(k,L)},$$slots:{default:!0}}),l(ee);var te=s(ee,2),u=s(o(te),2);kt(u,{id:"tag-filter","data-testid":"filter-tag",type:"text",placeholder:"Filter by tag...",get value(){return t(f)},oninput:k=>D("tag",k.target.value)}),l(te);var j=s(te,2),O=s(o(j),2);kt(O,{id:"assignee-filter","data-testid":"filter-assignee",type:"text",placeholder:"Filter by assignee...",get value(){return t(be)},oninput:k=>D("assignee",k.target.value)}),l(j);var V=s(j,2);{var ze=k=>{var M=xa(),L=o(M);It(L,{variant:"outline",onclick:G,children:(N,A)=>{m();var a=g("Clear Filters");e(N,a)},$$slots:{default:!0}}),l(M),e(k,M)};E(V,k=>{t(ge)&&k(ze)})}l(ue),e(F,ue),ve(),i()}var Pa=c('<div data-slot="table-container" class="relative w-full overflow-x-auto"><table><!></table></div>');function wa(F,r){ce(r,!0);let _=Y(r,"ref",15,null),B=Ie(r,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Pa(),x=o(i);Le(x,X=>({"data-slot":"table",class:X,...B}),[()=>Ue("w-full caption-bottom text-sm",r.class)]);var h=o(x);Ae(h,()=>r.children??je),l(x),Oe(x,X=>_(X),()=>_()),l(i),e(F,i),ve()}var Ta=c("<tbody><!></tbody>");function Sa(F,r){ce(r,!0);let _=Y(r,"ref",15,null),B=Ie(r,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Ta();Le(i,h=>({"data-slot":"table-body",class:h,...B}),[()=>Ue("[&_tr:last-child]:border-0",r.class)]);var x=o(i);Ae(x,()=>r.children??je),l(i),Oe(i,h=>_(h),()=>_()),e(F,i),ve()}var Ca=c("<td><!></td>");function Ee(F,r){ce(r,!0);let _=Y(r,"ref",15,null),B=Ie(r,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Ca();Le(i,h=>({"data-slot":"table-cell",class:h,...B}),[()=>Ue("bg-clip-padding p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pe-0",r.class)]);var x=o(i);Ae(x,()=>r.children??je),l(i),Oe(i,h=>_(h),()=>_()),e(F,i),ve()}var Aa=c("<th><!></th>");function Ne(F,r){ce(r,!0);let _=Y(r,"ref",15,null),B=Ie(r,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Aa();Le(i,h=>({"data-slot":"table-head",class:h,...B}),[()=>Ue("text-foreground h-10 bg-clip-padding px-2 text-start align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pe-0",r.class)]);var x=o(i);Ae(x,()=>r.children??je),l(i),Oe(i,h=>_(h),()=>_()),e(F,i),ve()}var Ia=c("<thead><!></thead>");function Ba(F,r){ce(r,!0);let _=Y(r,"ref",15,null),B=Ie(r,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Ia();Le(i,h=>({"data-slot":"table-header",class:h,...B}),[()=>Ue("[&_tr]:border-b",r.class)]);var x=o(i);Ae(x,()=>r.children??je),l(i),Oe(i,h=>_(h),()=>_()),e(F,i),ve()}var Ra=c("<tr><!></tr>");function yt(F,r){ce(r,!0);let _=Y(r,"ref",15,null),B=Ie(r,["$$slots","$$events","$$legacy","ref","class","children"]);var i=Ra();Le(i,h=>({"data-slot":"table-row",class:h,...B}),[()=>Ue("hover:[&,&>svelte-css-wrapper]:[&>th,td]:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",r.class)]);var x=o(i);Ae(x,()=>r.children??je),l(i),Oe(i,h=>_(h),()=>_()),e(F,i),ve()}var Ea=c("<!> <!> <!> <!> <!> <!>",1),Fa=c('<span data-testid="task-title"> </span> <!>',1),Da=c('<span data-testid="task-priority"> </span>'),ja=c('<a class="text-primary hover:underline text-sm"> </a>'),La=c('<span class="text-muted-foreground text-sm">—</span>'),Ua=c('<div class="flex flex-wrap gap-1"><!> <!></div>'),za=c('<tr data-testid="task-list-item" role="button" tabindex="0"><!><!><!><!><!><!></tr>'),Va=c("<!> <!>",1),Na=c('<div class="rounded-md border" data-testid="task-list"><!></div>');function Oa(F,r){ce(r,!1);let _=Y(r,"tasks",8),B=Y(r,"updatedTaskIds",24,()=>new Set),i=Y(r,"onSelectTask",8,void 0);const x=Xt();function h(C){console.log("[TaskList] selectTask called for:",C._ulid,C.title),i()&&(console.log("[TaskList] Calling onSelectTask callback"),i()(C._ulid)),x("select",C._ulid)}function X(C){return{pending:"bg-gray-500",in_progress:"bg-blue-500",pending_review:"bg-yellow-500",blocked:"bg-red-500",completed:"bg-green-500",cancelled:"bg-gray-400"}[C]||"bg-gray-500"}function Z(C){return{pending:"Pending",in_progress:"In Progress",pending_review:"Pending Review",blocked:"Blocked",completed:"Completed",cancelled:"Cancelled"}[C]||C}function ne(C){return C===1?"text-red-600 font-bold":C===2?"text-orange-600 font-semibold":C===3?"text-yellow-600":"text-gray-600"}ca();var f=Na(),be=o(f);wa(be,{children:(C,ge)=>{var D=Va(),G=z(D);Ba(G,{children:(xe,$e)=>{yt(xe,{children:(ue,ke)=>{var ye=Ea(),fe=z(ye);Ne(fe,{children:(j,O)=>{m();var V=g("Title");e(j,V)},$$slots:{default:!0}});var re=s(fe,2);Ne(re,{children:(j,O)=>{m();var V=g("Status");e(j,V)},$$slots:{default:!0}});var ee=s(re,2);Ne(ee,{children:(j,O)=>{m();var V=g("Priority");e(j,V)},$$slots:{default:!0}});var de=s(ee,2);Ne(de,{children:(j,O)=>{m();var V=g("Spec");e(j,V)},$$slots:{default:!0}});var te=s(de,2);Ne(te,{children:(j,O)=>{m();var V=g("Notes");e(j,V)},$$slots:{default:!0}});var u=s(te,2);Ne(u,{children:(j,O)=>{m();var V=g("Tags");e(j,V)},$$slots:{default:!0}}),e(ue,ye)},$$slots:{default:!0}})},$$slots:{default:!0}});var le=s(G,2);Sa(le,{children:(xe,$e)=>{var ue=Ce(),ke=z(ue);{var ye=re=>{yt(re,{children:(ee,de)=>{Ee(ee,{colspan:6,class:"text-center text-muted-foreground",children:(te,u)=>{m();var j=g("No tasks found");e(te,j)},$$slots:{default:!0}})},$$slots:{default:!0}})},fe=re=>{var ee=Ce(),de=z(ee);Fe(de,1,_,De,(te,u)=>{const j=tt(()=>(bt(B()),t(u),W(()=>B().has(t(u)._ulid))));var O=za();O.__click=()=>h(t(u)),O.__keydown=A=>A.key==="Enter"&&h(t(u));var V=o(O);Ee(V,{class:"font-medium",children:(A,a)=>{var d=Fa(),v=z(d),T=o(v,!0);l(v);var R=s(v,2);{var P=$=>{he($,{variant:"outline",class:"ml-2",children:(K,w)=>{m();var ie=g();S(()=>y(ie,(t(u),W(()=>t(u).type)))),e(K,ie)},$$slots:{default:!0}})};E(R,$=>{t(u),W(()=>t(u).type!=="task")&&$(P)})}S(()=>y(T,(t(u),W(()=>t(u).title)))),e(A,d)},$$slots:{default:!0}});var ze=s(V);Ee(ze,{children:(A,a)=>{{let d=tt(()=>(t(u),W(()=>X(t(u).status))));he(A,{"data-testid":"task-status-badge",get class(){return t(d)},children:(v,T)=>{m();var R=g();S(P=>y(R,P),[()=>(t(u),W(()=>Z(t(u).status)))]),e(v,R)},$$slots:{default:!0}})}},$$slots:{default:!0}});var k=s(ze);{let A=tt(()=>(t(u),W(()=>ne(t(u).priority))));Ee(k,{get class(){return t(A)},children:(a,d)=>{var v=Da(),T=o(v);l(v),S(()=>y(T,`P${t(u),W(()=>t(u).priority)??""}`)),e(a,v)},$$slots:{default:!0}})}var M=s(k);Ee(M,{"data-testid":"task-spec-ref",children:(A,a)=>{var d=Ce(),v=z(d);{var T=P=>{var $=ja();$.__click=w=>w.stopPropagation();var K=o($,!0);l($),S(w=>{Je($,"href",`${Ke??""}/items?ref=${w??""}`),y(K,(t(u),W(()=>t(u).spec_ref)))},[()=>(t(u),W(()=>encodeURIComponent(t(u).spec_ref)))]),e(P,$)},R=P=>{var $=La();e(P,$)};E(v,P=>{t(u),W(()=>t(u).spec_ref)?P(T):P(R,!1)})}e(A,d)},$$slots:{default:!0}});var L=s(M);Ee(L,{children:(A,a)=>{he(A,{"data-testid":"task-notes-count",variant:"secondary",children:(d,v)=>{m();var T=g();S(()=>y(T,(t(u),W(()=>t(u).notes_count)))),e(d,T)},$$slots:{default:!0}})},$$slots:{default:!0}});var N=s(L);Ee(N,{"data-testid":"task-tags",children:(A,a)=>{var d=Ua(),v=o(d);Fe(v,1,()=>(t(u),W(()=>t(u).tags.slice(0,3))),De,(P,$)=>{he(P,{variant:"outline",class:"text-xs",children:(K,w)=>{m();var ie=g();S(()=>y(ie,t($))),e(K,ie)},$$slots:{default:!0}})});var T=s(v,2);{var R=P=>{he(P,{variant:"outline",class:"text-xs",children:($,K)=>{m();var w=g();S(()=>y(w,`+${t(u),W(()=>t(u).tags.length-3)??""}`)),e($,w)},$$slots:{default:!0}})};E(T,P=>{t(u),W(()=>t(u).tags.length>3)&&P(R)})}l(d),e(A,d)},$$slots:{default:!0}}),l(O),S(()=>{Ct(O,1,`cursor-pointer hover:bg-muted/50 transition-colors duration-300 border-b ${t(j)?"bg-primary/10 animate-pulse":""}`),Je(O,"data-task-ref",(t(u),W(()=>t(u).slugs?.[0]||t(u)._ulid)))}),e(te,O)}),e(re,ee)};E(ke,re=>{bt(_()),W(()=>_().length===0)?re(ye):re(fe,!1)})}e(xe,ue)},$$slots:{default:!0}}),e(C,D)},$$slots:{default:!0}}),l(f),e(F,f),ve()}Pt(["click","keydown"]);var qa=c('<p class="text-muted-foreground"> </p>'),Ma=c('<div class="bg-destructive/10 text-destructive p-4 rounded-lg" data-testid="error-message" role="alert"> </div>'),Ka=c('<div class="flex justify-center items-center py-12"><p class="text-muted-foreground">Loading tasks...</p></div>'),Wa=c('<div data-testid="task-spec-ref-link"><p class="text-sm font-medium mb-1">Spec Reference:</p> <a class="text-sm text-primary hover:underline"> </a></div>'),Xa=c('<div><p class="text-sm font-medium mb-1">Tags:</p> <div class="flex flex-wrap gap-1"></div></div>'),Ga=c('<li><a class="text-primary hover:underline"> </a></li>'),Ha=c('<p class="text-sm font-medium mb-1">Dependencies:</p> <ul class="text-sm space-y-1"></ul>',1),Ja=c('<p class="text-sm text-muted-foreground">No dependencies</p>'),Qa=c('<li class="text-muted-foreground"> </li>'),Ya=c('<div><p class="text-sm font-medium mb-1 text-destructive">Blocked By:</p> <ul class="text-sm space-y-1"></ul></div>'),Za=c("<p>Read-only mode - use CLI to start task</p>"),er=c("<!> <!>",1),tr=c("<div><!></div>"),ar=c('<p class="text-sm text-destructive"> </p>'),rr=c('<li class="flex items-start gap-2 text-sm"><span class="mt-0.5"><!></span> <span> </span></li>'),sr=c('<p class="text-sm font-medium mb-2">Todos:</p> <ul class="space-y-2"></ul>',1),lr=c('<p class="text-sm text-muted-foreground">No todos</p>'),or=c('<div class="border rounded-lg p-3" data-testid="note-item"><div class="flex justify-between items-start mb-2"><span class="text-xs text-muted-foreground"> </span> <span class="text-xs text-muted-foreground" data-testid="note-timestamp"> </span></div> <p class="text-sm whitespace-pre-wrap"> </p></div>'),nr=c('<div class="fixed inset-0 z-50 bg-black/50" role="button" tabindex="-1" aria-label="Close panel"><div class="fixed inset-y-0 right-0 z-50 w-3/4 max-w-lg bg-background shadow-lg border-l overflow-y-auto" data-testid="task-detail-panel" role="dialog" aria-modal="true" tabindex="0"><div class="flex items-center justify-between p-6 border-b"><h2 class="text-lg font-semibold" data-testid="task-description"> </h2> <button class="rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"><!> <span class="sr-only">Close</span></button></div> <div class="flex flex-col gap-4 p-6"><div class="flex gap-2 items-center"><!> <!> <!></div>  <!> <!> <div data-testid="task-dependencies"><!></div> <!> <!>  <!> <!> <!> <div data-testid="task-todos"><!></div> <!>  <div data-testid="task-notes"><p class="text-sm font-medium mb-2"> </p>  <!> <div class="space-y-4" data-testid="task-notes-list"></div></div></div></div></div>'),dr=c('<div class="flex flex-col gap-6 p-6"><div><h1 class="text-3xl font-bold mb-2">Tasks</h1> <!></div> <!> <!> <!></div> <!>',1);function kr(F,r){ce(r,!0);const _=()=>St(At,"$page",B),[B,i]=Tt();let x=Se(at([])),h=Se(0),X=Se(!0),Z=Se(""),ne=Se(at(new Set)),f=at({open:!1,task:null}),be=Se(""),C=Se(""),ge=ae(()=>({status:_().url.searchParams.get("status")||void 0,type:_().url.searchParams.get("type")||void 0,tag:_().url.searchParams.get("tag")||void 0,assignee:_().url.searchParams.get("assignee")||void 0,automation:_().url.searchParams.get("automation")||void 0,limit:50,offset:0})),D=Se("");rt(()=>{const{status:a,type:d,tag:v,assignee:T,automation:R,limit:P,offset:$}=t(ge);G()}),rt(()=>{Yt()>0&&G()}),rt(()=>{const a=_().url.searchParams.get("ref");a&&a!==t(D)&&(oe(D,a,!0),le(a))});async function G(){oe(X,!0),oe(Z,"");try{const a=await Zt(t(ge));oe(x,a.items,!0),oe(h,a.total,!0)}catch(a){oe(Z,a instanceof Error?a.message:"Failed to load tasks",!0),console.error("Error loading tasks:",a)}finally{oe(X,!1)}}async function le(a){console.log("[TasksPage] handleSelectTask called for:",a);try{console.log("[TasksPage] Fetching task details...");const d=await ea(a);console.log("[TasksPage] Task fetched:",d?.title),Gt(()=>{f.task=d,f.open=!0}),console.log("[TasksPage] panel.open set to true, panel.task:",f.task?.title)}catch(d){oe(Z,d instanceof Error?d.message:"Failed to load task details",!0),console.error("[TasksPage] Error loading task:",d)}}function xe(a){le(a.detail)}function $e(){f.open=!1,f.task=null,oe(be,""),oe(C,""),oe(D,"")}function ue(a){a.target===a.currentTarget&&$e()}function ke(a){a.key==="Escape"&&f.open&&$e()}function ye(a){const d=new Date(a);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(d)}function fe(a){return{pending:"bg-gray-500",in_progress:"bg-blue-500",pending_review:"bg-yellow-500",blocked:"bg-red-500",completed:"bg-green-500",cancelled:"bg-gray-400"}[a]||"bg-gray-500"}function re(a){return{pending:"Pending",in_progress:"In Progress",pending_review:"Pending Review",blocked:"Blocked",completed:"Completed",cancelled:"Cancelled"}[a]||a}Ht(()=>{G()}),Jt(()=>{});var ee=dr();Wt("keydown",Qt,ke);var de=z(ee),te=o(de),u=s(o(te),2);{var j=a=>{var d=qa(),v=o(d);l(d),S(()=>y(v,`Showing ${t(x).length??""} of ${t(h)??""} tasks`)),e(a,d)};E(u,a=>{t(X)||a(j)})}l(te);var O=s(te,2);ya(O,{});var V=s(O,2);{var ze=a=>{var d=Ma(),v=o(d,!0);l(d),S(()=>y(v,t(Z))),e(a,d)};E(V,a=>{t(Z)&&a(ze)})}var k=s(V,2);{var M=a=>{var d=Ka();e(a,d)},L=a=>{Oa(a,{get tasks(){return t(x)},get updatedTaskIds(){return t(ne)},onSelectTask:le,$$events:{select:xe}})};E(k,a=>{t(X)?a(M):a(L,!1)})}l(de);var N=s(de,2);{var A=a=>{var d=nr();d.__click=ue,d.__keydown=n=>n.key==="Enter"&&$e();var v=o(d);v.__click=n=>n.stopPropagation(),v.__keydown=n=>n.stopPropagation();var T=o(v),R=o(T),P=o(R,!0);l(R);var $=s(R,2);$.__click=$e;var K=o($);oa(K,{class:"size-4"}),m(2),l($),l(T);var w=s(T,2),ie=o(w),H=o(ie);{let n=ae(()=>fe(f.task.status));he(H,{"data-testid":"task-status-badge",get class(){return t(n)},children:(p,b)=>{m();var U=g();S(I=>y(U,I),[()=>re(f.task.status)]),e(p,U)},$$slots:{default:!0}})}var me=s(H,2);he(me,{variant:"outline",children:(n,p)=>{m();var b=g();S(()=>y(b,`Priority: ${f.task.priority??""}`)),e(n,b)},$$slots:{default:!0}});var J=s(me,2);{var Bt=n=>{he(n,{variant:"outline",children:(p,b)=>{m();var U=g();S(()=>y(U,f.task.type)),e(p,U)},$$slots:{default:!0}})};E(J,n=>{f.task.type!=="task"&&n(Bt)})}l(ie);var it=s(ie,2);{var Rt=n=>{var p=Wa(),b=s(o(p),2),U=o(b,!0);l(b),l(p),S(I=>{Je(b,"href",`${Ke??""}/items?ref=${I??""}`),y(U,f.task.spec_ref)},[()=>encodeURIComponent(f.task.spec_ref)]),e(n,p)};E(it,n=>{f.task.spec_ref&&n(Rt)})}var ct=s(it,2);{var Et=n=>{var p=Xa(),b=s(o(p),2);Fe(b,21,()=>f.task.tags,De,(U,I)=>{he(U,{variant:"secondary",children:(q,Q)=>{m();var _e=g();S(()=>y(_e,t(I))),e(q,_e)},$$slots:{default:!0}})}),l(b),l(p),e(n,p)};E(ct,n=>{f.task.tags?.length>0&&n(Et)})}var Qe=s(ct,2),Ft=o(Qe);{var Dt=n=>{var p=Ha(),b=s(z(p),2);Fe(b,21,()=>f.task.depends_on,De,(U,I)=>{var q=Ga(),Q=o(q),_e=o(Q,!0);l(Q),l(q),S(Pe=>{Je(Q,"href",`${Ke??""}/tasks?ref=${Pe??""}`),y(_e,t(I))},[()=>encodeURIComponent(t(I))]),e(U,q)}),l(b),e(n,p)},jt=n=>{var p=Ja();e(n,p)};E(Ft,n=>{f.task.depends_on?.length>0?n(Dt):n(jt,!1)})}l(Qe);var vt=s(Qe,2);{var Lt=n=>{var p=Ya(),b=s(o(p),2);Fe(b,21,()=>f.task.blocked_by,De,(U,I)=>{var q=Qa(),Q=o(q,!0);l(q),S(()=>y(Q,t(I))),e(U,q)}),l(b),l(p),e(n,p)};E(vt,n=>{f.task.blocked_by?.length>0&&n(Lt)})}var ut=s(vt,2);nt(ut,{});var ft=s(ut,2);{var Ut=n=>{var p=tr(),b=o(p);{var U=I=>{var q=Ce(),Q=z(q);He(Q,()=>ia,(_e,Pe)=>{Pe(_e,{children:(qe,Ve)=>{var Me=er(),We=z(Me);{const Te=(Be,Re)=>{It(Be,wt(()=>Re?.().props,{"data-testid":"start-task-button",disabled:!0,class:"w-full",children:(pe,Xe)=>{m();var Mt=g("Start Task");e(pe,Mt)},$$slots:{default:!0}}))};He(We,()=>na,(Be,Re)=>{Re(Be,{child:Te,$$slots:{child:!0}})})}var we=s(We,2);He(we,()=>da,(Te,Be)=>{Be(Te,{children:(Re,et)=>{var pe=Za();e(Re,pe)},$$slots:{default:!0}})}),e(qe,Me)},$$slots:{default:!0}})}),e(I,q)};E(b,I=>{I(U)})}l(p),e(n,p)};E(ft,n=>{f.task.status==="pending"&&n(Ut)})}var _t=s(ft,2);{var zt=n=>{var p=ar(),b=o(p,!0);l(p),S(()=>y(b,t(C))),e(n,p)};E(_t,n=>{t(C)&&n(zt)})}var pt=s(_t,2);nt(pt,{});var Ye=s(pt,2),Vt=o(Ye);{var Nt=n=>{var p=sr(),b=s(z(p),2);Fe(b,21,()=>f.task.todos,De,(U,I)=>{var q=rr(),Q=o(q),_e=o(Q);{var Pe=we=>{var Te=g("✅");e(we,Te)},qe=we=>{var Te=Ce(),Be=z(Te);{var Re=pe=>{var Xe=g("⏳");e(pe,Xe)},et=pe=>{var Xe=g("⏸️");e(pe,Xe)};E(Be,pe=>{t(I).status==="in_progress"?pe(Re):pe(et,!1)},!0)}e(we,Te)};E(_e,we=>{t(I).status==="completed"?we(Pe):we(qe,!1)})}l(Q);var Ve=s(Q,2);let Me;var We=o(Ve,!0);l(Ve),l(q),S(()=>{Me=Ct(Ve,1,"",null,Me,{"line-through":t(I).status==="completed"}),y(We,t(I).content)}),e(U,q)}),l(b),e(n,p)},Ot=n=>{var p=lr();e(n,p)};E(Vt,n=>{f.task.todos&&f.task.todos.length>0?n(Nt):n(Ot,!1)})}l(Ye);var gt=s(Ye,2);nt(gt,{});var $t=s(gt,2),Ze=o($t),qt=o(Ze);l(Ze);var mt=s(Ze,2);E(mt,n=>{});var ht=s(mt,2);Fe(ht,21,()=>f.task.notes??[],De,(n,p)=>{var b=or(),U=o(b),I=o(U),q=o(I,!0);l(I);var Q=s(I,2),_e=o(Q,!0);l(Q),l(U);var Pe=s(U,2),qe=o(Pe,!0);l(Pe),l(b),S(Ve=>{y(q,t(p).author),y(_e,Ve),y(qe,t(p).content)},[()=>ye(t(p).created_at)]),e(n,b)}),l(ht),l($t),l(w),l(v),l(d),S(()=>{y(P,f.task.title),y(qt,`Notes (${f.task.notes?.length??0??""}):`)}),e(a,d)};E(N,a=>{f.open&&f.task&&a(A)})}e(F,ee),ve(),i()}Pt(["click","keydown"]);export{kr as component,xr as universal};
