_ulid: 01KEZCJPHVBKRZQ7VVBF84H51Z
slugs:
  - cli
  - cli-module
title: CLI Interface
type: module
status:
  maturity: draft
  implementation: not_started
description: |
  The kspec CLI is the primary interface to Kynetic Spec.
  Follows git's plumbing/porcelain model: low-level primitives
  for scripts/agents, high-level commands for humans.
features:
  - _ulid: 01KEZCJPHW3CSMXYZT01FP76BM
    slugs:
      - cli-design
    title: CLI Design Principles
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - mvp
      - cli
    description: |
      The CLI is designed for both human and agent use.
      Consistent structure, predictable output, clear errors.
    requirements:
      - _ulid: 01KEZCJPHWP32HK8MR38P2WSSJ
        slugs:
          - cli-structure
        title: Command Structure
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          Commands follow consistent structure:

          kspec <resource> <action> [args] [flags]

          Resources: item, task, link, todo, etc.
          Actions: add, get, list, set, delete, etc.

          Examples:
          - kspec item add --type feature --title "Login"
          - kspec task start @impl-login
          - kspec tasks ready
        implements:
          - '@cli-design'
      - _ulid: 01KEZCJPHWKVBFSAEP0MMH57DQ
        slugs:
          - cli-json-output
        title: JSON Output Mode
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          All commands support --json flag for structured output:

          kspec tasks ready --json
          kspec item get @login --json

          JSON output includes:
          - success: boolean
          - data: The result
          - errors: Array of error objects (if any)
        implements:
          - '@cli-design'
      - _ulid: 01KEZCJPHWB81SAWT4ZGCV75FC
        slugs:
          - cli-exit-codes
        title: Semantic Exit Codes
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          Exit codes are semantic, not just 0/1:

          - 0: Success
          - 1: General error
          - 2: Usage error (bad arguments)
          - 3: Not found
          - 4: Validation failed
          - 5: Conflict (already exists, etc.)

          Scripts can handle specific cases.
        implements:
          - '@cli-design'
      - _ulid: 01KEZCJPHWBEEP2BYRP6YVNK9F
        slugs:
          - cli-agent-features
        title: Agent-Friendly Features
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          Features for agent/script usage:

          - --json: Structured output
          - --no-prompt: Never prompt (KSPEC_NO_PROMPT=1)
          - --dry-run: Show what would happen
          - --if-not-exists: Idempotent creation
          - --quiet: Suppress non-essential output

          Agents should be able to use kspec without interaction.
        implements:
          - '@cli-design'
  - _ulid: 01KEZCJPHXV1SK9BY02J6GK719
    slugs:
      - item-commands
    title: Item Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - mvp
      - cli
    description: |
      CRUD operations for spec items.
      The foundation of CLI functionality.
    acceptance_criteria:
      - id: ac-item-cmd-1
        given: valid item data
        when: kspec item add runs
        then: item is created with auto-generated ULID
      - id: ac-item-cmd-2
        given: an existing item @login
        when: kspec item get @login runs
        then: full item data is displayed
    requirements:
      - _ulid: 01KEZCJPHXGMME0BZ5C65R5QH8
        slugs:
          - item-add
        title: kspec item add
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec item add [options]

          Options:
          - --type <type>: Item type (feature, requirement, etc.)
          - --title <title>: Required title
          - --slug <slug>: Optional slug (auto-generated if not provided)
          - --field key=value: Set additional fields
          - --parent <ref>: Nest under parent item

          Returns created item (with generated ULID).
        implements:
          - '@item-commands'
      - _ulid: 01KEZCJPHXKYVVP0YWF261A8N3
        slugs:
          - item-get
        title: kspec item get
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec item get <ref> [options]

          Options:
          - --field <path>: Get specific field only
          - --format <fmt>: Output format (yaml, json)

          Resolves @reference, displays full item.
        implements:
          - '@item-commands'
      - _ulid: 01KEZCJPHXT212CZV6W64YJFAQ
        slugs:
          - item-list
        title: kspec item list
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec item list [filters]

          Filters:
          - --type <type>: By item type
          - --status <status>: By maturity/implementation
          - --tag <tag>: By tag
          - --has-field <field>: Items with field present

          Returns list of matching items.
        implements:
          - '@item-commands'
      - _ulid: 01KEZCJPHX678F01J6TZE5SX1Q
        slugs:
          - item-set
        title: kspec item set
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec item set <ref> [options]

          Options:
          - --field <path> --value <value>: Set field
          - --data <yaml/json>: Patch with data

          Updates item in place. Use for status changes, etc.
        implements:
          - '@item-commands'
      - _ulid: 01KEZCJPHXH5SAZ7NWESVKWS3Y
        slugs:
          - item-delete
        title: kspec item delete
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec item delete <ref> [options]

          Options:
          - --force: Skip confirmation
          - --cascade: Delete children too

          Warns if item has references. Consider deprecation instead.
        implements:
          - '@item-commands'
  - _ulid: 01JHNKA8W6CTSK000000000000
    slugs:
      - task-commands
    title: Task Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - mvp
      - cli
    description: |
      Commands for task lifecycle management.
      State transitions, queries, notes, todos.
    requirements:
      - _ulid: 01JHNKA8W7CTSK100000000000
        slugs:
          - task-add
        title: kspec task add
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec task add [options]

          Options:
          - --title <title>: Task title
          - --type <type>: task, epic, bug, spike, infra
          - --spec-ref <ref>: Link to spec item
          - --depends-on <refs>: Dependencies
          - --priority <n>: Priority (1-5)

          Creates task in pending status.
        implements:
          - '@task-commands'
      - _ulid: 01JHNKA8W8CTSK200000000000
        slugs:
          - task-start
        title: kspec task start
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec task start <ref>

          Transitions task from pending to in_progress.
          Sets started_at timestamp.
          Fails if task is blocked or already in_progress.
        implements:
          - '@task-commands'
        depends_on:
          - '@state-in-progress'
      - _ulid: 01JHNKA8W9CTSK300000000000
        slugs:
          - task-complete
        title: kspec task complete
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec task complete <ref> [options]

          Options:
          - --reason <text>: Completion note

          Transitions task to completed status.
          Sets completed_at timestamp.
        implements:
          - '@task-commands'
        depends_on:
          - '@state-completed'
      - _ulid: 01JHNKA9W0CTSK400000000000
        slugs:
          - task-block
        title: kspec task block
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec task block <ref> [options]

          Options:
          - --reason <text>: Required blocker description

          Transitions task to blocked status.
          Adds reason to blocked_by array.
        implements:
          - '@task-commands'
        depends_on:
          - '@state-blocked'
      - _ulid: 01JHNKA9W1CTSK500000000000
        slugs:
          - task-unblock
        title: kspec task unblock
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec task unblock <ref>

          Transitions task from blocked back to in_progress (or pending).
          Clears blocked_by array.
        implements:
          - '@task-commands'
      - _ulid: 01JHNKA9W2CTSK600000000000
        slugs:
          - task-cancel
        title: kspec task cancel
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec task cancel <ref> [options]

          Options:
          - --reason <text>: Why cancelled

          Transitions task to cancelled status.
          Terminal state.
        implements:
          - '@task-commands'
        depends_on:
          - '@state-cancelled'
      - _ulid: 01KF0VJEHSCEQ5SVD6XRYV81M1
        slugs:
          - cmd-task-delete
        title: kspec task delete
        type: requirement
        tags: []
        description: |-
          kspec task delete <ref> [options]

          Options:
          - --force: Skip confirmation
          - --dry-run: Show what would be deleted

          Removes task from source file. Confirmation required unless --force.
        depends_on: []
        implements: []
        relates_to: []
        tests: []
        created: '2026-01-15T12:55:00.409Z'
  - _ulid: 01JHNKA9W3CQRY000000000000
    slugs:
      - query-commands
    title: Query Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - mvp
      - cli
    description: |
      Commands for querying spec and task data.
      The primary interface for understanding what exists and what's ready.
    requirements:
      - _ulid: 01JHNKA9W4CQRY100000000000
        slugs:
          - cmd-tasks-ready
        title: kspec tasks ready
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec tasks ready [options]

          Returns all tasks that are ready to work on:
          - status = pending
          - all depends_on completed
          - no blocked_by entries

          THE primary command for agents and humans.
        implements:
          - '@query-commands'
          - '@query-ready'
      - _ulid: 01JHNKA9W5CQRY200000000000
        slugs:
          - cmd-tasks-next
        title: kspec tasks next
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec tasks next

          Returns single highest-priority ready task.
          Useful for "give me something to do" workflow.
        implements:
          - '@query-commands'
          - '@query-next'
      - _ulid: 01JHNKA9W6CQRY300000000000
        slugs:
          - cmd-tasks-list
        title: kspec tasks list
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec tasks list [filters]

          General task listing with filters.
          See @query-filters for filter options.
        implements:
          - '@query-commands'
      - _ulid: 01JHNKA9W7CQRY400000000000
        slugs:
          - cmd-tasks-blocked
        title: kspec tasks blocked
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec tasks blocked

          Returns all blocked tasks with their blockers.
          Useful for identifying what's stuck.
        implements:
          - '@query-commands'
  - _ulid: 01KEZCJPHX1XC0F94K2HJ2F99X
    slugs:
      - link-commands
    title: Link Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: medium
    tags:
      - cli
    description: |
      Commands for managing relationships between items.
      Create, query, and remove links.
    requirements:
      - _ulid: 01KEZCJPHXWK4N7K72F0CFWBGN
        slugs:
          - link-create
        title: kspec link create
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec link create <from> <to> [options]

          Options:
          - --type <type>: Relationship type (depends_on, implements, etc.)

          Creates relationship from source to target.
          Updates the source item's relationship array.
        implements:
          - '@link-commands'
      - _ulid: 01KEZCJPHY64RH5PPE6WJSPH03
        slugs:
          - link-list
        title: kspec link list
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec link list [options]

          Options:
          - --from <ref>: Links from this item
          - --to <ref>: Links to this item
          - --type <type>: Filter by relationship type

          Shows relationships matching filters.
        implements:
          - '@link-commands'
      - _ulid: 01KEZCJPHYBD2BSED0D9ZHRMGQ
        slugs:
          - link-delete
        title: kspec link delete
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec link delete <from> <to> [options]

          Options:
          - --type <type>: Specific relationship type to remove

          Removes relationship. Updates source item.
        implements:
          - '@link-commands'
  - _ulid: 01KEZCJPHYBMBBKESVKBBV4CGM
    slugs:
      - validate-commands
    title: Validation Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - mvp
      - cli
    description: |
      Commands for validating spec and task integrity.
      Essential for CI and pre-commit checks.
    requirements:
      - _ulid: 01KEZCJPHYHN29QV8C088GVGD1
        slugs:
          - cmd-validate
        title: kspec validate
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec validate [options]

          Options:
          - --schema: Check schema conformance only
          - --refs: Check all @references resolve
          - --orphans: Find unreferenced items
          - --task-refs: Check task spec_refs resolve
          - --strict: Treat warnings as errors

          Default: All checks. Returns errors and warnings.
        implements:
          - '@validate-commands'
          - '@validation-modes'
      - _ulid: 01KEZCJPHYVBG79TSAVC1KB0SZ
        slugs:
          - cmd-lint
        title: kspec lint
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec lint [options]

          Options:
          - --fix: Auto-fix what's possible
          - --strict: Exit non-zero on warnings

          Combines validation with style checks.
          Good for CI: kspec lint --strict
        implements:
          - '@validate-commands'
  - _ulid: 01JHNKAA05CDRV000000000000
    slugs:
      - derive-commands
    title: Derive Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - mvp
      - cli
    description: |
      Commands for deriving tasks from spec items.
      Explicit, on-demand task creation.
    requirements:
      - _ulid: 01JHNKAA06CDRV100000000000
        slugs:
          - cmd-derive
        title: kspec derive
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec derive <ref> [options]
          kspec derive --all [options]

          Options:
          - --force: Create even if task exists
          - --dry-run: Show what would be created

          Creates task(s) with spec_ref pointing to item(s).
          Idempotent by default.
        implements:
          - '@derive-commands'
          - '@derive-command'
  - _ulid: 01KEZCJPHYV1GH5KP8T0VSXWWS
    slugs:
      - init-commands
    title: Init and Config Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - mvp
      - cli
    description: |
      Commands for initializing and configuring kspec.
      Project setup and configuration management.
    requirements:
      - _ulid: 01KEZCJPHYDTPQ34W8FRXQ9GKX
        slugs:
          - cmd-init
        title: kspec init
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec init [options]

          Options:
          - --name <name>: Project name
          - --single-file: Create kynetic.yaml only (vs directory)

          Creates initial spec structure:
          - spec/kynetic.yaml (manifest)
          - spec/modules/ (if not --single-file)

          Interactive prompts unless --no-prompt.
        implements:
          - '@init-commands'
      - _ulid: 01KEZCJPHYZKAW6006AM7P5KWT
        slugs:
          - cmd-hooks
        title: kspec hooks
        type: requirement
        status:
          maturity: draft
          implementation: not_started
        description: |
          kspec hooks install     # Install configured hooks
          kspec hooks uninstall   # Remove hooks
          kspec hooks list        # Show configured hooks

          Reads hooks from manifest config section.
          Sets up git hooks for validation.
        implements:
          - '@init-commands'
  - _ulid: 01KF0WJEHSINBOX00000000000
    slugs:
      - inbox-commands
    title: Inbox Commands
    type: feature
    status:
      maturity: draft
      implementation: not_started
    priority: high
    tags:
      - cli
      - process
    description: |
      Low-friction capture for ideas that aren't tasks yet.
      Inbox items are simple text entries that can be triaged later.
      Storage: project.inbox.yaml (separate file for clean schema).
    requirements:
      - _ulid: 01KF0WJEHSINBOX10000000000
        slugs:
          - cmd-inbox-add
        title: kspec inbox add
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec inbox add <text> [options]

          Options:
          - --tag <tag>: Add tag(s) for categorization (repeatable)

          Quick capture with minimal friction.
          Auto-generates ULID, timestamp, and added_by (from KSPEC_AUTHOR or git).

          Examples:
          - kspec inbox add "maybe we need better error messages"
          - kspec inbox add "refactor auth flow" --tag auth --tag refactor
        implements:
          - '@inbox-commands'
      - _ulid: 01KF0WJEHSINBOX20000000000
        slugs:
          - cmd-inbox-list
        title: kspec inbox list
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec inbox list [options]

          Options:
          - --tag <tag>: Filter by tag
          - --limit <n>: Limit results
          - --oldest: Sort oldest first (default for triage)

          Shows inbox items. Default sort is oldest first to
          encourage dealing with older items.
        implements:
          - '@inbox-commands'
      - _ulid: 01KF0WJEHSINBOX30000000000
        slugs:
          - cmd-inbox-promote
        title: kspec inbox promote
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec inbox promote <ref> [options]

          Options:
          - --title <title>: Task title (prompts if not provided)
          - --priority <n>: Priority (1-5)
          - --spec-ref <ref>: Link to spec item
          - --type <type>: Task type (task, bug, spike, etc.)
          - --tag <tag>: Add tag(s) to task

          Converts inbox item to task. Prompts for required fields
          if not provided via options. Deletes inbox item after
          successful task creation.

          Examples:
          - kspec inbox promote @01KF0... (interactive)
          - kspec inbox promote @01KF0... --title "Improve errors" --priority 2
        implements:
          - '@inbox-commands'
      - _ulid: 01KF0WJEHSINBOX40000000000
        slugs:
          - cmd-inbox-delete
        title: kspec inbox delete
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec inbox delete <ref> [options]

          Options:
          - --force: Skip confirmation

          Removes inbox item. Use when idea is no longer relevant.
        implements:
          - '@inbox-commands'
requirements:
  - _ulid: 01KF109BR2PZACTM1Y91NWEEJQ
    slugs:
      - cmd-session-checkpoint
    title: kspec session checkpoint
    type: requirement
    tags: []
    description: >-
      Pre-stop hook for Claude Code integration.


      Checks for uncommitted work before allowing session to end:

      - Uncommitted git changes (staged, unstaged, untracked)

      - Tasks in in_progress status

      - Incomplete todos on active tasks


      One-time trigger: Reads hook arguments to detect if already triggered. First trigger blocks
      with instructions, subsequent triggers allow stop.


      Output: JSON formatted for Claude Code hook consumption with clear kspec-branded message
      instructing agent to document progress and commit changes.
    depends_on: []
    implements: []
    relates_to: []
    tests: []
    created: '2026-01-15T14:17:25.508Z'
