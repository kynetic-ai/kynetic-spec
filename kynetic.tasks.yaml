tasks:
  - _ulid: 01JHNKAB01TASK100000000000
    slugs:
      - task-project-setup
    title: Set up TypeScript project with Zod
    type: task
    description: |
      Initialize the kspec CLI project:
      - TypeScript + Node.js project structure
      - Zod for schema validation
      - Build tooling (tsup or similar)
      - Basic package.json with bin entry
    derivation: manual
    status: completed
    blocked_by: []
    closed_reason: Bootstrap complete - project fully set up and self-hosting
    depends_on: []
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - foundation
      - infra
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.951Z'
    started_at: '2026-01-14T17:00:00Z'
    completed_at: '2026-01-14T17:20:00Z'
    notes:
      - _ulid: 01KEYRJ953HRYWJ0W4XEG6J9FB
        created_at: '2026-01-14T17:00:00Z'
        author: '@claude'
        content: |
          Bootstrap approach: Used parallel subagents working in git worktrees.
          One agent wrote the spec (bootstrap-spec branch), another wrote the
          parser (bootstrap-parser branch). Branches merged after alignment.
      - _ulid: 01KEYRJ95AMA2JDAN9RMJ1Q2R3
        created_at: '2026-01-14T17:10:00Z'
        author: '@claude'
        content: |
          Tech stack chosen:
          - TypeScript + Node.js (ESM modules)
          - Zod for schema validation
          - Commander for CLI framework
          - js-yaml for YAML parsing
          - ulid for ID generation
          - Vitest for testing
          - chalk for colored output
      - _ulid: 01KEYRJ95AAPYJAY169ERRFSNH
        created_at: '2026-01-14T17:15:00Z'
        author: '@claude'
        content: |
          Project structure (~1,500 lines TypeScript):
          - src/schema/ - Zod schemas (common, spec, task)
          - src/parser/ - YAML loading and file management
          - src/cli/ - Command handlers (tasks, task)
          - tests/ - Vitest test suite
      - _ulid: 01KEYRJ95A6VKGXGZ84R6TQ517
        created_at: '2026-01-14T17:18:00Z'
        author: '@claude'
        content: |
          Schema alignment fix: Initial mismatch between spec and parser
          (parallel development). Fixed by making created_at optional with
          default, adding description field. First real issue resolved
          using the self-hosting system.
    todos: []
  - _ulid: 01JHNKAB02TASK110000000000
    slugs:
      - task-ulid-generation
    title: Implement ULID generation and resolution
    type: task
    description: |
      Implement ULID handling:
      - Generate new ULIDs (use ulid library)
      - Shorten ULIDs for display (first 6+ chars)
      - Resolve short ULIDs to full (with ambiguity detection)
    spec_ref: '@ulid-system'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-project-setup'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - core
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.952Z'
    started_at: '2026-01-14T22:18:49.872Z'
    completed_at: '2026-01-14T22:18:51.210Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB03TASK120000000000
    slugs:
      - task-slug-system
    title: Implement slug management and resolution
    type: task
    description: |
      Implement slug handling:
      - Validate slug format (lowercase, alphanumeric, hyphens)
      - Build slug-to-ULID index
      - Resolve slugs to ULIDs
      - Detect and report duplicates
    spec_ref: '@slug-system'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-project-setup'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - core
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.952Z'
    started_at: '2026-01-14T22:18:52.551Z'
    completed_at: '2026-01-14T22:18:53.903Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB04TASK130000000000
    slugs:
      - task-reference-resolution
    title: Implement @reference resolution
    type: task
    description: |
      Implement reference resolution:
      - Parse @ prefix to extract identifier
      - Try slug lookup first, then ULID prefix
      - Report unresolved references
      - Handle ambiguous references
    spec_ref: '@reference-system'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: >-
      Implemented ReferenceIndex with dynamic ULID shortening, proper error handling, and reference
      validation
    depends_on:
      - '@task-ulid-generation'
      - '@task-slug-system'
      - '@task-yaml-loading'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - core
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.952Z'
    started_at: '2026-01-14T23:23:21.734Z'
    completed_at: '2026-01-14T23:31:29.287Z'
    notes:
      - _ulid: 01KEZD4BHZFA5E4FQ0182JKXRA
        created_at: '2026-01-14T23:23:24.096Z'
        author: '@claude'
        content: >-
          Starting work on reference resolution. User noted that 6-char ULID prefixes aren't
          granular enough since ULIDs created at similar times share timestamp prefixes. Will
          implement dynamic prefix expansion for uniqueness.
        supersedes: null
      - _ulid: 01KEZDJZRTZ6D3QWY1X7FZH5BG
        created_at: '2026-01-14T23:31:23.547Z'
        author: '@claude'
        content: >-
          Implemented reference resolution system:


          1. Created ReferenceIndex class (src/parser/refs.ts) with:
             - Slug index (slug → ULID mapping)
             - ULID index for direct lookups
             - resolve() method with proper error handling (not_found, ambiguous, duplicate_slug)
             - shortUlid() for dynamic prefix computation (min 8 chars, expands for uniqueness)
             - validateRefs() to find all broken references in spec

          2. Updated CLI (src/cli/commands/task.ts):
             - All task commands now use ReferenceIndex for lookups
             - Better error messages showing ambiguous matches with short ULIDs + slugs
             - Output uses dynamic short ULIDs

          3. Added comprehensive tests for:
             - Slug resolution
             - Full/short ULID resolution
             - Ambiguity detection
             - Duplicate slug detection
             - Reference validation

          The 8-char minimum prefix gets into the random portion of ULIDs, fixing the issue where
          items created at similar times would have identical 6-char prefixes.
        supersedes: null
      - _ulid: 01KEZE05XQQGTDKMRZ2S0BPVNH
        created_at: '2026-01-14T23:38:35.832Z'
        author: '@claude'
        content: >-
          Additional follow-up: Updated all CLI locations to use dynamic shortUlid():


          - output.ts: formatTaskRef, formatTask, formatTaskList now accept optional ReferenceIndex

          - tasks.ts: All commands (list, ready, next, blocked, in-progress) build index and pass to
          formatters

          - task.ts: task add command builds index including new task for accurate short ULID


          Short IDs now dynamically expand based on uniqueness within the spec. Items created in the
          same timestamp batch (e.g., 01JHNKAB*) show 10+ chars, while items with unique prefixes
          show the minimum 8 chars.
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB06TASK200000000000
    slugs:
      - task-zod-schemas
    title: Define Zod schemas for spec items
    type: task
    description: |
      Define comprehensive Zod schemas:
      - BaseItem schema (common fields)
      - Type-specific schemas (feature, requirement, etc.)
      - Task schema (with task-specific fields)
      - Nested schemas (status, acceptance_criteria, etc.)
    spec_ref: '@zod-schema'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-project-setup'
    context: []
    priority: 1
    complexity: 3
    tags:
      - mvp
      - schema
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.952Z'
    started_at: '2026-01-14T22:18:55.247Z'
    completed_at: '2026-01-14T22:18:56.562Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB07TASK210000000000
    slugs:
      - task-yaml-loading
    title: Implement YAML file loading
    type: task
    description: |
      Implement spec loading:
      - Parse manifest (kynetic.yaml)
      - Handle includes (load referenced files)
      - Support glob patterns in includes
      - Build unified item collection
    spec_ref: '@file-structure'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: >-
      Full spec loading implemented with recursive item extraction, glob includes, and ULID
      migration
    depends_on:
      - '@task-zod-schemas'
    context: []
    priority: 1
    complexity: 3
    tags:
      - mvp
      - schema
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.952Z'
    started_at: '2026-01-14T23:04:25.740Z'
    completed_at: '2026-01-14T23:15:14.678Z'
    notes:
      - _ulid: 01KEZCN7G9WB9J852E0X90JDXX
        created_at: '2026-01-14T23:15:08.426Z'
        author: '@claude'
        content: >-
          Implemented full YAML spec loading:

          - Added LoadedSpecItem interface for source file tracking

          - Implemented expandIncludePattern() with glob support (*.yaml patterns)

          - Added extractItemsFromRaw() for recursive nested item extraction from
          modules/features/requirements

          - Implemented loadAllItems() to build unified item collection from manifest + includes

          - Added findItemByRef() and findAnyItemByRef() for item lookup

          - Fixed YAML syntax error in core.yaml (unquoted @references)

          - Created ULID migration script (scripts/migrate-ulids.ts) and migrated 59 invalid ULIDs
          to valid Crockford base32

          - Added comprehensive tests for spec loading (extractItemsFromRaw, findItemByRef,
          expandIncludePattern, loadAllItems integration)

          - All 45 tests passing
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB08TASK220000000000
    slugs:
      - task-item-indexing
    title: Build item index for queries
    type: task
    description: |
      Build queryable index:
      - Index by ULID (primary key)
      - Index by slug (lookup)
      - Index by type (filtering)
      - Enable efficient lookups
    derivation: manual
    status: completed
    blocked_by: []
    closed_reason: >-
      Implemented ItemIndex with multi-criteria queries and CLI commands for item
      list/get/types/tags
    depends_on:
      - '@task-yaml-loading'
      - '@task-reference-resolution'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - schema
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.952Z'
    started_at: '2026-01-15T03:32:24.893Z'
    completed_at: '2026-01-15T03:36:45.665Z'
    notes:
      - _ulid: 01KEZVM219JSJ3DCGZDK3ADVTG
        created_at: '2026-01-15T03:36:38.698Z'
        author: '@claude'
        content: >-
          Implemented ItemIndex class (src/parser/items.ts) with:

          - Indexes by type, tag, status (task status, maturity, implementation)

          - Multi-criteria query() method supporting: type, tags, allTags, status, maturity,
          implementation, hasFields, fieldEquals, titleContains

          - Pagination via queryPaginated()

          - Convenience methods: getByType(), getByTag(), getTasksByStatus(), getByMaturity(),
          getByImplementation()

          - Stats: getTypes(), getTags(), getTypeCounts(), getTagCounts()


          Added CLI commands (src/cli/commands/item.ts):

          - kspec item list [filters] - list items with --type, --status, --maturity, --tag, --has,
          --search

          - kspec item get <ref> - show item details

          - kspec item types - show type counts

          - kspec item tags - show tag counts


          Added buildIndexes() helper to build both ReferenceIndex and ItemIndex together.
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB10TASK300000000000
    slugs:
      - task-schema-validation
    title: Implement schema validation
    type: task
    description: |
      Implement Zod-based validation:
      - Validate each item against schema
      - Collect all errors (don't fail fast)
      - Format errors with item context
    spec_ref: '@validation-modes'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: Implemented kspec validate with schema, reference, and orphan checks
    depends_on:
      - '@task-zod-schemas'
      - '@task-yaml-loading'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - validation
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.952Z'
    started_at: '2026-01-15T03:44:44.224Z'
    completed_at: '2026-01-15T03:48:11.313Z'
    notes:
      - _ulid: 01KEZW902C94QSBJHMVQAJER00
        created_at: '2026-01-15T03:48:04.813Z'
        author: '@claude'
        content: |-
          Implemented schema validation module (src/parser/validate.ts):
          - Schema validation: validates manifests, task files, and spec files against Zod schemas
          - Reference validation: checks all @references resolve (reuses validateRefs from refs.ts)
          - Orphan detection: finds items not referenced (excludes tasks/modules as entry points)

          CLI commands:
          - kspec validate - run all checks
          - kspec validate --schema - schema only
          - kspec validate --refs - refs only
          - kspec validate --orphans - orphans only
          - kspec validate --strict - treat orphans as errors
          - kspec lint - alias for validate

          Validation found real issues in kspec's own spec:
          - 4 broken refs to @milestone-self-hosting (doesn't exist)
          - 72 orphaned spec items (requirements nested under features - may be false positives)
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB11TASK310000000000
    slugs:
      - task-ref-validation
    title: Implement reference validation
    type: task
    description: |
      Validate all @references:
      - Scan all relationship fields
      - Check each reference resolves
      - Report broken references with context
      - Warn on deprecated targets
    spec_ref: '@ref-validation'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: >-
      Implemented as part of schema validation task. Core functionality complete: @ prefix parsing,
      slug/ULID resolution, error reporting. Deprecated target warnings deferred (minor
      enhancement).
    depends_on:
      - '@task-reference-resolution'
      - '@task-item-indexing'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - validation
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-15T03:57:21.544Z'
    completed_at: '2026-01-15T03:57:21.544Z'
    notes:
      - _ulid: 01KEZWSRT1B1RJRDDX48FF62F0
        created_at: '2026-01-15T03:57:14.434Z'
        author: '@claude'
        content: >-
          Reference validation was implemented as part of @01JHNKAB10 (schema validation task). The
          implementation covers:


          1. ✅ Parse @ prefix to extract identifier

          2. ✅ Slug lookup, then ULID prefix match resolution

          3. ✅ Error reporting for unresolved/ambiguous references

          4. ⏳ Deprecated target warnings - not implemented (requires deprecated field on items,
          minor enhancement)


          CLI: kspec validate --refs works and successfully found 4 broken @milestone-self-hosting
          refs which were fixed in @01KEZWDH.
        supersedes: null
    todos: []
  - _ulid: 01KEZWVQ5PTQY5V5F6ZTSE3Z9S
    slugs:
      - task-deprecated-warnings
    title: Warn on deprecated targets in reference validation
    type: task
    description: |
      Add warnings when references point to deprecated items:
      - Add deprecated field to item schema (or use implementation: deprecated)
      - Check resolved targets for deprecated status
      - Report as warnings (not errors) in validation output
    spec_ref: '@ref-validation'
    derivation: manual
    status: pending
    blocked_by: []
    depends_on:
      - '@task-ref-validation'
    context: []
    priority: 3
    complexity: 1
    tags:
      - post-mvp
      - validation
      - enhancement
    vcs_refs: []
    created_at: '2026-01-15T03:58:00.000Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB12TASK320000000000
    slugs:
      - task-validation-output
    title: Implement validation output formatting
    type: task
    description: |
      Format validation results:
      - Human-readable output (default)
      - JSON output (--json flag)
      - Exit codes based on severity
    spec_ref: '@validation-output'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: Implemented as part of schema validation. Human-readable and JSON output both working.
    depends_on:
      - '@task-schema-validation'
      - '@task-ref-validation'
    context: []
    priority: 1
    complexity: 1
    tags:
      - mvp
      - validation
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-15T04:02:49.716Z'
    completed_at: '2026-01-15T04:02:49.716Z'
    notes:
      - _ulid: 01KEZX3RGQN6TCCMBJGZ9HAFJ6
        created_at: '2026-01-15T04:02:41.816Z'
        author: '@claude'
        content: >-
          Already implemented as part of @01JHNKAB10 (schema validation). Verified:

          - Errors: schema errors and ref errors shown in red

          - Warnings: orphans shown in yellow  

          - Summary counts: files/items/tasks checked

          - JSON output: --json flag outputs structured JSON with valid, schemaErrors, refErrors,
          orphans
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB14TASK400000000000
    slugs:
      - task-task-loading
    title: Implement task loading from files
    type: task
    description: |
      Load tasks:
      - Find .tasks.yaml files alongside specs
      - Support tasks/ directory structure
      - Merge into unified task collection
      - Index by ULID and slug
    spec_ref: '@task-storage'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-yaml-loading'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - tasks
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-14T22:19:00.659Z'
    completed_at: '2026-01-14T22:19:02.013Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB15TASK410000000000
    slugs:
      - task-ready-computation
    title: Implement ready task computation
    type: task
    description: |
      Compute ready tasks:
      - Filter to status=pending
      - Check all depends_on are completed
      - Check no blocked_by entries
      - Sort by priority, then created_at
    spec_ref: '@derived-ready'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-task-loading'
      - '@task-reference-resolution'
    context: []
    priority: 1
    complexity: 3
    tags:
      - mvp
      - tasks
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-14T22:19:03.347Z'
    completed_at: '2026-01-14T22:19:04.657Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB16TASK420000000000
    slugs:
      - task-state-transitions
    title: Implement task state transitions
    type: task
    description: |
      Implement state machine:
      - Validate transitions (pending->in_progress, etc.)
      - Update timestamps (started_at, completed_at)
      - Write changes back to file
    spec_ref: '@task-states'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-task-loading'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - tasks
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-14T22:19:05.991Z'
    completed_at: '2026-01-14T22:19:07.297Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB18TASK500000000000
    slugs:
      - task-cli-framework
    title: Set up CLI framework
    type: task
    description: |
      Set up CLI foundation:
      - Use commander.js or similar
      - Set up resource/action command structure
      - Implement --json flag handling
      - Implement --no-prompt / KSPEC_NO_PROMPT
    spec_ref: '@cli-structure'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-project-setup'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-14T22:18:57.927Z'
    completed_at: '2026-01-14T22:18:59.268Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB19TASK510000000000
    slugs:
      - task-cmd-init
    title: Implement kspec init command
    type: task
    description: |
      Implement initialization:
      - Create spec/kynetic.yaml manifest
      - Create spec/modules/ directory
      - Prompt for project name (unless --no-prompt)
      - Support --single-file option
    spec_ref: '@cmd-init'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: Implemented init command with full scaffolding, prompts, and all CLI options per spec
    depends_on:
      - '@task-cli-framework'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-15T03:21:03.159Z'
    completed_at: '2026-01-15T03:23:08.625Z'
    notes:
      - _ulid: 01KEZTV4M6NVQVFBWAJFJKAQZV
        created_at: '2026-01-15T03:23:02.150Z'
        author: '@claude'
        content: >-
          Implemented kspec init command with all specified options:

          - --name <name>: Set project name

          - --single-file: Create kynetic.yaml only (no modules directory)

          - --no-prompt: Skip interactive prompts

          - --force: Overwrite existing files

          - [directory]: Optional target directory


          Generated files:

          - spec/kynetic.yaml (manifest with project metadata, includes, config)

          - spec/<dirname>.tasks.yaml (empty tasks file)

          - spec/modules/main.yaml (starter module with example item, unless --single-file)


          Uses Node's built-in readline for interactive prompts. Derives default project name from
          directory name (kebab-case to Title Case).
        supersedes: null
      - _ulid: 01KEZV2Y8H47MPF28P4DNS2BAZ
        created_at: '2026-01-15T03:27:17.778Z'
        author: '@claude'
        content: |-
          Fixed file naming to use project slug:
          - 'My Cool Project' → my-cool-project.yaml, my-cool-project.tasks.yaml
          - Consistent with kynetic-spec's own pattern (kynetic.yaml for 'Kynetic Spec')
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB20TASK520000000000
    slugs:
      - task-cmd-validate
    title: Implement kspec validate command
    type: task
    description: |
      Implement validation command:
      - Run schema and ref validation
      - Support --schema, --refs flags
      - Output errors and warnings
      - Exit with semantic code
    spec_ref: '@cmd-validate'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: Implemented in src/cli/commands/validate.ts with all specified options plus JSON output.
    depends_on:
      - '@task-cli-framework'
      - '@task-validation-output'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-15T04:03:48.236Z'
    completed_at: '2026-01-15T04:03:48.236Z'
    notes:
      - _ulid: 01KEZX5K4QEDWB9C760H9WW9Z1
        created_at: '2026-01-15T04:03:41.848Z'
        author: '@claude'
        content: |-
          Already implemented in src/cli/commands/validate.ts. All options working:
          - --schema: schema conformance check
          - --refs: reference resolution check
          - --orphans: unreferenced items check
          - --strict: treat orphans as errors
          - Also includes --json for programmatic output and 'lint' alias
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB21TASK530000000000
    slugs:
      - task-cmd-tasks-ready
    title: Implement kspec tasks ready command
    type: task
    description: |
      THE MVP command - show ready tasks:
      - List all ready tasks
      - Show title, priority, spec_ref
      - Support --json output
      - This enables self-hosting!
    spec_ref: '@cmd-tasks-ready'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-cli-framework'
      - '@task-ready-computation'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-14T22:19:08.607Z'
    completed_at: '2026-01-14T22:19:09.956Z'
    notes: []
    todos: []
  - _ulid: 01JHNKAB22TASK540000000000
    slugs:
      - task-cmd-task-lifecycle
    title: Implement task lifecycle commands
    type: task
    description: |
      Implement state transition commands:
      - kspec task start <ref>
      - kspec task complete <ref>
      - kspec task block <ref>
      - kspec task unblock <ref>
      - kspec task cancel <ref>
    spec_ref: '@task-commands'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: 'Audit confirmed: implemented during bootstrap'
    depends_on:
      - '@task-cli-framework'
      - '@task-state-transitions'
    context: []
    priority: 1
    complexity: 2
    tags:
      - mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.953Z'
    started_at: '2026-01-14T22:19:11.259Z'
    completed_at: '2026-01-14T22:19:12.605Z'
    notes: []
    todos: []
  - _ulid: 01KEZ9514JSG75X4R0BCXYBE1Y
    slugs:
      - task-fix-write-location
    title: Fix task write location routing
    type: task
    description: |
      Fix the mismatch between task read and write locations.
      Currently all writes go to root/tasks.yaml regardless of
      where tasks were loaded from.

      Requirements:
      1. Track source file when loading tasks (_sourceFile metadata)
      2. Write existing tasks back to their source file
      3. Route new tasks based on rules:
         - Has spec_ref → derive location from spec item's file
           (e.g., spec_ref: @cmd-init in cli.yaml → cli.tasks.yaml)
         - No spec_ref → project.tasks.yaml (meta/planning work)
      4. Support moving tasks between files if needed

      Affected code:
      - src/parser/yaml.ts: loadAllTasks(), saveTask(), getDefaultTaskFilePath()
      - src/cli/commands/task.ts: all write operations
    derivation: manual
    status: completed
    blocked_by: []
    closed_reason: Core write routing implemented - tasks save to source file
    depends_on:
      - '@task-task-loading'
    context: []
    priority: 1
    complexity: 3
    tags:
      - mvp
      - bug
      - critical
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.940Z'
    started_at: '2026-01-14T22:00:00Z'
    completed_at: '2026-01-14T22:20:52.967Z'
    notes:
      - _ulid: 01KEZ9514JSG75X4R0BCXYBE1Z
        created_at: '2026-01-14T22:00:00Z'
        author: '@claude'
        content: |
          Implementation in progress:
          - Added LoadedTask interface with _sourceFile tracking
          - Modified loadAllTasks() to track source file for each task
          - Updated saveTask() to write to _sourceFile when present
          - Changed default path to spec/project.tasks.yaml for new tasks
          - Fixed bug where tasks: wrapper format wasn't parsed correctly
      - _ulid: 01KEZ95XGDX6WZXQYSWW0R1YMC
        created_at: '2026-01-14T22:14:20.942Z'
        author: '@claude'
        content: Testing write fix - this should update spec/kynetic.tasks.yaml
        supersedes: null
      - _ulid: 01KEZ9HT3XT9FYPD1A7J73R87E
        created_at: '2026-01-14T22:20:50.687Z'
        author: '@claude'
        content: |-
          Implementation complete:
          - LoadedTask interface tracks _sourceFile for each task
          - loadAllTasks() assigns _sourceFile when loading
          - saveTask() writes to _sourceFile (or default for new tasks)
          - Default for new tasks: spec/project.tasks.yaml
          - Fixed parsing bug for tasks: wrapper without kynetic_tasks version
          Side effect: YAML reformatting loses comments (tracked in @task-yaml-formatting)
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB24TASK600000000000
    slugs:
      - task-cmd-item-crud
    title: Implement item CRUD commands
    type: task
    description: |
      Full item management:
      - kspec item add
      - kspec item get
      - kspec item list
      - kspec item set
      - kspec item delete
    spec_ref: '@item-commands'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: >-
      Implemented item CRUD (add/set/delete) with full nested structure support. Items can be added
      under any parent, updated in place, and deleted from the YAML tree.
    depends_on: []
    context: []
    priority: 2
    complexity: 3
    tags:
      - post-mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.954Z'
    started_at: '2026-01-15T04:10:34.580Z'
    completed_at: '2026-01-15T04:20:09.513Z'
    notes:
      - _ulid: 01KEZY3GS10994BNNMY1HAVMFT
        created_at: '2026-01-15T04:20:02.466Z'
        author: '@claude'
        content: |-
          Implemented full item CRUD with nested structure support:

          - item add: Creates items under a parent (--under @parent)
          - item set: Updates fields including status/maturity
          - item delete: Removes items from nested structures

          Key implementation details:
          - Added _path tracking to LoadedSpecItem for navigating nested YAML
          - parsePath/navigateToPath helpers for tree navigation
          - addChildItem() adds to parent's features/requirements/etc array
          - updateSpecItem() modifies items in place
          - deleteSpecItem() removes from parent array via splice

          Tested: add feature under @core, set description/status, delete - all work correctly.
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB25TASK610000000000
    slugs:
      - task-cmd-derive
    title: Implement kspec derive command
    type: task
    description: |
      Auto-create tasks from spec items:
      - kspec derive @feature
      - kspec derive --all
      - Idempotent (skip if task exists)
    spec_ref: '@cmd-derive'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: Implemented derive command with single ref, --all, --dry-run, --force options
    depends_on: []
    context: []
    priority: 2
    complexity: 2
    tags:
      - post-mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.954Z'
    started_at: '2026-01-15T12:40:42.628Z'
    completed_at: '2026-01-15T12:44:44.833Z'
    notes:
      - _ulid: 01KF0TZD39CTE0Y0YDQW73P79K
        created_at: '2026-01-15T12:44:36.330Z'
        author: '@claude'
        content: |-
          Implemented kspec derive command with:
          - Single ref: kspec derive @spec-ref
          - All specs: kspec derive --all
          - Dry run: --dry-run shows what would be created
          - Force: --force creates task even if one exists
          - Idempotent by default (skips if task already exists)
          - Auto-generates task slug from spec title
          - Copies priority and tags from spec item
          - Sets derivation: auto to mark as automatically derived
        supersedes: null
    todos: []
  - _ulid: 01JHNKAB26TASK620000000000
    slugs:
      - task-notes-todos
    title: Implement notes and todos
    type: task
    description: |
      Work log features:
      - kspec task note <ref> "message"
      - kspec todo add/done/promote
      - Append-only with supersession
    spec_ref: '@task-notes'
    derivation: auto
    status: completed
    blocked_by: []
    closed_reason: Implemented todo commands for task management
    depends_on: []
    context: []
    priority: 2
    complexity: 2
    tags:
      - post-mvp
      - tasks
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.954Z'
    started_at: '2026-01-15T04:30:32.052Z'
    completed_at: '2026-01-15T04:33:54.181Z'
    notes:
      - _ulid: 01KEZYWPCFD1QCH08QF5Z5C9RQ
        created_at: '2026-01-15T04:33:47.408Z'
        author: '@claude'
        content: >-
          Implemented todo commands: task todos (list), task todo add, task todo done, task todo
          undone. Added createTodo helper. Updated extended help for task and workflow topics.
        supersedes: null
    todos:
      - id: 1
        text: Test adding a todo item
        done: false
        added_at: '2026-01-15T04:31:54.074Z'
        added_by: '@claude'
      - id: 2
        text: Another test todo
        done: false
        added_at: '2026-01-15T04:32:32.173Z'
        added_by: '@claude'
  - _ulid: 01JHNKAB27TASK630000000000
    slugs:
      - task-link-commands
    title: Implement link management commands
    type: task
    description: |
      Relationship management:
      - kspec link create
      - kspec link list
      - kspec link delete
    spec_ref: '@link-commands'
    derivation: auto
    status: in_progress
    blocked_by: []
    depends_on: []
    context: []
    priority: 3
    complexity: 2
    tags:
      - post-mvp
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:14:20.954Z'
    started_at: '2026-01-18T06:22:30.751Z'
    notes:
      - _ulid: 01KF7WB96R0TR3EAFSB2M4EP6M
        created_at: '2026-01-18T06:23:15.161Z'
        author: '@claude'
        content: >-
          Analyzed existing code structure. Link commands will manage 3 relationship types:
          depends_on, implements, relates_to. These are arrays of @references stored on spec items.
          Will follow similar pattern to item commands with create/list/delete operations that
          update source YAML files via parser functions.
        supersedes: null
    todos: []
  - _ulid: 01KEZ9DSD3C6VM82ZK6596JHWS
    slugs:
      - task-yaml-formatting
    title: Preserve YAML formatting and comments on save
    type: task
    description: |
      When saving tasks, the current implementation parses and re-serializes
      YAML, which loses comments, original formatting, and structure.

      Problems:
      - Comments (section headers, inline notes) are lost
      - Original formatting (indentation, key ordering) changes
      - Blank lines between sections disappear

      Options to explore:
      1. YAML library that preserves comments (yaml with CST mode)
      2. Patch-based updates (find and modify specific task in place)
      3. Accept reformatting for programmatic files only
      4. Store comments as metadata to re-insert

      This significantly affects user experience for human-edited files.
    derivation: manual
    status: pending
    blocked_by: []
    depends_on:
      - '@task-fix-write-location'
    context: []
    priority: 4
    complexity: 3
    tags:
      - post-mvp
      - dx
    vcs_refs: []
    created_at: '2026-01-14T22:20:00Z'
    notes: []
    todos: []
  - _ulid: 01KEZB4J6BJ6RHA11Y5Z7WSV3N
    slugs:
      - task-meta-spec
    title: Design meta-spec concept for agent/project definitions
    type: spike
    description: |
      Explore and define a "meta-spec" - a section of the spec that governs
      how work happens, separate from what's being built.

      The distinction:
      - Spec: What we're building (features, requirements, constraints)
      - Meta-spec: How we work (agents, workflows, conventions)

      What belongs in meta-spec:
      - Agent definitions (roles, capabilities, when to use)
      - Workflows (session start, handoff, review protocols)
      - Conventions (naming, tagging, commit style, note-writing)
      - Scratchpad/context (current focus, open questions, threads)
      - Project-level decisions that aren't product decisions

      Structure options:
      1. spec/meta/ directory with separate files
      2. Single meta.yaml with sections
      3. Top-level meta: key in manifest
      4. Separate manifest (kynetic.meta.yaml)

      Questions to resolve:
      - How does meta-spec relate to CLAUDE.md / AGENTS.md?
      - Should meta-spec be a kspec primitive or convention?
      - Can meta-specs be shared/inherited across projects?
      - How do agents discover and use meta-spec?

      Outcome:
      - Clear definition of what meta-spec is
      - Proposed structure/location
      - Relationship to existing files (CLAUDE.md, etc.)
      - Maybe: spec items defining meta-spec as a feature
    derivation: manual
    status: completed
    blocked_by: []
    closed_reason: >-
      Spec design complete with 8 features, 32 requirements. Ready for implementation tasks to be
      derived.
    depends_on: []
    context:
      - '@task-session-start'
      - '@task-kspec-skill'
    priority: 2
    complexity: 2
    tags:
      - design
      - dx
      - architecture
    vcs_refs: []
    created_at: '2026-01-14T22:40:00Z'
    started_at: '2026-01-15T18:32:58.727Z'
    completed_at: '2026-01-15T18:32:58.727Z'
    notes:
      - _ulid: 01KEZB4J6BJ6RHA11Y5Z7WSV3P
        created_at: '2026-01-14T22:40:00Z'
        author: '@claude'
        content: |
          Origin: Session wrap-up discussion about context continuity.
          Realized that session protocols, agent workflows, and project
          conventions are distinct from product specs but need a home.
          Meta-spec separates "what we build" from "how we work."
      - _ulid: 01KF1EX3D9T6M55FDMX5PM1BZ8
        created_at: '2026-01-15T18:32:52.393Z'
        author: '@claude'
        content: >-
          Completed spec design for meta-spec system. Created spec/modules/meta.yaml with 8 features
          and 32 requirements covering: meta manifest, agent definitions, workflow definitions,
          conventions, observations (feedback loop), session context, meta CLI commands, and
          meta-ref integration. Key decisions: separate manifest (kynetic.meta.yaml) that
          complements prose docs, ephemeral session context in .kspec-session, observations
          promotable to tasks, unified validation.
        supersedes: null
    todos: []
  - _ulid: 01KEZAT35YG043XQMCH0GXPJZD
    slugs:
      - task-session-start
    title: Implement kspec session start command
    type: task
    description: |
      Create a command that surfaces relevant context at the start of a
      new working session. Helps agents/humans resume work with minimal
      context loss.

      Command: kspec session start (or kspec context, kspec resume)

      What it surfaces:
      - Tasks in in_progress state (active work)
      - Recent notes on active tasks (quality over quantity)
      - Recent commits (last N or since timestamp)
      - Ready tasks (what could be picked up)
      - Open questions / blockers if tagged

      Options:
      - --brief: Compact summary (default)
      - --full: Comprehensive context dump
      - --since <time>: Filter by recency
      - --json: Machine-readable output

      Smart filtering:
      - Prioritize recent over comprehensive
      - Show notes, not full descriptions
      - Truncate intelligently
      - Focus on actionable context

      Workflow integration:
      - Part of the kspec skill guidance
      - Agents run this at session start
      - Complements habit of writing notes during work

      The loop:
      1. Session start → read context
      2. Work → add notes as you go
      3. Session end → notes persist
      4. Next session start → context available
    derivation: manual
    status: completed
    blocked_by: []
    closed_reason: >-
      Implemented session start command with all planned features: time utilities, git integration,
      formatted output with brief/full modes, JSON support, and aliases
    depends_on:
      - '@task-task-loading'
    context:
      - '@task-kspec-skill'
    priority: 2
    complexity: 2
    tags:
      - dx
      - workflow
      - cli
    vcs_refs: []
    created_at: '2026-01-14T22:35:00Z'
    started_at: '2026-01-15T02:06:46.355Z'
    completed_at: '2026-01-15T02:09:53.691Z'
    notes:
      - _ulid: 01KEZPN0SZAFZV6915NSW9Q40C
        created_at: '2026-01-15T02:09:47.328Z'
        author: '@claude'
        content: >-
          Implemented session start command with:


          - New utilities: src/utils/time.ts (parseTimeSpec, formatRelativeTime), src/utils/git.ts
          (getRecentCommits, isGitRepo, getCurrentBranch)

          - Main command: src/cli/commands/session.ts with full SessionContext type, data gathering,
          and formatted output

          - Commands: `kspec session start`, `kspec session resume`, `kspec context` (alias)

          - Options: --brief (default), --full, --since <time>, --no-git, -n/--limit, --json

          - Output shows: active tasks, recent notes, ready tasks, blocked tasks, git commits, stats
          summary

          - All tests pass, TypeScript compiles clean
        supersedes: null
      - _ulid: 01KEZQV3G3R8B5JSEPH4TYZMKR
        created_at: '2026-01-15T02:30:35.268Z'
        author: '@claude'
        content: |-
          Added 'Recently Completed' section to session context output:

          - Shows tasks completed recently (filtered by --since if provided, otherwise last N)
          - Displays completed_at timestamp and closed_reason if present
          - Appears after 'Active Work' section to show what was just wrapped up
          - Helps with session handoffs and context continuity
        supersedes: null
      - _ulid: 01KEZRJ7JAJXY6TBKH7MNE14YM
        created_at: '2026-01-15T02:43:13.098Z'
        author: '@claude'
        content: |-
          Added 'Working Tree' section showing git status:

          - Shows staged files (green), modified/unstaged files (red), untracked files (gray)
          - Appears at the end of session context
          - Shows 'Working Tree: Clean' when no uncommitted changes
          - Respects --no-git flag
          - Untracked files limited to 5 in brief mode
        supersedes: null
    todos: []
  - _ulid: 01KEZ9VV3KTTNVK82ZWPVD3XBD
    slugs:
      - task-kspec-skill
    title: Create Claude Code skill for kspec
    type: task
    description: |
      Build a Claude Code skill that enables natural interaction with kspec.
      This skill will be both distributed as an installable plugin AND used
      in this project itself (dogfooding).

      Skill capabilities (evolving):
      - Query tasks: "what's ready to work on?", "show blocked tasks"
      - Manage tasks: "start working on X", "complete task X with reason"
      - Add notes: "add note to task X about what I did"
      - Navigate specs: "what does feature X require?"
      - Create tasks: "create a task for implementing Y"

      Distribution:
      - Installable via Claude Code skill/MCP plugin system
      - Instructions in markdown format (KSPEC_SKILL.md or similar)
      - Could be published to a skill registry when available

      Self-hosting:
      - Use the skill in this project's CLAUDE.md
      - Current CLAUDE.md already has basic kspec instructions
      - Skill would be more comprehensive and context-aware

      Implementation:
      - Start with markdown-based skill definition
      - Define slash commands (/kspec, /task, /spec)
      - Include guidance on when to check tasks, add notes, etc.
      - Evolve based on actual usage patterns
    derivation: manual
    status: completed
    blocked_by: []
    closed_reason: >-
      Implemented kspec skill with frontmatter, core workflows, command reference, and key
      principles
    depends_on: []
    context: []
    priority: 2
    complexity: 2
    tags:
      - dx
      - tooling
      - claude-code
    vcs_refs: []
    created_at: '2026-01-14T22:25:00Z'
    started_at: '2026-01-15T15:46:25.756Z'
    completed_at: '2026-01-15T15:48:15.322Z'
    notes:
      - _ulid: 01KEZ9VV3KTTNVK82ZWPVD3XBE
        created_at: '2026-01-14T22:25:00Z'
        author: '@claude'
        content: |
          Context: Claude Code supports skills (markdown instruction files) that
          can be loaded to give Claude specialized capabilities. The kspec skill
          would teach Claude how to work with specs and tasks naturally.

          Current CLAUDE.md has basic commands but a dedicated skill would be
          more comprehensive and could be shared with other kspec users.
      - _ulid: 01KEZMS39EM9F7BR8KTG2N5SR1
        created_at: '2026-01-15T01:37:03.791Z'
        author: '@claude'
        content: >-
          Related to @task-setup-cmd: The skill can include manual setup instructions as fallback if
          kspec setup auto-detection fails. Skill should mention:

          - KSPEC_AUTHOR env var for author attribution

          - How to add to ~/.claude/settings.json manually

          - Or just run 'kspec setup' if available
        supersedes: null
      - _ulid: 01KEZVZWP2S6JVHXP68T2VSSC7
        created_at: '2026-01-15T03:43:06.435Z'
        author: '@claude'
        content: |-
          Idea: Add a stop hook that detects in-progress tasks and prompts action.

          When the conversation ends (stop hook fires):
          1. Check for tasks with status=in_progress
          2. If found, remind/push Claude to:
             - Add a note summarizing work done so far
             - Either complete the task or leave it in_progress with context
             - Prevents orphaned in_progress tasks with no notes

          This ensures task state stays consistent even when sessions end unexpectedly.
          Could use 'kspec tasks in-progress' to detect, then inject a prompt like:
          'You have in-progress tasks without recent notes. Please update them before ending.'
        supersedes: null
      - _ulid: 01KEZYGZ4ECJXCPS5CKX5CBHE0
        created_at: '2026-01-15T04:27:23.151Z'
        author: '@claude'
        content: >-
          Related: @task-bulk-import


          If bulk import is implemented, the skill should teach agents about:

          - Using 'kspec import' for rapid spec capture during design discussions

          - The simplified YAML format for quick item authoring

          - When to use import vs individual 'item add' commands


          If skill is implemented first, bulk import should update the skill file with new
          capabilities.
        supersedes: null
      - _ulid: 01KF15CKYEGXA9Y4AMBD43ARX1
        created_at: '2026-01-15T15:46:35.087Z'
        author: '@claude'
        content: >-
          Starting work. Will create a Claude Code skill file that teaches Claude how to use kspec
          commands effectively. Need to research skill format and determine best location/structure.
        supersedes: null
      - _ulid: 01KF15F5KQBZ1JTKPRN4VF8F5A
        created_at: '2026-01-15T15:47:58.712Z'
        author: '@claude'
        content: >-
          Created .claude/skills/kspec/SKILL.md with frontmatter (name, description), core workflows
          (session start, task lifecycle, inbox, spec-first), command reference table, and key
          principles. Skill will auto-invoke when Claude detects kspec-related requests.
        supersedes: null
    todos: []
  - _ulid: 01KEZ9DSD9W7JY4HP92JPY6WAN
    slugs:
      - task-integration-testing
    title: Implement integration testing with fixtures
    type: task
    description: |
      Set up integration testing infrastructure that tests the CLI and
      library as they are actually used, with fixture-based test data.

      Requirements:
      1. Create tests/fixtures/ directory with sample specs and tasks
      2. Copy fixtures to temp directory before each test (don't mutate originals)
      3. Test CLI commands end-to-end (spawn process, check output/files)
      4. Test library functions with realistic data structures
      5. Verify file writes go to correct locations
      6. Test format preservation (when implemented)

      Testing approach:
      - Pure integration tests (no mocking)
      - Fixtures represent real-world usage patterns
      - Each test gets fresh copy of fixtures
      - Assert on actual file contents and CLI output
    derivation: manual
    status: completed
    blocked_by: []
    closed_reason: >-
      Added integration test suite with fixtures covering validate, tasks, items, derive, and
      session commands
    depends_on: []
    context: []
    priority: 2
    complexity: 2
    tags:
      - infra
      - testing
    vcs_refs: []
    created_at: '2026-01-14T22:20:00Z'
    started_at: '2026-01-15T15:57:56.272Z'
    completed_at: '2026-01-15T16:02:09.859Z'
    notes:
      - _ulid: 01KF161NRT90NT32JZJASGXAGM
        created_at: '2026-01-15T15:58:05.083Z'
        author: '@claude'
        content: >-
          Starting work. Will set up integration test infrastructure with fixtures for testing CLI
          commands end-to-end.
        supersedes: null
      - _ulid: 01KF168J8D809S1EVBBSVSYE30
        created_at: '2026-01-15T16:01:50.862Z'
        author: '@claude'
        content: >-
          Implemented integration testing: created fixtures directory with sample manifest, tasks,
          and module files. Added integration.test.ts with 19 tests covering validate, task
          lifecycle, task add, items, derive, and session commands. All 82 tests pass.
        supersedes: null
    todos: []
