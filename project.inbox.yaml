inbox:
  - _ulid: 01KF150ZY1Z272H5CF55NQ4JBP
    text: >-
      Subagent review on task complete - when agent marks task complete, include instructions to
      spawn review subagent. Subagent runs kspec task review to get task details, linked spec,
      acceptance criteria, git diff since started_at. Reports gaps between spec and implementation
      back to main agent. Configurable via setup (opt-in/out). Ties into alignment system.
    created_at: '2026-01-15T15:40:14.146Z'
    tags:
      - review
      - agents
      - process
    added_by: '@claude'
  - _ulid: 01KF16XGA6SNNRHFPX15N0HE6F
    text: >-
      Hook for SessionStart or post-compaction to inject relevant context and subtle instructions.
      Could auto-run 'kspec session start' or similar to give agent fresh context after memory is
      compacted.
    created_at: '2026-01-15T16:13:16.998Z'
    tags: []
    added_by: '@claude'
  - _ulid: 01KF1JPF8P6VDNPY4S9YAJ797P
    text: >-
      Artifacts feature - storage for large files and non-text artifacts tied to specs/tasks. Use
      cases: reference images, research docs, generated diagrams, data files, PDFs. Unknowns:
      integration model (spec-ref? task-ref? standalone?), reference syntax (@artifact?),
      organization (by task? by type? flat?), cleanup/lifecycle (archive with task? manual?),
      storage location (artifacts/ dir? .kspec/artifacts?), git handling (LFS? gitignore?
      committed?).
    created_at: '2026-01-15T19:39:09.462Z'
    tags:
      - feature
      - design
      - artifacts
    added_by: '@claude'
  - _ulid: 01KF1V53RYTWER59VR53W1CSTW
    text: >-
      Spec review process: 3 parallel agents (internal fit, prior art comparison, external research)
      before finalizing major specs. Worked well for shadow branch spec design - should be
      formalized in meta-spec workflows.
    created_at: '2026-01-15T22:06:57.823Z'
    tags:
      - workflow
      - meta
    added_by: '@claude'
  - _ulid: 01KF28DKM459J41MP8HDMCMEVC
    text: >-
      Spec notes feature - append-only notes on spec items for capturing implementation gotchas,
      learnings, and context. Similar to task notes but for specs. Use case: documenting things like
      'git worktree prune needed for orphaned worktrees' that are valuable for
      maintenance/reimplementation but don't belong in formal AC.
    created_at: '2026-01-16T01:58:47.685Z'
    tags:
      - feature
      - spec
      - dx
    added_by: '@claude'
  - _ulid: 01KF292BRXGAFQBJGJAJKY8RF6
    text: >-
      Test coverage tracking per spec item - link tests to spec items, show coverage in item get,
      warn when AC lacks tests
    created_at: '2026-01-16T02:10:07.774Z'
    tags:
      - feature
      - testing
      - spec
    added_by: '@claude'
  - _ulid: 01KF3HG0PHS4N4ME6NXQ4RZTE2
    text: >-
      Alignment system spec coverage gap - AlignmentIndex, auto-sync, validation commands (kspec
      item status, alignment check) were implemented pragmatically without spec. Need to create spec
      items documenting: alignment concept, AlignmentIndex structure, auto-sync behavior, alignment
      validation, guidance output format.
    created_at: '2026-01-16T13:56:38.226Z'
    tags:
      - spec-gap
      - alignment
      - debt
    added_by: '@claude'
  - _ulid: 01KF3MVM96A3T653E70QKB0F2Z
    text: >-
      Item list --tree or --hierarchy flag - shows parent/child structure for finding where to place
      new items. Friction: during triage had to grep/search to find @cli module since flat list
      doesn't show nesting.
    created_at: '2026-01-16T14:55:24.454Z'
    tags:
      - reflection
      - cli
      - dx
    added_by: '@claude'
  - _ulid: 01KF3PJWJS42Y0QZFKWMX3A4D9
    text: >-
      CLI output parity - JSON and human-readable outputs can drift when adding features.
      Investigate patterns to keep them in sync by design: unified output formatter, schema-driven
      rendering, shared data structure that both modes consume. Current pattern: output(data,
      humanFormatter) - data goes to JSON, formatter handles human. But formatter can show
      derived/computed info that isn't in data.
    created_at: '2026-01-16T15:25:35.193Z'
    tags:
      - cli
      - dx
      - design
    added_by: '@claude'
  - _ulid: 01KF3TB7C5GCC7VADGZ9YDKXK6
    text: >-
      Integration test performance - tests take 50-75s which discourages frequent runs. Investigate:
      parallel test execution, fixture caching, test isolation overhead, selective test runs
      (--grep). Goal: fast feedback loop during development.
    created_at: '2026-01-16T16:31:18.406Z'
    tags:
      - testing
      - dx
      - performance
    added_by: '@claude'
  - _ulid: 01KF3TRCMB5SN4GRM2E9PG5ZGB
    text: >-
      task start should output spec context, notes, and AC testing guidance - remind about automated
      tests not just manual verification
    created_at: '2026-01-16T16:38:29.772Z'
    tags:
      - cli
      - dx
    added_by: '@claude'
  - _ulid: 01KF3XAY7DRQ8J7E6YTNAPV2FS
    text: >-
      Stale status detection in validate - warn when: (1) umbrella/parent task is pending but child
      spec items are all implemented, (2) spec item marked implemented but no completed tasks
      reference it, (3) task marked completed but linked spec still not_started. Could be part of
      --completeness flag or separate --staleness check. Detected manually this session: Shadow
      Branch parent task was pending while all children implemented.
    created_at: '2026-01-16T17:23:34.765Z'
    tags:
      - validation
      - dx
      - reflection
    added_by: '@claude'
  - _ulid: 01KF42TV18D7HC8S9G4GR9S8ZB
    text: >-
      kspec log enhancements - (1) Without ref argument, show all commits with Task:/Spec: trailers
      (all tracked commits in order). (2) Support passthrough of typical git log args like -p,
      --stat, etc. Could use -- separator for passthrough args: kspec log @ref -- -p --stat
    created_at: '2026-01-16T18:59:38.665Z'
    tags:
      - cli
      - enhancement
    added_by: '@claude'
  - _ulid: 01KF4DAESR4C4K6VHWY0MNSW79
    text: >-
      Add --priority flag to derive command to override default P3 when deriving tasks from specs
      without explicit priority
    created_at: '2026-01-16T22:02:56.184Z'
    tags:
      - cli
      - derive
    added_by: '@claude'
  - _ulid: 01KF4DS5K10SKW9A533DQR7TH0
    text: >-
      Investigate ready task ordering beyond priority - creation order may not be ideal. Consider:
      recency of notes/activity, dependency depth, spec item priority inheritance, manual ordering
      field, tags for urgency
    created_at: '2026-01-16T22:10:58.273Z'
    tags:
      - design
      - tasks
      - dx
    added_by: '@claude'
  - _ulid: 01KF4FM90P16F3KCVN43SQBBB8
    text: >-
      Standardize multi-target --refs pattern across CLI commands. Allow --refs @a @b @c to apply
      operations to multiple items. Could work for: task set, item set, task complete, etc. Design
      how it interacts with existing single-ref positional args.
    created_at: '2026-01-16T22:43:15.094Z'
    tags:
      - cli
      - design
      - dx
    added_by: '@claude'
  - _ulid: 01KF554T97ST9B3DMT4WMXACYQ
    text: >-
      Ralph Wiggum / Looper Mode - Create a kspec-integrated autonomous loop runner. Core idea: a
      script that runs Claude Code repeatedly with fresh context, using a templated prompt that
      instructs it to:


      1. Run 'kspec session start' to see ready tasks

      2. Pick a well-defined task (high priority, clear spec, no blockers)

      3. Work on it until completion or stuck

      4. Commit and complete the task

      5. Exit cleanly (the outer loop restarts with fresh context)


      Key features from research:

      - Simple core: while :; do cat PROMPT.md | claude ; done

      - Context persists via filesystem/git, not session memory

      - Dual-condition exit: require both completion indicator AND explicit exit signal

      - Circuit breaker: stop after N loops with no progress or repeated errors

      - Rate limiting for API calls


      Kspec-specific additions:

      - Task selection heuristics (prioritize: clear AC, no blockers, isolated scope)

      - Progress tracking via task notes before each exit

      - Session checkpoint before exit to ensure clean state

      - Maybe: task budget (only attempt tasks under estimated N turns)


      The beauty is each iteration starts fresh but inherits cumulative work. Bad iterations don't
      compound context - they just waste one run.
    created_at: '2026-01-17T04:59:17.160Z'
    tags:
      - automation
      - workflow
      - agents
    added_by: '@claude'
  - _ulid: 01KF5YSJPEN2N36PMEZ4X3WPZD
    text: >-
      Ralph streaming mode + library refactor: Consider supporting streaming output mode for ralph.
      If going that far, switch from CLI to library/SDK. Evaluate using ACP (Agent Client Protocol
      by Zed editor team) - reference implementation exists in ../kynetic project. Could borrow
      patterns for tracking iterations and all agent interactions to create audit trail.
    created_at: '2026-01-17T12:27:31.918Z'
    tags:
      - ralph
      - design
      - streaming
    added_by: '@claude'
  - _ulid: 01KF6541Q2CXEXRYFFHAGD53H4
    text: >-
      Ralph TUI mode: Optional terminal UI for ralph that provides real-time visualization of agent
      progress, event stream, session status. Would build on streaming/ACP foundation. Lower
      priority than core auditability work.
    created_at: '2026-01-17T14:18:06.435Z'
    tags:
      - ralph
      - tui
      - optional
    added_by: '@claude'
  - _ulid: 01KF68ATB9QQCJ5A31M4RZJ7BP
    text: >-
      Stub spec pattern: Formalize the practice of creating spec items with status:deferred (or
      similar) for known future work. This captures well-scoped deferrals more formally than inbox,
      with rationale for why deferred. Consider: (1) adding 'deferred' as official status option,
      (2) guidance on when to use stub spec vs inbox, (3) how deferred specs relate to
      backlog/roadmap.
    created_at: '2026-01-17T15:14:13.994Z'
    tags:
      - pattern
      - spec-system
    added_by: '@claude'
  - _ulid: 01KF6FBK4FEE1MK8M9MRFHCNSN
    text: >-
      Setup command improvements for existing kspec repos: When cloning a repo that already uses
      kspec (has kspec-meta branch), the setup/init flow should detect this and automatically create
      the .kspec worktree. Currently requires manual 'git worktree add .kspec kspec-meta'. Could
      also detect missing worktree on any command and prompt to fix, or auto-fix with a flag.
    created_at: '2026-01-17T17:16:59.407Z'
    tags:
      - setup
      - dx
    added_by: '@claude'
  - _ulid: 01KF6FM8KNMB7ZKG8A1AK42N9S
    text: >-
      Create INSTALL.md with agent-focused setup instructions: Step-by-step guide for agents to
      install kspec in a new or existing repo from scratch. Should cover: npm install, kspec init,
      worktree setup for existing repos, common gotchas. Written for AI agents rather than humans -
      concise, copy-pasteable commands, clear success criteria.
    created_at: '2026-01-17T17:21:43.542Z'
    tags:
      - docs
      - dx
      - agents
    added_by: '@claude'
  - _ulid: 01KF6H34MJMWQ8R54AZZ8FKCCH
    text: >-
      ACP type safety audit: Review and strengthen typing across ACP client implementation. Current
      state has respondPermission() typed but other handlers use 'unknown'. Consider: (1) Add typed
      response methods for file/read, file/write, terminal/run (2) Type the request params using SDK
      types (3) Evaluate if we're correctly implementing the full ACP protocol - check SDK docs for
      any missing methods or incorrect assumptions (4) Consider whether respond(unknown) should be
      deprecated in favor of typed methods only. The { granted: true } bug showed the value of
      compile-time enforcement.
    created_at: '2026-01-17T17:47:19.570Z'
    tags:
      - acp
      - types
      - tech-debt
    added_by: '@claude'
  - _ulid: 01KF6KS7H5D8R6H1YHX8BH2FHS
    text: >-
      Adapter validation on startup: Before spawning ACP agent, verify the adapter package exists
      (npx dry-run or version check). Would catch wrong package names like @anthropic-ai vs
      @zed-industries immediately with clear error instead of cryptic 'JsonRpcFraming closed' after
      connection fails.
    created_at: '2026-01-17T18:34:20.582Z'
    tags:
      - ralph
      - dx
      - validation
    added_by: '@claude'
  - _ulid: 01KF6KSAC2Z2PT2Q96WDJEH4ZA
    text: >-
      ACP mock protocol fidelity: Update tests/mocks/acp-mock.js to require permission requests like
      the real agent does. Currently mock auto-succeeds tool calls without permission flow. Would
      have caught the { granted: true } format bug in tests rather than live testing.
    created_at: '2026-01-17T18:34:23.491Z'
    tags:
      - testing
      - acp
      - mock
    added_by: '@claude'
  - _ulid: 01KF6KSD76HC0TVHSZ1KT6DD9B
    text: >-
      Test repo setup command: Add 'kspec clone-for-testing' or similar that creates isolated repo
      copy with: no remote origin, kspec-meta branch available, .kspec worktree set up, specified
      branch checked out. Eliminates manual setup errors like forgotten worktree that caused stale
      data confusion.
    created_at: '2026-01-17T18:34:26.407Z'
    tags:
      - cli
      - dx
      - testing
    added_by: '@claude'
  - _ulid: 01KF6P374JY2DV5V15RRAJ9AKV
    text: >-
      Reinforce task creation with implementation notes: When deriving tasks from specs, add
      implementation notes capturing actionable guidance - not just what to build, but how. Include:
      (1) implementation approach with specific patterns/references from prior art, (2)
      pitfalls/learnings from related work to avoid repeating mistakes, (3) file locations and
      function names to reference. Sets agents up for success rather than discovery. This session
      demonstrated value - research on kynetic chat UI + beads history produced concrete notes that
      will save future implementation time.
    created_at: '2026-01-17T19:14:45.010Z'
    tags:
      - workflow
      - dx
      - agents
    added_by: '@claude'
  - _ulid: 01KF6Q6ES226T0NP8B8VA52HZ6
    text: >-
      Spec status persistence gap: When task start syncs spec implementation status to in_progress,
      this change should be committed or included with the task start commit. Currently the status
      update happens but may not be persisted until later work creates a commit. The gap was noticed
      when spec went in_progress but wasn't captured in the commit stream.
    created_at: '2026-01-17T19:33:59.715Z'
    tags:
      - workflow
      - spec
      - gap
    added_by: '@claude'
  - _ulid: 01KF6RSJGSZKPVVDW7FW488PWV
    text: >-
      Git hook for kspec-meta branch protection: Add a pre-commit or pre-push git hook in the main
      repo that prevents dangerous operations on kspec-meta branch. Would complement the Claude
      PreToolUse hook with git-level protection. Consider: (1) pre-commit hook rejecting commits
      that modify .kspec worktree incorrectly, (2) pre-push hook preventing force pushes to
      kspec-meta, (3) post-checkout hook warning if .kspec worktree gets on wrong branch. This
      protects against non-Claude git operations too.
    created_at: '2026-01-17T20:01:54.714Z'
    tags:
      - git
      - workflow
      - safety
    added_by: '@claude'
  - _ulid: 01KF6V4EMT4PJ3PV9NN7HVZNVH
    text: >-
      Ralph iteration complete message joins with agent text: The 'OK Completed iteration 1' message
      appears on the same line as the last agent message content because streaming doesn't end with
      newline. Need to ensure newline before iteration status messages. Related to finalization -
      when agent message stream ends, should ensure trailing newline.
    created_at: '2026-01-17T20:42:48.347Z'
    tags:
      - ralph
      - bug
    added_by: '@claude'
  - _ulid: 01KF6V88KCJ1SD31TJ035MG4YJ
    text: >-
      PreToolUse:Bash hook error on tool approval: When tools are approved, there's an error shown
      '⎿ PreToolUse:Bash hook error'. Need to investigate kspec-worktree-guard.sh - may be failing
      silently on certain inputs or returning invalid JSON in some cases. Should handle edge cases
      gracefully and return valid JSON even on unexpected input.
    created_at: '2026-01-17T20:44:53.228Z'
    tags:
      - ralph
      - bug
      - hooks
    added_by: '@claude'
  - _ulid: 01KF6VFK9BP2Y6CDFATSHHWNKN
    text: >-
      AC test coverage guidance: Acceptance criteria without corresponding tests are risky - the
      finalization bug showed code can be unreachable/broken without tests catching it. Consider:
      (1) Add guidance to AGENTS.md that AC should have tests, (2) Validation warning for specs with
      AC but no tests linked, (3) Task completion check for test coverage of linked spec AC. The
      'tests' relationship type exists but isn't enforced.
    created_at: '2026-01-17T20:48:53.547Z'
    tags:
      - process
      - testing
      - spec-system
    added_by: '@claude'
  - _ulid: 01KF712PXGE3CBDRMEN3QMXFJE
    text: >-
      Document kspec worktree architecture in AGENTS.md: .kspec/ is a git worktree on kspec-meta
      branch, CLI commands that modify specs auto-commit to that branch, agents don't need to
      manually commit spec changes or check .kspec git status
    created_at: '2026-01-17T22:26:42.736Z'
    tags: []
    added_by: '@claude'
  - _ulid: 01KF76613RPTM6BH401FEBRBBZ
    text: >-
      Bootstrap kynetic.meta.yaml has invalid 28-char ULIDs instead of 26-char. Need to regenerate
      all meta item ULIDs. Validation now catches this!
    created_at: '2026-01-17T23:55:54.360Z'
    tags: []
    added_by: '@claude'
  - _ulid: 01KF78BTC2XMB2JJCDQKS0CWV0
    text: >-
      PR review workflow: When reviewing own PRs created by previous iterations, fix trivial issues
      directly (like invalid ULIDs) rather than leaving comments. Merge when checks pass unless
      changes are substantial. This keeps momentum going.
    created_at: '2026-01-18T00:34:01.218Z'
    tags:
      - reflection
      - workflow
    added_by: '@claude'
  - _ulid: 01KF7A1YGXBN420NR2J2QZDD7A
    text: >-
      Reflection: ULID validation strictness caught real bugs - test fixtures had 24-char ULIDs that
      were passing because MetaUlidSchema was too lenient. Fixing schema to use UlidSchema forced
      proper fixture ULIDs. Important pattern: schema strictness prevents silent data corruption.
    created_at: '2026-01-18T01:03:34.941Z'
    tags: []
    added_by: '@claude'
  - _ulid: 01KF7B2KJR80ZSXGXC91FFHPNR
    text: >-
      Workflow implementation pattern worked well - reused agent command structure (formatTable,
      formatVerbose, JSON output via output()). The meta schema and parser were already complete,
      only needed CLI command and tests. Reference validation integration was clean - just added
      meta_ref to REF_FIELDS. Pattern: schema → parser → CLI → tests.
    created_at: '2026-01-18T01:21:25.081Z'
    tags:
      - pattern
      - meta
      - dx
    added_by: '@claude'
  - _ulid: 01KF7BWBVAHZZA6QGCBCZFG4AC
    text: >-
      Reference implementation value: Checked ../kspec-acp-test before implementing observations.
      Found identical spec and working implementation which provided clear blueprint. Saved
      significant design time and avoided edge cases. Having parallel agent repos with prior work is
      highly valuable for consistency.
    created_at: '2026-01-18T01:35:29.130Z'
    tags:
      - reflection
      - workflow
      - dx
    added_by: '@claude'
  - _ulid: 01KF7CHTCR6VC829Q0KDQEWPV6
    text: >-
      Meta reference integration implementation was straightforward thanks to existing
      ReferenceIndex infrastructure that already supported meta items. The validation pattern
      (resolve ref, check if task/spec item, error if not meta) works well and is reusable. Tests
      pass reliably with good coverage of edge cases.
    created_at: '2026-01-18T01:47:12.153Z'
    tags:
      - reflection
      - meta
    added_by: '@claude'
  - _ulid: 01KF7GS42S4VF3SBP1PG6NNGB0
    text: >-
      Successfully implemented three meta CLI commands (conventions, get, list) in one iteration.
      The pattern of implementing formatters first, then command registration works well. Testing is
      fast and reliable - all 31 tests pass. The unified 'get' and 'list' commands provide good
      discoverability across meta item types.
    created_at: '2026-01-18T03:01:05.753Z'
    tags:
      - dx
      - meta
    added_by: '@claude'
  - _ulid: 01KF7KPT6F0W1XXXG8QEAV51ZP
    text: >-
      Review subagent workflow proved critical - caught reference matching bug before merge.
      Pattern: (1) Initial review identifies issues, (2) Fix issues, (3) Final review confirms
      fixes. The iterative review loop prevents broken code from reaching main. Should formalize as
      workflow convention.
    created_at: '2026-01-18T03:52:15.823Z'
    tags:
      - reflection
      - workflow
      - review
    added_by: '@claude'
  - _ulid: 01KF7MGV986G6QFAT2853AKP75
    text: >-
      Iteration 4 findings: (1) Inbox and task notes live in shadow branch (.kspec/) not main -
      explains why 'git status' on main showed clean after adding inbox items. (2) Task @01KF3E5H
      blocked by file auto-revert issue - implementation code deleted by linter twice. (3) Session
      started on stale branch from previous iteration. (4) Session context showed completed task as
      ready. All documented in other inbox items.
    created_at: '2026-01-18T04:06:28.904Z'
    tags:
      - reflection
      - ralph
      - meta
    added_by: '@claude'
  - _ulid: 01KF7N97446YKT8D4FT2E9N003
    text: >-
      PR workflow efficiency - Ralph loop iteration completed full cycle: reviewed existing PR,
      fixed test bug, merged PR #26, completed task, picked new task from ready list, made progress,
      committed work, created PR #27. Total time ~10 minutes. Multi-step workflow executed smoothly.
    created_at: '2026-01-18T04:19:47.461Z'
    tags:
      - reflection
      - workflow
      - ralph
    added_by: '@claude'
  - _ulid: 01KF7NTY0V8VPG15091CH6K7S3
    text: >-
      String centralization refactor pattern working well - incremental phases with PRs for review
      allow continuous progress without context overload. Phase 1 (session.ts) merged via PR #27,
      Phase 2 (task.ts alignment) committed directly since it's small and follows established
      pattern. Consider this phased approach for other large refactoring tasks.
    created_at: '2026-01-18T04:29:27.963Z'
    tags:
      - reflection
      - dx
      - workflow
    added_by: '@claude'
  - _ulid: 01KF7NX1B2NBN9TFG45XJWVCSK
    text: >-
      Ralph Loop PR review workflow executed successfully in iteration 6: checked for open PRs
      first, launched review subagent for PR #27, merged it after positive review, then continued
      with active task. The pattern of 'check PRs → review → merge → continue work' provides good
      session continuity.
    created_at: '2026-01-18T04:30:36.899Z'
    tags:
      - reflection
      - workflow
      - ralph
    added_by: '@claude'
  - _ulid: 01KF7PT1MAX11SRXH1AHE03GKQ
    text: >-
      String centralization pattern working well - clear separation between message definitions
      (strings/) and usage (cli/commands/). Interactive guidance structures (like shadow resolve)
      benefit significantly from centralization - easier to see the full user flow when all messages
      are together. TypeScript 'as const' on message objects provides good type safety.
    created_at: '2026-01-18T04:46:27.466Z'
    tags:
      - reflection
      - dx
    added_by: '@claude'
  - _ulid: 01KF7QDJJ0JTVFFDCZQPV1MG7Y
    text: >-
      Large refactoring iterations: Phase 4 error centralization showed pattern for managing
      large-scope refactors across multiple iterations. Key lessons: (1) Create module first with
      comprehensive coverage, (2) Start with smallest files to establish pattern and verify tests,
      (3) Commit incremental progress with clear 'what's done / what remains' documentation in
      notes, (4) Use TodoWrite for tracking sub-phases. Worked well: tests caught issues early,
      smaller files built confidence, clear progress tracking. Alternative considered: batch-edit
      all files at once - rejected due to risk of breaking changes and harder debugging. This
      incremental approach with test verification between batches provides safety while making
      progress.
    created_at: '2026-01-18T04:57:07.392Z'
    tags:
      - reflection
      - dx
      - workflow
    added_by: '@claude'
  - _ulid: 01KF7QFHB3GCFM0A4SG5FETMXJ
    text: >-
      PR creation for partial work: Iteration 8 demonstrated value of creating PRs for partial
      completion of large phases. Benefits: (1) Makes progress visible and reviewable, (2) Reduces
      review burden vs one giant PR, (3) Allows merging stable portions while continuing work, (4)
      Creates checkpoints if approach needs adjustment. PR #30 shows 'phase 4 partial' pattern -
      clear what's done vs what remains. Could be applied to other large refactors. Consider: should
      we always break large phases into 'setup + partial + completion' PRs?
    created_at: '2026-01-18T04:58:11.683Z'
    tags:
      - reflection
      - workflow
      - pr-strategy
    added_by: '@claude'
  - _ulid: 01KF7R758YMQHGRZXG82DHANXC
    text: >-
      PR review workflow in ralph loop works well. Iteration 9: review subagent found 2 minor issues
      in PR #30 (unused import, naming inconsistency), implemented fixes trivially, merged after
      approval. Then continued Phase 4 work unblocked. The automated review + fix + merge flow is
      smooth when changes are truly minor.
    created_at: '2026-01-18T05:11:05.758Z'
    tags:
      - reflection
      - workflow
      - ralph
    added_by: '@claude'
  - _ulid: 01KF7RQVSCV182FMEW832CABMX
    text: >-
      Ralph loop session completed successfully. Observation: Incremental refactoring across
      multiple iterations works well when pattern is established early. Iteration 10 tackled largest
      file (45 errors) and maintained quality (all tests pass). Key success factor: comprehensive
      error.ts module created in iteration 8 provided clear migration target. Future large refactors
      should follow similar approach: establish module structure early, migrate incrementally,
      validate frequently.
    created_at: '2026-01-18T05:20:13.100Z'
    tags:
      - reflection
      - dx
      - workflow
    added_by: '@claude'
  - _ulid: 01KF7RR36A3X7S8MN26YX3CEYH
    text: >-
      Session checkpoint: 10-iteration ralph loop achieved 47% progress on Phase 4 (94 of ~201
      errors migrated). Strong momentum - 3 phases complete, 1 phase 47% done. Pattern: early PRs
      for small wins (batches 1-3), then direct commits for established patterns. This hybrid
      approach balances review overhead with execution speed. Recommend for future multi-iteration
      work.
    created_at: '2026-01-18T05:20:20.683Z'
    tags:
      - reflection
      - ralph
      - process
    added_by: '@claude'
  - _ulid: 01KF7THXHRGSBJP86PCQ4EDC0R
    text: >-
      Phase 4 error centralization progressing well - 68% complete (136/201). Established pattern
      makes remaining work straightforward. Two large files remain: meta.ts (43 errors) and
      output.ts (4 errors). Test failures were limited to exact message matches, which is expected
      for this type of refactor.
    created_at: '2026-01-18T05:51:55.448Z'
    tags:
      - reflection
      - refactoring
    added_by: '@claude'
  - _ulid: 01KF7V8M21SAVW141WHZMP2BQV
    text: >-
      Iteration 12 reflection: Successfully completed large multi-iteration task
      (@task-prompt-refactor) spanning 12 iterations. Pattern: Breaking down big refactors into
      phases with incremental PRs works well. Phase 4 (error centralization) was the largest - took
      5 batches across multiple iterations. Having clear checkpoints and running total of progress
      (e.g., '179 of 201 errors = 89%') made continuation easy. Final scope was smaller than initial
      estimate (179 actual vs 201 estimated), showing value of exploratory analysis before
      committing to full scope.
    created_at: '2026-01-18T06:04:19.393Z'
    tags:
      - reflection
      - dx
      - workflow
    added_by: '@claude'
  - _ulid: 01KF7VQPM9F70XC0MGBJJVF4GB
    text: >-
      Commander introspection pattern worked well - Commander's structure is stable and
      well-defined, making it a reliable source of truth for help output. Consider applying this
      pattern to other CLI frameworks (Oclif, yargs) in future. The separation of auto-generated
      syntax vs curated concepts is clean and maintainable.
    created_at: '2026-01-18T06:12:33.545Z'
    tags:
      - reflection
      - cli
      - dx
    added_by: '@claude'
  - _ulid: 01KF7VZHR0GAPAKTZED3W686RK
    text: >-
      Spike tasks with no code output don't need commits - the value is in task notes documenting
      research and decisions. Consider whether session checkpoint should handle this differently
      (show 'research task, no changes' vs 'forgot to commit').
    created_at: '2026-01-18T06:16:50.688Z'
    tags:
      - reflection
      - workflow
    added_by: '@claude'
  - _ulid: 01KF7W125DYY0V3QY6GJRJNW0H
    text: >-
      Bash tool persistence: commands run in same directory as previous command unless explicit cd.
      Running 'cd .kspec && git status' left session in .kspec worktree. Need explicit 'cd
      /path/to/main' to return. Could be confusing when working with shadow branch.
    created_at: '2026-01-18T06:17:40.269Z'
    tags:
      - reflection
      - dx
      - worktree
    added_by: '@claude'
  - _ulid: 01KF7W92EBR93N16SS7THKM5V2
    text: >-
      PR workflow for shadow-only changes: Research spikes that only update task state (shadow
      branch) don't need main-branch PRs. Shadow branch is the source of truth for task/spec state.
      The 'create PR after commit' instruction applies to code changes on main, not to shadow-branch
      task updates. Consider clarifying in RALPH_LOOP_INSTRUCTIONS.
    created_at: '2026-01-18T06:22:02.699Z'
    tags:
      - workflow
      - shadow
      - reflection
    added_by: '@claude'
  - _ulid: 01KF7X8BZSPE1FQ9MJZ99MCXXD
    text: >-
      ReferenceIndex resolve() returns result objects with .ok field, not the items directly. This
      pattern needs to be followed when using refIndex.resolve() - check result.ok first, then
      access result.item. Missed this initially which caused errors.
    created_at: '2026-01-18T06:39:08.281Z'
    tags:
      - dx
      - gotcha
    added_by: '@claude'
  - _ulid: 01KF7X99WBKC041DAE946ZJR66
    text: >-
      When implementing CLI commands that output both human-readable and JSON formats, use
      success(message, data) instead of calling both success() and output() separately. The
      success() function already handles JSON mode internally, avoiding duplicate/mixed output.
    created_at: '2026-01-18T06:39:38.891Z'
    tags:
      - dx
      - cli
      - gotcha
    added_by: '@claude'
  - _ulid: 01KF7YER2MW71EPVHW8XZYVN62
    text: >-
      PR review workflow worked well - found TypeScript errors in PR #34, fixed them, CI passed,
      merged. This validates the Ralph Loop instruction pattern of launching review subagents for
      open PRs.
    created_at: '2026-01-18T07:00:05.844Z'
    tags:
      - reflection
      - workflow
    added_by: '@claude'
  - _ulid: 01KF7YEXNQK3N9EG5X9VS5N83M
    text: >-
      Command suggestion feature implemented cleanly using Levenshtein distance. The threshold of 3
      seems to work well for catching typos without false positives. Commander.js already handles
      subcommand suggestions, so only needed top-level command handling.
    created_at: '2026-01-18T07:00:11.576Z'
    tags:
      - reflection
      - cli
    added_by: '@claude'
  - _ulid: 01KF7Z9T62JMGC217RRY2P3CHX
    text: >-
      CLI label centralization pattern worked well - item.ts and inbox.ts had drifted from the
      established src/strings/labels.ts pattern. Quick grep audit found the inconsistencies. Fix was
      straightforward: import centralized labels and replace hardcoded strings. This pattern
      prevents drift: new commands should import from strings/ from the start.
    created_at: '2026-01-18T07:14:52.738Z'
    tags:
      - reflection
      - dx
    added_by: '@claude'
  - _ulid: 01KF7ZT7YYC4K41QAGQ44S92D9
    text: >-
      Validation architecture scales well - Adding warnings alongside errors required minimal
      changes: new type, updated return structure, simple CLI formatting. The separation of concerns
      (refs.ts for logic, validate.ts for orchestration, validate CLI for display) made enhancement
      straightforward. Pattern worth replicating: warnings as first-class citizens alongside errors.
    created_at: '2026-01-18T07:23:51.135Z'
    tags:
      - reflection
      - architecture
    added_by: '@claude'
  - _ulid: 01KF80CV0CCH7CSV3E2E1KSHA6
    text: >-
      Spike workflow refinement: When completing a spike, capture recommendation in closed_reason
      (brief) + final note (detailed). Spike task notes form mini research doc. Pattern: findings →
      analysis → recommendation. Example: task-archive spike documented current system, reviewed
      references, recommended MVP approach all in notes.
    created_at: '2026-01-18T07:34:00.461Z'
    tags:
      - reflection
      - workflow
    added_by: '@claude'
  - _ulid: 01KF80D405NBVEQSHA48FD58YX
    text: >-
      Reference directory exploration pattern: For spikes, launching dedicated Explore subagent for
      reference dirs (kspec-acp-test, kspec-ralph-test) prevents context bloat while getting
      comprehensive findings. Subagent found identical spec content across both test dirs,
      confirming task-archive is planned-but-unimplemented. This pattern worked well - consider for
      other research tasks.
    created_at: '2026-01-18T07:34:09.670Z'
    tags:
      - workflow
      - agents
      - dx
    added_by: '@claude'
  - _ulid: 01KF80ENGV9RX5M3NERS46DD83
    text: >-
      Shadow branch PR workflow question: Completed spike research with notes/completion on
      kspec-meta shadow branch. Ralph instructions say 'create PR after commit' but unclear if this
      applies to shadow branch metadata changes (tasks/inbox) vs code changes on feature branches.
      Shadow changes track the work; code changes are the work output. Clarification needed.
    created_at: '2026-01-18T07:35:00.379Z'
    tags:
      - workflow
      - shadow
      - process
    added_by: '@claude'
  - _ulid: 01KF80JD5PQTH12X89TG4J6RZF
    text: >-
      Task status accuracy: Found task @01KF1VKEC marked as priority 3 ready but implementation was
      already complete. All code, tests, and functionality existed. System correctly updated spec
      alignment when task completed, but task remained in ready list longer than it should have.
      Consider: earlier alignment checks, or better detection of 'code exists but task not marked
      done' scenarios.
    created_at: '2026-01-18T07:37:02.902Z'
    tags:
      - workflow
      - task-tracking
    added_by: '@claude'
  - _ulid: 01KF80K3CX8MMHBMN3NJCMCQDG
    text: >-
      Shadow CLI verification iteration: Picked task @01KF1VKEC (Shadow CLI Commands) from ready
      list. Found all three commands (status, log, repair) already implemented in
      src/cli/commands/shadow.ts with 43 passing tests. Verified functionality working correctly.
      Completed task and updated spec alignment. No code changes to main branch needed. Key
      learning: spec items marked as 'implemented' were accurate - implementation existed and was
      tested.
    created_at: '2026-01-18T07:37:25.662Z'
    tags:
      - iteration-summary
      - ralph-loop
    added_by: '@claude'
  - _ulid: 01KF80KV2S21Y9YZN976EYYR61
    text: >-
      Iteration 10 complete: Merged PR #36 (deprecation warnings), completed task-archive spike with
      MVP recommendation (manual archive command to project.tasks.archive.yaml). Research documented
      in task notes confirms multi-file support exists, design doc alignment, and clear
      implementation path. Tests passing. Shadow branch workflow question captured for
      clarification.
    created_at: '2026-01-18T07:37:49.913Z'
    tags:
      - reflection
      - session
    added_by: '@claude'
  - _ulid: 01KF8101W4JS7J9Z4QV8P7V2P3
    text: >-
      Linter/file modification conflict - during iteration 12, implemented shadow debug mode but
      linter repeatedly reverted changes to shadow.ts, index.ts, and shadow.test.ts. Task was
      already marked complete from previous iteration (iteration 11?). This suggests either: (1)
      file locking issue during concurrent reads/writes, (2) linter auto-save interfering with
      edits, or (3) previous iteration already completed this work. Need to investigate file
      modification tracking.
    created_at: '2026-01-18T07:44:30.084Z'
    tags:
      - workflow
      - dx
      - bug
    added_by: '@claude'
  - _ulid: 01KF82M93K792PK8ZEG2MYHAVJ
    text: >-
      Review workflow refinement: When review subagent finds flag conflicts or similar behavioral
      issues, the fix should include both code AND spec updates. In iteration 13, renamed --verbose
      to --debug-shadow but initially forgot to update the spec file. Spec/code alignment is
      critical - code changes that affect documented behavior should always trigger spec updates in
      the same commit flow.
    created_at: '2026-01-18T08:13:01.428Z'
    tags:
      - workflow
      - reflection
      - spec-alignment
    added_by: '@claude'
  - _ulid: 01KF834HRJE100NSCN85KME35P
    text: >-
      Shadow branch auto-committing can create challenges with PR workflow - PR #38 included WIP
      commits from shadow that were auto-committed in iteration 13. Consider: (1) squash strategy
      for shadow commits when creating PR, (2) explicit checkpoint command before PR creation, or
      (3) shadow commit message convention (wip: prefix) to make cleanup easier.
    created_at: '2026-01-18T08:21:54.578Z'
    tags:
      - reflection
      - shadow
      - workflow
    added_by: '@claude'
  - _ulid: 01KF834S6JA8AFZ818MFA5P6HZ
    text: >-
      Module add implementation worked well following existing patterns from item add. Key pattern:
      (1) validate inputs first (slug uniqueness), (2) create data structure, (3) write file, (4)
      update manifest/indexes, (5) shadow commit. This pattern could be extracted into reusable
      helper for similar 'add file + update manifest' operations.
    created_at: '2026-01-18T08:22:02.194Z'
    tags:
      - reflection
      - dx
      - patterns
    added_by: '@claude'
  - _ulid: 01KF83MPSTS4WWAC3N6C0FMEJS
    text: >-
      PR review workflow automation friction: Had to manually launch review subagent, wait for
      output, interpret results, then fix issues. Could streamline with dedicated /review skill
      that: (1) checks for open PRs, (2) launches review subagent automatically, (3) interprets
      results + decision tree (authored vs external, trivial vs non-trivial fixes), (4) applies
      fixes if trivial, (5) merges if appropriate. Would reduce cognitive load and ensure consistent
      review process.
    created_at: '2026-01-18T08:30:44.026Z'
    tags:
      - workflow
      - review
      - automation
    added_by: '@claude'
  - _ulid: 01KF8451NYVVYHH35N14MMFKFM
    text: >-
      Task completion guardrails feature dogfooded successfully - the feature was tested on itself
      during completion, demonstrating the self-hosting principle. The interactive prompt provides
      immediate feedback about AC coverage which helps ensure implementations match specs.
    created_at: '2026-01-18T08:39:39.455Z'
    tags:
      - reflection
      - dx
    added_by: '@claude'
  - _ulid: 01KF846WKJEX616G8AJSVZ0C08
    text: >-
      Guardrails implementation preserves spec status.maturity when updating implementation status -
      important pattern to avoid losing maturity context when auto-updating fields. Default to
      'draft' if status doesn't exist yet.
    created_at: '2026-01-18T08:40:39.794Z'
    tags:
      - implementation
      - pattern
    added_by: '@claude'
  - _ulid: 01KF84TQFTAYY17QYXXVMR6HRX
    text: >-
      PR review workflow validation: Iteration demonstrated successful catch of architectural
      conflict (auto-sync vs interactive prompt) through subagent review. The review correctly
      identified status inconsistency risk, recommended fix was implemented (Option A: keep AC
      reminder only), and re-review confirmed resolution. This validates the 'review your own PRs
      with subagent' pattern from RALPH_LOOP_INSTRUCTIONS - the subagent provided genuine value, not
      rubber-stamping.
    created_at: '2026-01-18T08:51:29.914Z'
    tags:
      - reflection
      - workflow
      - pr-review
    added_by: '@claude'
  - _ulid: 01KF84V19QVA83NX0VT5DB8FCQ
    text: >-
      Auto-sync + interactive prompts anti-pattern: When adding interactive prompts to modify state,
      always check if automatic sync/calculation logic already exists. In this case, AlignmentIndex
      calculates spec status from all linked tasks - interactive prompt would have allowed
      single-task override, creating drift. Pattern to remember: if system has 'calculated truth',
      don't add manual override without considering multi-entity consistency.
    created_at: '2026-01-18T08:51:39.960Z'
    tags:
      - design
      - reflection
      - anti-pattern
    added_by: '@claude'
  - _ulid: 01KF85BA13ZF64K8QJK77EPMKZ
    text: >-
      findChildItems implementation based on _path nesting worked well - the path structure makes
      parent-child relationships explicit and easy to query. Similar pattern could be useful for
      other hierarchical queries (siblings, ancestors, tree depth)
    created_at: '2026-01-18T09:00:33.187Z'
    tags:
      - reflection
      - dx
    added_by: '@claude'
  - _ulid: 01KF85Y564GJZ7ZMEE11Q6B815
    text: >-
      Status cascade spec gap: @status-cascade only has 1 AC but implementation handles 4+ behaviors
      (prompt shown, user accepts, user rejects, JSON mode, no children case). Need to add missing
      ACs to match implementation. Also clarify whether maturity status should cascade along with
      implementation status.
    created_at: '2026-01-18T09:10:50.821Z'
    tags:
      - spec-gap
      - status-cascade
    added_by: '@claude'
  - _ulid: 01KF865XY0RT1A9ZEY95XGNTK0
    text: >-
      PR review workflow observation: GitHub prevents approving your own PRs even across different
      agent iterations. The 'Don't merge your own PR' principle should be interpreted as 'Don't skip
      the review step' rather than abandoning PRs. Review subagent provides independent review, then
      merge is OK. Self-review via subagent is valid for automation loops.
    created_at: '2026-01-18T09:15:05.536Z'
    tags:
      - reflection
      - workflow
      - pr
    added_by: '@claude'
  - _ulid: 01KF875PYZ6V10P49DZ6EFKJ46
    text: >-
      Test fixtures should avoid spec_ref assignments that conflict with derive tests. When adding
      spec_ref to test tasks, check if they're used in derive --dry-run tests which expect tasks not
      to exist yet.
    created_at: '2026-01-18T09:32:26.976Z'
    tags:
      - testing
      - dx
    added_by: '@claude'
  - _ulid: 01KF87YFD357S262F77QH3ZVES
    text: >-
      Task 01KF4WVW0 (Meta Manifest Format) was already fully implemented from prior iterations. All
      3 ACs were satisfied with existing code: schema (meta.ts), parser (meta.ts), CLI commands
      (meta show/agents/workflows/conventions/etc), validation integration with 'meta:' prefix,
      reference index support, and 57 passing tests. This demonstrates good self-tracking -
      implementation was complete but task remained 'pending' until verified. Lesson: When picking
      up tasks, always check for existing implementation before starting from scratch.
    created_at: '2026-01-18T09:45:58.435Z'
    tags:
      - reflection
      - workflow
      - dx
    added_by: '@claude'
  - _ulid: 01KF87YRENB05R965TE7ZJS9RC
    text: >-
      Exploration subagents are highly valuable for understanding prior implementations. The Explore
      agent provided comprehensive details from kspec-acp-test and kspec-ralph-test showing exact
      file paths, schema patterns, CLI command structure, test isolation challenges, and lessons
      learned. This context prevented re-implementing from scratch and enabled quick verification of
      existing work. Consider making exploration a standard first step for all implementation tasks.
    created_at: '2026-01-18T09:46:07.701Z'
    tags:
      - reflection
      - agents
      - workflow
    added_by: '@claude'
  - _ulid: 01KF88M3A7GT4MPHE7M8WX474X
    text: >-
      Parser vs CLI layer disconnect - meta includes were fully implemented in parser but CLI used
      wrong accessor (metaCtx.manifest.* vs metaCtx.*). This kind of bug suggests value in
      integration tests that exercise full stack, not just parser logic. Consider: smoke tests for
      all CLI commands with complex scenarios.
    created_at: '2026-01-18T09:57:46.951Z'
    tags:
      - testing
      - dx
    added_by: '@claude'
  - _ulid: 01KF88X8TE9ZE3B1WJZFMP1RV8
    text: >-
      Task verification workflow - some tasks may be 'already implemented' from prior work. When
      starting a task, first verify current state by reading code, running tests, and checking
      existing functionality before implementing. This saves time and avoids duplicate work.
      Example: @task-meta-validation-integration was already complete from prior iterations.
    created_at: '2026-01-18T10:02:47.502Z'
    tags:
      - reflection
      - workflow
      - dx
    added_by: '@claude'
  - _ulid: 01KF8959HWV3FXHEZRXKZXR922
    text: >-
      Meta schema verification batch - completed 8 meta-related tasks in single iteration by
      verifying existing schema implementations in src/schema/meta.ts. Pattern: start task, read
      schema file, verify fields match spec, document in notes, complete. Efficient for verification
      tasks when implementation already exists. Tasks completed: meta-validation, agent-schema,
      agent-capabilities, agent-session-protocol, workflow-schema, workflow-step-types,
      workflow-triggers, observation-schema.
    created_at: '2026-01-18T10:07:10.397Z'
    tags:
      - reflection
      - meta
      - efficiency
    added_by: '@claude'
  - _ulid: 01KF895HQP4KAQ7STD9HG4Q78E
    text: >-
      Implementation vs verification tasks - some tasks require implementation
      (workflow-execution-model needs 'meta run' command, convention-definitions needs validate
      integration for AC-3/4) while others just need verification. When picking tasks in automation
      loop, prioritize verification tasks for quick wins, leave implementation tasks for focused
      sessions with more context. Left in-progress: @task-workflow-execution-model (needs meta run
      command), @task-convention-definitions (3/5 ACs done, needs validation integration).
    created_at: '2026-01-18T10:07:18.774Z'
    tags:
      - reflection
      - workflow
      - task-management
    added_by: '@claude'
  - _ulid: 01KF89DKNBKX64MVHGVM41GDX8
    text: >-
      Observation: Many derived tasks for meta-spec features are already implemented. Schema layer
      (ObservationTypeSchema, ConventionSchema, WorkflowSchema) and CLI display commands (meta show,
      meta agents, meta workflows, meta conventions) are complete. Gap is in interactive/mutation
      commands (meta promote, meta resolve, meta run) and validation integration (--conventions
      flag). Pattern: display-first implementation strategy works well - read operations complete,
      write operations deferred. This is pragmatic and allows early testing of schema design.
    created_at: '2026-01-18T10:11:42.891Z'
    tags:
      - reflection
      - meta
      - implementation
    added_by: '@claude'
  - _ulid: 01KF89DZP5CZR4NAPXWWK1TQJF
    text: >-
      Observation: Verification-only iterations (checking if derived tasks are already complete)
      produce no commits. This is efficient - avoids churning code when implementation exists.
      However, PR-per-iteration guidance assumes code changes. Consider: should verification
      iterations still create a documentation PR? Or is skipping PR acceptable when working tree is
      clean? Current behavior: skip PR when nothing to commit. This seems right - PRs should
      represent actual changes.
    created_at: '2026-01-18T10:11:55.205Z'
    tags:
      - reflection
      - workflow
      - pr
    added_by: '@claude'
  - _ulid: 01KF89SR4P4EQ8NET551HC5D8H
    text: >-
      Task origin field pattern - added origin enum to track task creation source (manual, derived,
      observation_promotion). Could be extended for other sources like 'agent_suggestion',
      'test_failure', 'lint_error'. Useful for metrics and understanding task flow.
    created_at: '2026-01-18T10:18:20.694Z'
    tags:
      - reflection
      - meta
    added_by: '@claude'
  - _ulid: 01KF89X8RS9YHT0R1782PBY052
    text: >-
      Spec gap discovery during implementation - AC-3 mentioned 'origin: observation_promotion' but
      origin field didn't exist in schema. Good example of spec-code drift. Consider:
      pre-implementation spec validation against schema, or schema-first approach where AC
      references must match existing schema fields.
    created_at: '2026-01-18T10:20:16.026Z'
    tags:
      - reflection
      - spec-gap
      - dx
    added_by: '@claude'
  - _ulid: 01KF8AG3D388BVAFRTJF4QNQXN
    text: >-
      Task @01KF89NY (improve error messages) was underspecified but ref implementations in
      kspec-ralph-test and kspec-acp-test showed clear pattern: centralized strings module already
      existed in src/strings/. Real work was finding remaining hardcoded error strings and migrating
      them. Good example of how reference implementations provide context when task descriptions are
      minimal.
    created_at: '2026-01-18T10:30:33.124Z'
    tags:
      - reflection
      - dx
    added_by: '@claude'
  - _ulid: 01KF8B841NY3SCEWVZQZMRY2TJ
    text: >-
      Convention schema was already implemented but lacked test coverage. When picking up
      implementation tasks, check if the code exists first - may just need tests or documentation
      rather than new code.
    created_at: '2026-01-18T10:43:40.213Z'
    tags:
      - reflection
      - testing
    added_by: '@claude'
  - _ulid: 01KF8BTJ0D5CC81G2ZHCD5SQNW
    text: >-
      kspec-meta shadow branch has diverged significantly from remote (99 local vs 2 remote
      commits). Merge conflicts in sessions/ and modules/. May need manual reconciliation or a fresh
      sync strategy. Task changes are committed locally and functional.
    created_at: '2026-01-18T10:53:44.333Z'
    tags:
      - kspec-meta
      - dx
    added_by: '@claude'
  - _ulid: 01KF8BVQD6383DCJYJEBWVE41Z
    text: >-
      Convention domains task completed but raises question: what's the workflow for changes to
      kspec-meta shadow branch? No PR created since changes are metadata config, not code. Should
      meta manifest changes follow a different review/merge process than code changes?
    created_at: '2026-01-18T10:54:22.630Z'
    tags:
      - workflow
      - kspec-meta
      - reflection
    added_by: '@claude'
  - _ulid: 01KF8C89AC6CHKJNP2GDSZC9ZP
    text: >-
      Convention validation foundation complete but needs content gathering - current implementation
      validates convention schema but to be fully functional, needs integration with actual content
      sources (git log for commits, task notes for note validation, etc.). Could be a future
      enhancement.
    created_at: '2026-01-18T11:01:14.188Z'
    tags:
      - feature
      - validation
    added_by: '@claude'
  - _ulid: 01KF8CPXERKGJGCPK4N3MN12BP
    text: >-
      Task already implemented - discovered task @task-observation-resolution was already fully
      implemented with tests. The 'implementation: in_progress' status was stale. Need workflow for
      detecting/handling tasks where code exists but status is outdated. Possible solutions: analyze
      git history for relevant commits, grep codebase for AC annotations, run tests and check
      coverage.
    created_at: '2026-01-18T11:09:13.560Z'
    tags:
      - workflow
      - alignment
    added_by: '@claude'
  - _ulid: 01KF8DARQ5TY5807CD2T7XPP8M
    text: >-
      ReferenceIndex type guard pattern - when using index.resolve(), must check taskResult.ok
      before accessing taskResult.item. Easy to miss since TypeScript doesn't enforce this at
      compile time. Consider helper functions or better type guards.
    created_at: '2026-01-18T11:20:04.069Z'
    tags:
      - dx
      - pattern
    added_by: '@claude'
  - _ulid: 01KF8ETY1J1P14ZAN9AZF8BMMM
    text: >-
      Type guards for union types: When narrowing AnyLoadedItem | LoadedMetaItem to LoadedTask,
      check for required properties that exist on Task but not on meta items. Use 'status' in item
      && 'depends_on' in item - NOT optional properties like closed_reason which won't exist on
      incomplete tasks.
    created_at: '2026-01-18T11:46:22.386Z'
    tags:
      - typescript
      - dx
    added_by: '@claude'
  - _ulid: 01KF8FC4ZKCA6GWXV9G371KCAX
    text: >-
      Review subagent found validation strictness issue with RefSchema for session context focus
      field - too strict for manually-edited files. Changed to z.string().nullable() for better UX.
      Demonstrates value of code review even for simple changes.
    created_at: '2026-01-18T11:55:46.547Z'
    tags:
      - dx
      - review
    added_by: '@claude'
  - _ulid: 01KF8FS1DT672DQ5CT3KA0JXJG
    text: >-
      Context Storage task (@01KF4WVWN) - Implementation was already complete in previous session.
      Only needed gitignore entry and tests. Good example of verification workflow: check
      implementation, add missing pieces (gitignore, tests), document in notes, commit with proper
      trailers.
    created_at: '2026-01-18T12:02:48.891Z'
    tags:
      - reflection
      - workflow
    added_by: '@claude'
  - _ulid: 01KF8FZC470CHRJH5HPRPQZMAY
    text: >-
      Session checkpoint hook caught uncommitted .gitignore change. Important to follow
      never-commit-to-main rule - all changes should go through PRs. The hook successfully prevented
      incomplete session state.
    created_at: '2026-01-18T12:06:16.455Z'
    tags:
      - workflow
      - process
    added_by: '@claude'
  - _ulid: 01KF8G7AF9WSWZ7D18Z0SBE685
    text: >-
      Context integration implementation was straightforward - schema and storage were already in
      place. The key insight from the spec example was showing context BEFORE active work, giving
      agents immediate orientation. This placement makes sense: context is 'what I'm thinking about'
      while active tasks are 'what I'm doing'.
    created_at: '2026-01-18T12:10:36.905Z'
    tags: []
    added_by: '@claude'
  - _ulid: 01KF8GYCBPWT350SWE2QXDWVGJ
    text: >-
      PR review automation workflow: Successfully reviewed two PRs (#53 and #52), identified
      duplicate draft PR, fixed TypeScript compilation error by correcting import path, merged
      working PR. Process showed need for detecting duplicate PRs earlier in workflow.
    created_at: '2026-01-18T12:23:12.503Z'
    tags:
      - reflection
      - workflow
      - pr
    added_by: '@claude'
  - _ulid: 01KF8GYJV8B6GZ0S4NG7VPY9C6
    text: >-
      Task discovery pattern: Some ready tasks may already be implemented (found kspec meta
      conventions fully working despite being marked pending). Consider adding a 'verify
      implementation status' step when starting tasks, especially for CLI commands that can be
      quickly tested.
    created_at: '2026-01-18T12:23:19.144Z'
    tags:
      - reflection
      - workflow
      - dx
    added_by: '@claude'
  - _ulid: 01KF8H8DY35NSAF24G36J8YF45
    text: >-
      JSON output pattern: The output() helper provides clean separation between JSON and
      human-readable modes. Used successfully in meta observe to return observation object in JSON
      mode while keeping success message for human mode. Pattern: output(dataObject, () =>
      humanFormatter())
    created_at: '2026-01-18T12:28:41.795Z'
    tags:
      - reflection
      - dx
    added_by: '@claude'
  - _ulid: 01KF8HZRR3MHSK44Q5F7QBXWP9
    text: >-
      PR workflow smooth - auto-generated branch name from task slug, reset main to origin, created
      PR with test plan. The /pr skill workflow is well-designed for this pattern.
    created_at: '2026-01-18T12:41:26.532Z'
    tags:
      - workflow
      - reflection
    added_by: '@claude'
  - _ulid: 01KF8JNYE0YVWMG0NW8ZYEMYS6
    text: >-
      Task @01KF4WVWX (meta promote) was already fully implemented in prior session. Only needed
      minor alignment fixes (priority description, JSON output). This suggests: (1) checking
      implementation status before starting task could save work, (2) spec-code alignment checks at
      task completion are valuable, (3) maybe add 'kspec task verify' command that compares
      implementation status in spec vs actual code existence.
    created_at: '2026-01-18T12:53:33.248Z'
    tags:
      - reflection
      - process
      - dx
    added_by: '@claude'
  - _ulid: 01KF8K52824PRPAH1NCKPAC7P0
    text: >-
      Meta command implementation pattern: Several meta commands (resolve, observe, promote,
      conventions) were already implemented but tasks remained pending. Need better sync between
      implementation status and task status - perhaps a command to scan for already-implemented
      specs and auto-complete their tasks.
    created_at: '2026-01-18T13:01:48.674Z'
    tags:
      - process
      - dx
    added_by: '@claude'
  - _ulid: 01KF8K600Q12W4XFDK3DAWSFG0
    text: >-
      PR skill integration: When tasks only update .kspec tracking (no code changes), the /pr skill
      correctly detects no changes and exits cleanly. Task completion updates shadow branch
      automatically via kspec commands.
    created_at: '2026-01-18T13:02:19.159Z'
    tags:
      - workflow
      - pr
    added_by: '@claude'
  - _ulid: 01KF8KC4YRS18BC1PCRQT349EW
    text: >-
      Observation: Meta focus command implementation was straightforward thanks to well-structured
      SessionContext schema and existing loadSessionContext/saveSessionContext functions. The
      pattern of supporting both show/set/clear modes in a single command is clean and
      user-friendly. Auto-prepending @ to references maintains UX consistency.
    created_at: '2026-01-18T13:05:40.824Z'
    tags:
      - meta
      - dx
      - success
    added_by: '@claude'
  - _ulid: 01KF8MFGHX1HJZCRNK8MHQXF4T
    text: >-
      PR workflow efficiency - The combined review-test-merge cycle worked well for PR #57. Review
      subagent identified missing tests, I added them, re-review confirmed ready, merged. For PR #58
      (meta thread), implemented with tests from start. Pattern: write implementation + tests
      together rather than in separate commits reduces review cycles.
    created_at: '2026-01-18T13:24:59.581Z'
    tags:
      - workflow
      - dx
    added_by: '@claude'
  - _ulid: 01KF8MTM9F3FCVWKE230A245HD
    text: >-
      Need to have a way for the ralph loop to explicitly end a session and save the session files
      at the end of the loop iteration
    created_at: '2026-01-18T13:31:03.855Z'
    tags: []
    added_by: Jacob Chapel
  - _ulid: 01KF8TQ5X9Q0Y6DEGWQ9YPECHN
    text: >-
      Transaction/batch mechanics for kspec operations - ability to set a mark point where changes
      don't auto-commit until a final 'commit' call. Could help with bulk operations, rollback on
      errors, and atomic multi-item changes. Challenges: managing state across commands, cleanup on
      abandoned transactions, shadow branch implications. Maybe simpler approach: explicit 'kspec
      bulk' command that takes a script/list of operations and executes them atomically.
    created_at: '2026-01-18T15:14:02.282Z'
    tags:
      - idea
      - cli
      - architecture
    added_by: '@claude'
  - _ulid: 01KF91DXEZ50F7E25DCSQ6QCQC
    text: >-
      Agent-first CLI redesign: Remove interactive prompts, add TTY detection


      ## Problem

      Current CLI has interactive prompts (cascade status updates, derive hints) that create
      friction for agent usage. Agents are primary users of kspec CLI, but design assumes human
      interaction.


      ## Research Findings


      ### Industry Standards

      - TTY detection is foundational: if stdout not TTY, assume non-interactive

      - Common flags: --yes/-y, --force/-f, --no-input, --json

      - CI environment detection (CI=true) auto-disables prompts

      - Risk-based prompts: only for truly destructive operations


      ### Agent Experience (AX) Principles

      - Determinism is non-negotiable: same command = same result

      - Structured output (JSON) should be default when not TTY

      - Errors as structured data with recovery hints

      - Idempotency enables safe retry

      - Tool annotations (readOnly, destructive, idempotent)


      ## Recommended Changes


      1. **Remove derive hint entirely** - Just prints suggestion, adds noise

      2. **Replace cascade prompt with --cascade flag** - Opt-in, deterministic

      3. **Keep delete --force requirement** - Truly destructive, safety net

      4. **Add TTY detection** - Auto-switch to JSON output, no prompts when not TTY

      5. **Respect CI environment variable** - CI=true means non-interactive

      6. **Consider --dry-run for all mutations** - Preview mode for safety


      ## Implementation Pattern

      ```javascript

      function isInteractive() {
        if (process.env.CI) return false;
        if (args['--no-input']) return false;
        return process.stdin.isTTY && process.stdout.isTTY;
      }

      ```


      ## Sources

      - clig.dev (CLI Guidelines)

      - Heroku CLI Style Guide

      - MCP Tool Schema patterns

      - AX (Agent Experience) principles from agentexperience.ax

      - Terraform/Ansible idempotency patterns
    created_at: '2026-01-18T17:11:18.752Z'
    tags:
      - cli
      - dx
      - agent-first
      - architecture
    added_by: '@claude'
  - _ulid: 01KF91E8CSV99V0FS1HJTYQSBJ
    text: >-
      Structured error responses with recovery hints


      ## Context

      Research on agent-first CLI design identified that errors should be structured data, not
      prose. Current kspec errors are text strings that agents must parse.


      ## Pattern

      Errors should follow schema with three components:

      1. What failed (error code)

      2. Why it failed (message + context)

      3. Recovery actions (1-3 concrete next steps)


      ## Example

      ```json

      {
        "success": false,
        "error": {
          "code": "REF_NOT_FOUND",
          "message": "Reference '@nonexistent' not found",
          "context": {"ref": "@nonexistent", "searched": ["tasks", "items"]},
          "recovery": [
            "Run 'kspec item list' to see available items",
            "Check spelling of the reference"
          ]
        }
      }

      ```


      ## Benefits

      - Agents can programmatically handle errors

      - Recovery hints guide next action

      - Exit codes map to error categories

      - Consistent schema across all commands


      Related to: @01KF91DX (agent-first CLI redesign)
    created_at: '2026-01-18T17:11:29.946Z'
    tags:
      - cli
      - errors
      - agent-first
    added_by: '@claude'
  - _ulid: 01KF91EKZPS2FAXSF1P2YWQ6WN
    text: >-
      Add --dry-run to all mutating commands


      ## Context

      Terraform's 'plan' command is the canonical example of safe mutation preview. Agent-first
      design emphasizes dry-run support for safety and debugging.


      ## Commands that should support --dry-run

      - item add/set/delete

      - task add/start/complete/cancel

      - derive

      - inbox promote

      - meta add/set/delete


      ## Behavior

      ```bash

      kspec derive @spec-item --dry-run

      # Output: Would create task 'implement-spec-item' with:

      #   title: Implement: Spec Item

      #   spec_ref: @spec-item

      #   priority: 3


      kspec task complete @task --dry-run

      # Output: Would mark task as completed

      #   status: completed

      #   completed_at: 2026-01-18T...

      ```


      ## Benefits

      - Agents can validate actions before executing

      - Debugging complex workflows

      - CI/CD validation without side effects

      - Matches Terraform/kubectl patterns


      Related to: @01KF91DX (agent-first CLI redesign)
    created_at: '2026-01-18T17:11:41.815Z'
    tags:
      - cli
      - safety
      - agent-first
    added_by: '@claude'
