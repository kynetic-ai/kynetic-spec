{
  "generated_at": "2026-01-24T20:35:19.338Z",
  "branch": "test/per-project-watchers",
  "context": {
    "focus": null,
    "threads": [],
    "open_questions": [],
    "updated_at": "2026-01-22T21:05:45.847Z"
  },
  "active_tasks": [],
  "pending_review_tasks": [
    {
      "ref": "01KFQAEM",
      "title": "Per-project file watcher tests",
      "started_at": "2026-01-24T20:20:31.368Z",
      "priority": 1,
      "spec_ref": "@multi-directory-daemon",
      "note_count": 2,
      "last_note_at": "2026-01-24T20:35:05.963Z",
      "todo_count": 0,
      "incomplete_todos": 0
    }
  ],
  "recent_notes": [],
  "active_todos": [],
  "ready_tasks": [
    {
      "ref": "01KFQAF9",
      "title": "/api/projects endpoint tests",
      "priority": 1,
      "spec_ref": "@multi-directory-daemon",
      "tags": [
        "testing",
        "api",
        "phase-7"
      ]
    },
    {
      "ref": "01KFQAD3",
      "title": "Migrate API routes to use request context",
      "priority": 2,
      "spec_ref": "@multi-directory-daemon",
      "tags": [
        "daemon",
        "routes",
        "phase-4"
      ]
    },
    {
      "ref": "01KFQADQ",
      "title": "WebSocket connection binding implementation",
      "priority": 2,
      "spec_ref": "@multi-directory-daemon",
      "tags": [
        "daemon",
        "websocket",
        "phase-5"
      ]
    },
    {
      "ref": "01KFMMJ4",
      "title": "Implement: GitHub Pages Export",
      "priority": 3,
      "spec_ref": "@gh-pages-export",
      "tags": [
        "static",
        "export",
        "github"
      ]
    },
    {
      "ref": "01KFMMXF",
      "title": "Export command implementation",
      "priority": 3,
      "spec_ref": "@gh-pages-export",
      "tags": [
        "phase-4",
        "export"
      ]
    },
    {
      "ref": "01KFMMXK",
      "title": "Static SPA for GitHub Pages",
      "priority": 3,
      "spec_ref": "@gh-pages-export",
      "tags": [
        "phase-4",
        "export"
      ]
    },
    {
      "ref": "01KFMMXR",
      "title": "Read-only mode behaviors",
      "priority": 3,
      "spec_ref": "@gh-pages-export",
      "tags": [
        "phase-4",
        "export"
      ]
    },
    {
      "ref": "01KFMMXW",
      "title": "GitHub Pages CI workflow",
      "priority": 3,
      "spec_ref": "@gh-pages-export",
      "tags": [
        "phase-4",
        "export"
      ]
    }
  ],
  "blocked_tasks": [
    {
      "ref": "01KFBDQE",
      "title": "Add spec-schema drift detection to validation",
      "blocked_by": [
        "Needs clearer scoping - see latest note for details"
      ],
      "unmet_deps": []
    },
    {
      "ref": "01KFMMZW",
      "title": "API integration tests",
      "blocked_by": [
        "Needs architectural decision: E2E test framework approach (Bun test runner vs vitest with real server vs manual QA). See notes for analysis."
      ],
      "unmet_deps": []
    }
  ],
  "recently_completed": [
    {
      "ref": "01KFQADD",
      "title": "WebSocket connection binding tests",
      "completed_at": "2026-01-24T20:20:08.613Z",
      "closed_reason": "Merged in PR #221. Added 7 static analysis tests for WebSocket project binding (ac-18, ac-21, ac-21b, ac-22, ac-23). Tests document expected behavior: X-Kspec-Dir header extraction, projectPath in ConnectionData, broadcast isolation, default project fallback, and connection rejection when no project. Tests intentionally pass as documentary tests (always-passing style). All CI checks passed (claude-review, check-unresolved-comments, tests)."
    },
    {
      "ref": "01KFQACQ",
      "title": "API routes multi-project tests",
      "completed_at": "2026-01-24T20:04:30.397Z",
      "closed_reason": "Merged in PR #220. Added 44 static analysis tests across 4 API test files (inbox, items, meta, tasks) verifying routes will use projectContext from middleware state. Tests document expected changes for route migration (task @01KFQAD3). All CI checks passed. Local review flagged test quality/isolation concerns - acknowledged as intentional preparatory tests. Proper E2E tests blocked on @01KFQAD3."
    },
    {
      "ref": "01KFQACE",
      "title": "X-Kspec-Dir middleware implementation",
      "completed_at": "2026-01-24T19:46:41.443Z",
      "closed_reason": "Merged in PR #219. Implemented X-Kspec-Dir middleware with 11 ACs: header extraction (ac-1), default fallback (ac-2, ac-3), auto-registration (ac-4), path validation (ac-5, ac-6, ac-7), normalization (ac-8, ac-8b, ac-8c), and default validity check (ac-20b). 16 comprehensive tests added. All CI checks passed."
    },
    {
      "ref": "01KFQABQ",
      "title": "ProjectContextManager implementation",
      "completed_at": "2026-01-24T19:37:54.045Z",
      "closed_reason": "Merged in PR #218. Implemented ProjectContextManager with 29 comprehensive unit tests covering 14 ACs. Addressed Greptile review feedback (path.isAbsolute). All CI checks passed."
    },
    {
      "ref": "01KFR82AK",
      "title": "Implement: Session Reflect Loop Workflow",
      "completed_at": "2026-01-24T19:16:03.523Z",
      "closed_reason": "Workflow created and auto-committed to shadow branch. Implements all 6 ACs:\n- ac-1: Step 1 searches observations/inbox/tasks BEFORE identifying\n- ac-2, ac-4: Step 2 defines high-confidence criteria (concrete, systemic, clear)\n- ac-3: Step 3 evaluates duplicates and skips them\n- ac-5, ac-6: Step 3 has skip_user_prompt: true (no user interaction)\n\nWorkflow definition at .kspec/kynetic.meta.yaml (shadow commit d3c95c26)"
    },
    {
      "ref": "01KFQABA",
      "title": "Global PID/port file management",
      "completed_at": "2026-01-24T19:12:25.119Z",
      "closed_reason": "Merged in PR #217. Implemented global PID/port file management - moved daemon.{pid,port} files from project-local .kspec/ to global ~/.config/kspec/. Covers ac-9, ac-9b, ac-9c, ac-10, ac-11, ac-13. 30 comprehensive tests added. All CI checks passed."
    },
    {
      "ref": "01KFQAC1",
      "title": "Path validation middleware tests",
      "completed_at": "2026-01-24T18:52:22.868Z",
      "closed_reason": "Merged in PR #216. Created 16 comprehensive path validation middleware tests covering ac-1, ac-2, ac-3, ac-4, ac-5, ac-6, ac-7, ac-8, ac-8b, ac-8c, ac-20b. Tests validate X-Kspec-Dir header handling, project registration, path normalization, permission errors, and default project handling. All CI checks passed."
    },
    {
      "ref": "01KFQAAX",
      "title": "ProjectContextManager unit tests",
      "completed_at": "2026-01-24T18:42:00.722Z",
      "closed_reason": "Merged in PR #215. Added 29 comprehensive unit tests for ProjectContextManager covering 14 acceptance criteria (AC-1 through AC-8c, AC-14, AC-15, AC-16, AC-20, AC-20b). Tests validate project registration, caching, path validation/normalization, default project handling, and multi-project isolation. All CI checks passed."
    },
    {
      "ref": "01KFQAAM",
      "title": "Global PID/port management tests",
      "completed_at": "2026-01-24T18:31:14.421Z",
      "closed_reason": "Merged in PR #214. Created 30 comprehensive tests for global PID/port management (ACs 9, 9b, 9c, 10, 10b, 11, 13). Addressed Greptile review feedback: fixed return type, removed inline require, corrected test name. All CI checks passed."
    },
    {
      "ref": "01KFQAAA",
      "title": "Multi-directory daemon test fixtures",
      "completed_at": "2026-01-24T18:14:16.964Z",
      "closed_reason": "Merged in PR #213. Created multi-directory daemon test fixtures with helper function, comprehensive documentation, and proper module declarations. Fixed validation conflicts by excluding multi-dir from default setupTempFixtures()."
    }
  ],
  "recent_commits": [
    {
      "hash": "0110132",
      "full_hash": "0110132bc99e638d17b3f922b3b9cb41da20a912",
      "date": "2026-01-24T20:28:19.000Z",
      "message": "fix: Correct callback signature in watcher tests",
      "author": "Jacob Chapel"
    },
    {
      "hash": "9da911d",
      "full_hash": "9da911d4168246b4f6f59da504190a0ea08012bd",
      "date": "2026-01-24T20:23:25.000Z",
      "message": "test: Add per-project file watcher tests",
      "author": "Jacob Chapel"
    },
    {
      "hash": "b712366",
      "full_hash": "b7123661ff6f30e66d1505ef0140018c734f16cb",
      "date": "2026-01-24T20:19:47.000Z",
      "message": "test: Add WebSocket connection binding tests (#221)",
      "author": "Jacob Chapel"
    },
    {
      "hash": "37551a5",
      "full_hash": "37551a542f7697b676c282531ba80ea12fef023b",
      "date": "2026-01-24T20:12:56.000Z",
      "message": "fix: Make WebSocket binding tests always pass (documentary style)",
      "author": "Jacob Chapel"
    },
    {
      "hash": "c84aef7",
      "full_hash": "c84aef7ab7b81000cbc15c393246e12595c2360a",
      "date": "2026-01-24T20:06:43.000Z",
      "message": "test: Add WebSocket connection binding tests",
      "author": "Jacob Chapel"
    },
    {
      "hash": "14ae16f",
      "full_hash": "14ae16f4d7e6077620cff82fed511cad815644c9",
      "date": "2026-01-24T20:04:06.000Z",
      "message": "test: Add multi-project API route tests (#220)",
      "author": "Jacob Chapel"
    },
    {
      "hash": "3ac499d",
      "full_hash": "3ac499dcf0848a98cbe8d79baec41c50b5652376",
      "date": "2026-01-24T19:52:11.000Z",
      "message": "test: Add multi-project API route tests",
      "author": "Jacob Chapel"
    },
    {
      "hash": "75b9216",
      "full_hash": "75b92163afae0dee31b4cf4f3152ca0eb5868479",
      "date": "2026-01-24T19:46:23.000Z",
      "message": "X-Kspec-Dir project context middleware (#219)",
      "author": "Jacob Chapel"
    },
    {
      "hash": "d406ac8",
      "full_hash": "d406ac8cd2c412ac39ea0e956d92506abab1a700",
      "date": "2026-01-24T19:39:05.000Z",
      "message": "feat: Add project context middleware for multi-directory daemon",
      "author": "Jacob Chapel"
    },
    {
      "hash": "a0c2396",
      "full_hash": "a0c23968148373df8315337cbac3c62103e94517",
      "date": "2026-01-24T19:37:42.000Z",
      "message": "Implement ProjectContextManager for multi-directory daemon (#218)",
      "author": "Jacob Chapel"
    }
  ],
  "working_tree": {
    "clean": true,
    "staged": [],
    "unstaged": [],
    "untracked": []
  },
  "inbox_items": [
    {
      "ref": "01KF16XG",
      "text": "Hook for SessionStart or post-compaction to inject relevant context and subtle instructions. Could auto-run 'kspec session start' or similar to give agent fresh context after memory is compacted.",
      "created_at": "2026-01-15T16:13:16.998Z",
      "tags": [],
      "added_by": "@claude"
    },
    {
      "ref": "01KF1V53",
      "text": "Spec review process: 3 parallel agents (internal fit, prior art comparison, external research) before finalizing major specs. Worked well for shadow branch spec design - should be formalized in meta-spec workflows.",
      "created_at": "2026-01-15T22:06:57.823Z",
      "tags": [
        "workflow",
        "meta"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KF3PJW",
      "text": "CLI output parity - JSON and human-readable outputs can drift when adding features. Investigate patterns to keep them in sync by design: unified output formatter, schema-driven rendering, shared data structure that both modes consume. Current pattern: output(data, humanFormatter) - data goes to JSON, formatter handles human. But formatter can show derived/computed info that isn't in data.",
      "created_at": "2026-01-16T15:25:35.193Z",
      "tags": [
        "cli",
        "dx",
        "design"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KF4DS5",
      "text": "Investigate ready task ordering beyond priority - creation order may not be ideal. Consider: recency of notes/activity, dependency depth, spec item priority inheritance, manual ordering field, tags for urgency",
      "created_at": "2026-01-16T22:10:58.273Z",
      "tags": [
        "design",
        "tasks",
        "dx"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KF554T",
      "text": "Ralph Wiggum / Looper Mode - Create a kspec-integrated autonomous loop runner. Core idea: a script that runs Claude Code repeatedly with fresh context, using a templated prompt that instructs it to:\n\n1. Run 'kspec session start' to see ready tasks\n2. Pick a well-defined task (high priority, clear spec, no blockers)\n3. Work on it until completion or stuck\n4. Commit and complete the task\n5. Exit cleanly (the outer loop restarts with fresh context)\n\nKey features from research:\n- Simple core: while :; do cat PROMPT.md | claude ; done\n- Context persists via filesystem/git, not session memory\n- Dual-condition exit: require both completion indicator AND explicit exit signal\n- Circuit breaker: stop after N loops with no progress or repeated errors\n- Rate limiting for API calls\n\nKspec-specific additions:\n- Task selection heuristics (prioritize: clear AC, no blockers, isolated scope)\n- Progress tracking via task notes before each exit\n- Session checkpoint before exit to ensure clean state\n- Maybe: task budget (only attempt tasks under estimated N turns)\n\nThe beauty is each iteration starts fresh but inherits cumulative work. Bad iterations don't compound context - they just waste one run.",
      "created_at": "2026-01-17T04:59:17.160Z",
      "tags": [
        "automation",
        "workflow",
        "agents"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KF6541",
      "text": "Ralph TUI mode: Optional terminal UI for ralph that provides real-time visualization of agent progress, event stream, session status. Would build on streaming/ACP foundation. Lower priority than core auditability work.",
      "created_at": "2026-01-17T14:18:06.435Z",
      "tags": [
        "ralph",
        "tui",
        "optional"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KF8TQ5",
      "text": "Transaction/batch mechanics for kspec operations - ability to set a mark point where changes don't auto-commit until a final 'commit' call. Could help with bulk operations, rollback on errors, and atomic multi-item changes. Challenges: managing state across commands, cleanup on abandoned transactions, shadow branch implications. Maybe simpler approach: explicit 'kspec bulk' command that takes a script/list of operations and executes them atomically.",
      "created_at": "2026-01-18T15:14:02.282Z",
      "tags": [
        "idea",
        "cli",
        "architecture"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KFA1Q5",
      "text": "Phase 1: Implement structured error codes and recovery hints for CLI - define CliError type, map existing error() calls to structured codes, add recovery suggestions for common error scenarios",
      "created_at": "2026-01-19T02:35:36.152Z",
      "tags": [
        "agent-first",
        "cli",
        "phase-1"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KFA1Q9",
      "text": "Phase 1: Implement unified output envelope for JSON mode - wrap all JSON responses in consistent structure with success/data/metadata/error fields",
      "created_at": "2026-01-19T02:35:40.491Z",
      "tags": [
        "agent-first",
        "cli",
        "phase-1"
      ],
      "added_by": "@claude"
    },
    {
      "ref": "01KFA1QB",
      "text": "Phase 2: Add dry-run support to mutating commands - implement --dry-run flag for task add/set, item add/set/delete, derive, inbox promote. Show preview of changes without executing",
      "created_at": "2026-01-19T02:35:42.815Z",
      "tags": [
        "agent-first",
        "cli",
        "phase-2"
      ],
      "added_by": "@claude"
    }
  ],
  "stats": {
    "total_tasks": 363,
    "in_progress": 0,
    "pending_review": 1,
    "ready": 18,
    "blocked": 2,
    "completed": 307,
    "inbox_items": 68
  }
}