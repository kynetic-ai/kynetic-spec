_ulid: 01JHNKA3W9TASK000000000000
slugs:
  - tasks
  - task-system
title: Task System
type: module
status:
  maturity: draft
  implementation: implemented
description: |
  Tasks are first-class items that track work. They can be derived
  from spec items or created standalone. The task system enables
  kspec to function as a work tracker, not just a spec format.
features:
  - _ulid: 01JHNKA4W0TTPE000000000000
    slugs:
      - task-types
    title: Task Types
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: high
    tags:
      - mvp
      - tasks
    description: |
      Tasks have types that indicate their nature and relationship
      to spec items. Some types expect spec linkage; others don't.
    requirements:
      - _ulid: 01JHNKA4W1TTPE100000000000
        slugs:
          - task-type-task
        title: Task Type - task
        type: requirement
        status:
          maturity: draft
          implementation: verified
        description: |
          type: task

          Atomic unit of work. May be spec-derived or standalone.
          Default task type if not specified.
        implements:
          - "@task-types"
        acceptance_criteria:
          - id: ac-1
            given: a task with type 'task' is created
            when: the task is validated
            then: it is accepted as atomic unit of work with standard task lifecycle (pending -> in_progress ->
              completed)
          - id: ac-2
            given: a task has no type specified
            when: the task is created or validated
            then: it defaults to type 'task'
      - _ulid: 01JHNKA4W2TTPE200000000000
        slugs:
          - task-type-epic
        title: Task Type - epic
        type: requirement
        status:
          maturity: draft
          implementation: verified
        description: |
          type: epic

          Groups related tasks. Often derived from features.
          Can have subtasks that depends_on it.
        implements:
          - "@task-types"
        acceptance_criteria:
          - id: ac-1
            given: a task with type 'epic' is created
            when: other tasks reference it via depends_on
            then: the epic serves as a container grouping related subtasks
          - id: ac-2
            given: an epic is often derived from a feature
            when: the feature has child requirements
            then: subtasks can be created with depends_on relationships to the epic
      - _ulid: 01JHNKA4W3TTPE300000000000
        slugs:
          - task-type-bug
        title: Task Type - bug
        type: requirement
        status:
          maturity: draft
          implementation: verified
        description: |
          type: bug

          Defect fix. May or may not link to spec item.
          Used for issues found after implementation.
        implements:
          - "@task-types"
        acceptance_criteria:
          - id: ac-1
            given: a task with type 'bug' is created
            when: the task is validated
            then: it is accepted as defect fix work (may or may not have spec_ref depending on whether it
              reveals spec gap)
          - id: ac-2
            given: a bug is found after implementation
            when: it doesn't correspond to existing spec item
            then: bug task can be created standalone without spec_ref
      - _ulid: 01JHNKA4W4TTPE400000000000
        slugs:
          - task-type-spike
        title: Task Type - spike
        type: requirement
        status:
          maturity: draft
          implementation: verified
        description: |
          type: spike

          Research or investigation task. Time-boxed exploration.
          Output is knowledge, not code.
        implements:
          - "@task-types"
        acceptance_criteria:
          - id: ac-1
            given: a task with type 'spike' is created
            when: the task is time-boxed research or investigation
            then: it is validated as spike with expected output being knowledge/findings, not code
          - id: ac-2
            given: a spike task is completed
            when: the completion note is added
            then: the note documents findings and recommendations (what was learned)
      - _ulid: 01JHNKA4W5TTPE500000000000
        slugs:
          - task-type-infra
        title: Task Type - infra
        type: requirement
        status:
          maturity: draft
          implementation: verified
        description: |
          type: infra

          Infrastructure or tooling work. Not spec-derived.
          Examples: CI setup, dependency updates, tooling.
        implements:
          - "@task-types"
        acceptance_criteria:
          - id: ac-1
            given: a task with type 'infra' is created
            when: the task is validated
            then: "it is accepted as infrastructure/tooling work without requiring spec_ref (examples: CI setup,
              dependency updates)"
  - _ulid: 01JHNKA4W6TSTA000000000000
    slugs:
      - task-states
      - state-machine
    title: Task States
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: high
    tags:
      - mvp
      - tasks
    description: |
      Tasks have explicit states (set via commands) and derived
      states (computed from dependencies). The state machine
      controls valid transitions.
    acceptance_criteria:
      - id: ac-state-1
        given: a task in pending state
        when: kspec task start is run
        then: task transitions to in_progress
      - id: ac-state-2
        given: a task with depends_on another pending task
        when: ready tasks are queried
        then: the dependent task is NOT in the ready list
      - id: ac-state-3
        given: a task blocked by dependencies
        when: all dependencies complete
        then: task becomes ready (unblocked)
    requirements:
      - _ulid: 01JHNKA4W7TSTA100000000000
        slugs:
          - state-pending
        title: State - pending
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          status: pending

          Initial state. Work not yet started.
          Transitions: start -> in_progress, cancel -> cancelled
        implements:
          - "@task-states"
      - _ulid: 01JHNKA4W8TSTA200000000000
        slugs:
          - state-in-progress
        title: State - in_progress
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          status: in_progress

          Work actively being done.
          Transitions:
          - complete -> completed
          - block -> blocked
          - cancel -> cancelled
        implements:
          - "@task-states"
      - _ulid: 01JHNKA4W9TSTA300000000000
        slugs:
          - state-blocked
        title: State - blocked
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          status: blocked

          Work paused due to blocker.
          Can be set manually (external blocker) or auto-computed
          when depends_on items aren't completed.

          Transitions: unblock -> in_progress (or pending)
        implements:
          - "@task-states"
      - _ulid: 01JHNKA5W0TSTA400000000000
        slugs:
          - state-completed
        title: State - completed
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          status: completed

          Work finished successfully. Terminal state.
          Should include closed_reason describing outcome.
        implements:
          - "@task-states"
      - _ulid: 01JHNKA5W1TSTA500000000000
        slugs:
          - state-cancelled
        title: State - cancelled
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          status: cancelled

          Work abandoned. Terminal state.
          Should include closed_reason explaining why.
        implements:
          - "@task-states"
      - _ulid: 01JHNKA5W2TSTA600000000000
        slugs:
          - derived-ready
        title: Derived State - ready
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          "ready" is a computed view, not stored state:
          ready = pending + all depends_on completed + no blockers

          `kspec tasks ready` returns tasks in this state.
          This is the primary query for "what can I work on?"
        implements:
          - "@task-states"
      - _ulid: 01KF3H24BBZ5JXXMEP8JJS9SEJ
        slugs:
          - task-completion-guardrails
        title: Task Completion Guardrails
        type: requirement
        tags:
          - workflow
          - dx
        description: When completing a task, CLI provides guardrails to ensure work is properly documented
          and aligned with spec.
        depends_on: []
        implements: []
        relates_to: []
        tests: []
        created: 2026-01-16T13:49:03.212Z
        acceptance_criteria:
          - id: ac-2
            given: A task with spec_ref is completed and the linked spec has acceptance_criteria
            when: The task is marked completed
            then: "CLI shows a reminder: 'Linked spec has N acceptance criteria - verify they are covered'"
          - id: ac-3
            given: A task without spec_ref is completed
            when: The task is marked completed
            then: No status update prompt is shown (only applies to spec-linked tasks)
        status:
          maturity: draft
          implementation: implemented
      - _ulid: 01KFCJRSTMPG1VTBVV74X2A2NK
        slugs:
          - pending-review-state
        title: Pending Review State
        type: requirement
        tags:
          - tasks
        description: Add pending_review status to task lifecycle. This state represents 'code complete,
          awaiting merge' - bridging the gap between in_progress (actively working) and completed
          (merged/shipped). Tasks transition to pending_review when work is done but PR needs
          review/merge, then to completed when actually shipped.
        depends_on: []
        implements: []
        relates_to: []
        tests: []
        notes: []
        created: 2026-01-20T02:12:04.565Z
        acceptance_criteria:
          - id: ac-1
            given: TaskStatusSchema in common.ts
            when: validating a task status value
            then: pending_review is accepted as a valid enum value
          - id: ac-2
            given: a task with status pending_review
            when: kspec task complete is run
            then: the task transitions to completed (pending_review is a valid pre-state for completion)
          - id: ac-4
            given: a task with status pending_review
            when: ready tasks are queried via kspec tasks ready
            then: the pending_review task is NOT included (only pending tasks are ready)
          - id: ac-5
            given: tasks exist with status pending_review
            when: kspec session start is run
            then: pending_review tasks are displayed in an 'Awaiting Review' or similar section separate from
              active work
          - id: ac-6
            given: a task with status pending_review
            when: kspec tasks list --status pending_review is run
            then: the task appears in the filtered list
          - id: ac-7
            given: the AGENTS.md task state diagram
            when: describing task lifecycle
            then: pending_review appears between in_progress and completed with valid transition paths
          - id: ac-8
            given: the CLI help content for task commands
            when: viewing help for task state transitions
            then: pending_review is documented with its purpose and valid transitions
          - id: ac-9
            given: a task with status in_progress
            when: kspec task submit is run
            then: the task transitions to pending_review
        status:
          maturity: draft
          implementation: implemented
  - _ulid: 01JHNKA5W3TSCH000000000000
    slugs:
      - task-schema
      - task-structure
    title: Task Schema
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: high
    tags:
      - mvp
      - tasks
    description: |
      Tasks are items with additional fields for work tracking.
      Key principle: don't duplicate spec content, reference it.
    requirements:
      - _ulid: 01JHNKA5W4TSCH100000000000
        slugs:
          - task-spec-ref
        title: Spec Reference Field
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          spec_ref: "@feature-slug"

          Links task to the spec item it implements.
          The spec item has the full description, acceptance
          criteria, etc. Task adds only execution metadata.

          Optional for free-form tasks (bug, infra).
        implements:
          - "@task-schema"
      - _ulid: 01JHNKA5W5TSCH200000000000
        slugs:
          - task-work-fields
        title: Work Metadata Fields
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          Task-specific fields for work tracking:

          - priority: 1-5 (1 highest) or high/medium/low
          - complexity: Relative size estimate (fibonacci or 1-5)
          - assignee: Who's working on it (optional)
          - blocked_by: Manual blockers (strings, not refs)
          - closed_reason: Why completed/cancelled

          These fields don't exist on regular spec items.
        implements:
          - "@task-schema"
      - _ulid: 01JHNKA5W6TSCH300000000000
        slugs:
          - task-timestamps
        title: Task Timestamps
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          Auto-populated timestamps:

          - created_at: When task was created
          - started_at: When status became in_progress
          - completed_at: When status became completed/cancelled

          Format: ISO 8601 (2025-01-14T10:00:00Z)
        implements:
          - "@task-schema"
      - _ulid: 01JHNKA5W7TSCH400000000000
        slugs:
          - task-vcs-refs
        title: VCS References
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          vcs_refs links tasks to git branches/commits/tags:

          vcs_refs:
            - ref: "feat/user-login"
              type: branch
            - ref: "abc123"
              type: commit

          Minimal schema, extensible as needed.
        implements:
          - "@task-schema"
  - _ulid: 01JHNKA5W8TDRV000000000000
    slugs:
      - task-derivation
      - derive-tasks
    title: Task Derivation
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: high
    tags:
      - mvp
      - tasks
    description: |
      Tasks can be derived from spec items via explicit command.
      Not automatic - you run `kspec derive @feature` when ready.
    acceptance_criteria:
      - id: ac-derive-1
        given: a feature without derived tasks
        when: kspec derive @feature runs
        then: a task is created with spec_ref pointing to feature
      - id: ac-derive-2
        given: a derived task exists for a feature
        when: kspec derive @feature runs again
        then: no duplicate is created (idempotent)
    requirements:
      - _ulid: 01JHNKA5W9TDRV100000000000
        slugs:
          - derive-command
        title: Derive Command
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec derive <ref>     # Derive task for single item
          kspec derive --all    # Derive for all items without tasks

          Creates task with:
          - title: "Implement <item title>" (adjustable)
          - type: task (or epic for features with children)
          - spec_ref: @<item>
          - derivation: auto
        implements:
          - "@task-derivation"
      - _ulid: 01JHNKA6W0TDRV200000000000
        slugs:
          - derive-idempotency
        title: Derivation Idempotency
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          Derivation is idempotent:
          - If task with spec_ref to item exists, skip creation
          - Use --force to create additional task anyway
          - Useful for re-running derive without duplicates
        implements:
          - "@task-derivation"
  - _ulid: 01KEZCJPJ4A4QG2DY5F3BBVFVB
    slugs:
      - task-notes
      - work-log
    title: Task Notes
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: medium
    tags:
      - tasks
    description: |
      Notes are append-only log entries on tasks. Track progress,
      findings, blockers. Critical for agent handoff.
    acceptance_criteria:
      - id: ac-note-1
        given: a task in progress
        when: kspec task note @task "Found issue with X"
        then: note is appended to task's notes array
      - id: ac-note-2
        given: an earlier note that's wrong
        when: new note added with --supersedes
        then: new note links to old one (old preserved)
    requirements:
      - _ulid: 01KEZCJPJ4WYTKPZZ9FY5A2G13
        slugs:
          - note-structure
        title: Note Structure
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          Note entries have:
          - _ulid: Entry identifier
          - created_at: Timestamp
          - author: Who added it
          - content: The note text (multiline)
          - supersedes: ULID of entry this corrects (optional)

          Notes are never deleted, only superseded.
        implements:
          - "@task-notes"
      - _ulid: 01KEZCJPJ4Y0CGNFZREY3QS225
        slugs:
          - note-cli
        title: Note CLI Commands
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec task note <ref> "message"      # Add note
          kspec task note <ref> --supersedes <id> "correction"
          kspec task notes <ref>               # Show notes log

          JSON output available for all commands.
        implements:
          - "@task-notes"
  - _ulid: 01KEZCJPJ41NHFPF7WV6PF68SW
    slugs:
      - task-todos
      - subtask-checklist
    title: Task Todos
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: medium
    tags:
      - tasks
    description: |
      Todos are lightweight checklist items that emerge during work.
      Start simple; promote to full tasks when complex.
    acceptance_criteria:
      - id: ac-todo-1
        given: a task in progress
        when: kspec todo add @task "Write tests"
        then: todo is added to task's todos array
      - id: ac-todo-2
        given: a todo that's complex
        when: kspec todo promote @task <id>
        then: a new task is created, todo marked promoted_to
    requirements:
      - _ulid: 01KEZCJPJ43FJQJZM48Z5KS4NF
        slugs:
          - todo-structure
        title: Todo Structure
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          Todo entries have:
          - id: Local numeric ID (within task)
          - text: The todo description
          - done: Boolean
          - done_at: When marked done (if done)
          - added_at: When created
          - added_by: Who added it
          - promoted_to: @ref if promoted to task (optional)
        implements:
          - "@task-todos"
      - _ulid: 01KEZCJPJ4WPM1XREVKF00QM2K
        slugs:
          - todo-cli
        title: Todo CLI Commands
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec todo add <ref> "text"     # Add todo
          kspec todo done <ref> <id>      # Mark complete
          kspec todo promote <ref> <id>   # Promote to task
          kspec task todos <ref>          # List todos

          Todos are for quick capture; promote when complex.
        implements:
          - "@task-todos"
  - _ulid: 01JHNKA6W7TSTR000000000000
    slugs:
      - task-storage
    title: Task Storage
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: medium
    tags:
      - tasks
    description: |
      Tasks are stored alongside or separate from specs.
      Auto-adaptive: start alongside, separate when volume grows.
    requirements:
      - _ulid: 01JHNKA6W8TSTR100000000000
        slugs:
          - task-storage-alongside
        title: Storage - Alongside Specs
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          For smaller projects, tasks next to specs:

          spec/
            auth.yaml           # Spec items
            auth.tasks.yaml     # Tasks for auth module

          Simple, keeps related items together.
        implements:
          - "@task-storage"
      - _ulid: 01JHNKA6W9TSTR200000000000
        slugs:
          - task-storage-separate
        title: Storage - Separate Directory
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          For larger projects, separate tasks directory:

          spec/
            modules/
              auth.yaml
          tasks/
            backlog.yaml
            active.yaml
            archive/
              2025-01.yaml

          Separates concerns, enables archiving.
        implements:
          - "@task-storage"
  - _ulid: 01JHNKA7W0TQRY000000000000
    slugs:
      - task-queries
    title: Task Queries
    type: feature
    status:
      maturity: draft
      implementation: implemented
    priority: high
    tags:
      - mvp
      - tasks
    description: |
      The key task query: "what can I work on?"
      `kspec tasks ready` is the primary interface for agents and humans.
    acceptance_criteria:
      - id: ac-query-1
        given: tasks with various states and dependencies
        when: kspec tasks ready runs
        then: only tasks that are pending with met dependencies shown
      - id: ac-query-2
        given: ready tasks exist
        when: kspec tasks next runs
        then: highest priority ready task returned
      - id: ac-query-3
        given: multiple ready tasks exist with the same priority
        when: kspec tasks ready runs
        then: tasks are ordered by creation time ascending (oldest first within priority tier)
    requirements:
      - _ulid: 01JHNKA7W1TQRY100000000000
        slugs:
          - query-ready
        title: Ready Tasks Query
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec tasks ready

          Returns tasks where:
          - status = pending
          - all depends_on tasks are completed
          - no manual blocked_by entries

          This is THE command for "what can I work on next?"
        implements:
          - "@task-queries"
      - _ulid: 01JHNKA7W2TQRY200000000000
        slugs:
          - query-next
        title: Next Task Query
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec tasks next

          Returns single highest-priority ready task.
          Sorting: priority (asc) -> created_at (asc)

          Useful for agents: "give me one thing to do"
        implements:
          - "@task-queries"
      - _ulid: 01JHNKA7W3TQRY300000000000
        slugs:
          - query-filters
        title: Task Query Filters
        type: requirement
        status:
          maturity: draft
          implementation: implemented
        description: |
          kspec tasks list [filters]

          Filters:
          - --status <state>    # By status
          - --type <type>       # By task type
          - --tag <tag>         # By tag
          - --assignee <who>    # By assignee
          - --spec-ref <ref>    # By linked spec item

          All queries support --json output.
        implements:
          - "@task-queries"
  - _ulid: 01KFEJW283E3ADMC1G6WGV7MGC
    slugs:
      - tasks-assess-automation
    title: Task Automation Assessment
    type: feature
    tags: []
    description: CLI command to assess task automation eligibility based on criteria (has spec_ref, spec
      has ACs, not spike). Provides visibility into task readiness for automation and enables fast
      triage of obvious cases via --auto mode.
    depends_on: []
    implements: []
    relates_to: []
    tests: []
    traits: []
    notes: []
    created: 2026-01-20T20:52:20.356Z
    acceptance_criteria:
      - id: ac-1
        given: kspec tasks assess automation is run
        when: displaying results
        then: lists pending tasks without automation field (unassessed) by default
requirements:
  - _ulid: 01KFBVD707HVYZZ240A0KMEZ3N
    slugs:
      - task-automation-eligibility
    title: Task Automation Eligibility
    type: requirement
    tags: []
    depends_on: []
    implements: []
    relates_to: []
    tests: []
    notes: []
    created: 2026-01-19T19:23:47.591Z
    description: Tasks have an automation eligibility status that indicates whether they can be
      processed by unattended automation loops (like ralph). Eligibility is determined by human
      judgment during triage - assessing whether the task is unambiguous, appropriately scoped, and
      has sufficient context (spec + notes + description) to be standalone. This prevents automation
      from attempting tasks that require human decisions, clarification, or oversight.
    acceptance_criteria:
      - id: ac-1
        given: a task exists
        when: checking its schema
        then: "it has an optional automation field with enum values: eligible, needs_review, manual_only"
      - id: ac-2
        given: a new task is created
        when: no automation value is specified
        then: the task has no automation field (treated as unassessed)
      - id: ac-3
        given: ralph is selecting tasks
        when: filtering ready tasks
        then: "only tasks with automation: eligible are presented to the agent"
      - id: ac-4
        given: an agent is working on an eligible task
        when: the agent determines the task is not suitable for automation
        then: the agent marks it as needs_review and adds a note explaining why (note is required)
      - id: ac-5
        given: a human is triaging tasks
        when: assessing automation readiness
        then: they can set automation to any value (eligible, needs_review, manual_only) or clear it
      - id: ac-6
        given: a task is marked needs_review
        when: it needs to become eligible again
        then: "a human must review and explicitly set automation: eligible"
      - id: ac-7
        given: ralph is selecting tasks
        when: a task has no automation field (unassessed)
        then: that task is not presented to the agent
      - id: ac-8
        given: ralph is selecting tasks
        when: "a task has automation: needs_review"
        then: that task is not presented to the agent
      - id: ac-9
        given: ralph is selecting tasks
        when: "a task has automation: manual_only"
        then: that task is not presented to the agent
      - id: ac-10
        given: ralph is running
        when: "no tasks with automation: eligible exist in ready state"
        then: ralph exits with a message indicating no eligible tasks available
      - id: ac-11
        given: a user wants to set automation status
        when: running kspec task set @ref --automation eligible
        then: the task's automation field is set to the specified value
      - id: ac-12
        given: a user wants to clear automation status
        when: running kspec task set @ref --no-automation
        then: the task's automation field is removed (returns to unassessed state)
      - id: ac-13
        given: a task is created via kspec task add
        when: the --automation flag is provided
        then: the task is created with the specified automation value
      - id: ac-14
        given: kspec tasks ready is run
        when: displaying the ready tasks list
        then: the automation status is shown for each task (showing 'unassessed' if not set)
      - id: ac-15
        given: a task is marked manual_only
        when: it needs to become eligible
        then: "a human must review and explicitly set automation: eligible"
      - id: ac-16
        given: an agent marks a task as needs_review during a ralph iteration
        when: the marking is complete
        then: the agent moves on to the next eligible task (does not exit the loop)
      - id: ac-17
        given: kspec task get @ref is run
        when: displaying task details
        then: the automation status is shown (or 'unassessed' if not set)
      - id: ac-18
        given: an agent or human marks a task as needs_review
        when: setting the status
        then: a note explaining why the task needs review is required (either via --reason or separate task
          note command)
      - id: ac-19
        given: kspec tasks ready is run
        when: the --eligible flag is provided
        then: "only tasks with automation: eligible are shown"
      - id: ac-20
        given: kspec tasks ready is run
        when: the --unassessed flag is provided
        then: only tasks without an automation field are shown
      - id: ac-21
        given: kspec validate is run
        when: "a task has automation: eligible but no spec_ref"
        then: a warning (not error) is emitted suggesting eligible tasks should have linked specs;
          validation still passes
      - id: ac-22
        given: a task's automation status needs to change
        when: considering valid transitions
        then: any status can transition to any other status; CLI auto-mode (kspec tasks assess automation
          --auto) does NOT mark tasks eligible, but agents/humans reviewing interactively CAN mark
          eligible via kspec task set
      - id: ac-23
        given: "a task has automation: eligible"
        when: its spec_ref is removed or the referenced spec is deleted
        then: the automation status is preserved but kspec validate emits a warning
      - id: ac-24
        given: kspec tasks ready is run
        when: the --needs-review flag is provided
        then: "only tasks with automation: needs_review are shown (for human triage)"
      - id: ac-25
        given: ralph starts a new loop iteration
        when: selecting the next task
        then: "ralph re-reads task list and filters by automation: eligible (reflecting any status changes
          from previous iterations)"
    status:
      maturity: draft
      implementation: implemented
